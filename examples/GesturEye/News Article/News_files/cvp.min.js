/*! CVP 2.8.4.1 | Core Video Player | (c) Turner Broadcasting System, Inc. */
!function e(t,n,i){function r(o,a){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(s)return s(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[o]={exports:{}};t[o][0].call(d.exports,function(e){var n=t[o][1][e];return r(n?n:e)},d,d.exports,e,t,n,i)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(e,t){var n=e("./core"),i=e("./sessiontoken"),r=window.Aspen=n();r.createInstance=n,r.getSessionToken=function(){return i.read()},t.exports=r},{"./core":5,"./sessiontoken":8}],2:[function(e,t,n){var i=e("./log"),r=e("../cvp/request"),s=e("../cvp/utils"),o=e("../cvp/convert"),a=500,l=3,c=!1,d=[],u=function(e){return d.length>a&&d.splice(0,a-d.length),s.isArray(e)&&e.length?d.unshift.apply(d,e):d.push(e)},h=function(e,t,n){i.log("AspenComm::makeRequest",e);var s=function(e){i.log("AspenComm::makeRequest","request success",e);var n=o.jsonTextToJsObject(e);t(n)},a=function(t){i.debug("AspenComm::makeRequest","request failure",t),e._retries>l?n(e.url):(e._retries+=1,u(arguments))};e._retries="_retries"in e?e._retries+1:0;var c=new r(e);return c.then(s,a),c},p=function(){d.push(arguments)},g=function(){for(var e=d.splice(0,d.length),t=null;null!=(t=e.shift());)h.apply(null,t).otherwise(s.bind(u,null,t))},f=function(e,t,n){c?h(e,t,n):p(e,t,n)},_=function(){i.log("AspenComm::init"),c=!0,_=function(){throw new Error("already init'ed - ignored")},g()};n.init=_,n.request=f},{"../cvp/convert":15,"../cvp/request":35,"../cvp/utils":50,"./log":6}],3:[function(e,t){var n=e("../vendor/Class"),i=e("../cvp/utils"),r=e("../cvp/shared"),s=e("../vendor/json3"),o=e("./log"),a=e("./transportmanager"),l="total",c="timer",d="none",u=n.extend({init:function(e){this._enabled=!1,this._queue=[],this._postThrottled=!0,this._aspen=e||window.Aspen,this._timer=null,this._postTimerEvent=i.bind(this._postTimerEvent,this),this._firstPostTimerEvent=i.bind(this._firstPostTimerEvent,this),this.dispose=i.bind(this.dispose,this),r.addBeforeUnLoadEvent(this.dispose)},dispose:function(){this.disableTimer(),this.post()},start:function(){var e=this._aspen.getConfig("batchApi");if(e&&(this._enabled=!0,this._aspen.getConfig("batchMode")===c)){var t=i.toInt(this._aspen.getConfig("batchModeAmount")),n=Math.ceil(Math.random()*t);n===t&&(n-=1,0>=n&&(n=.5)),o.log("BatchService::start","random time: "+n),setTimeout(this._firstPostTimerEvent,1e3*n)}},add:function(e){if(!this._aspen.getConfig("enabled"))return void o.debug("BatchService::add","Aspen is disabled via aspenanalytics config. Message not added.");if(o.debug("BatchService::add","Adding message to batch queue."),this._queue.push(e),!this._enabled)return void o.debug("BatchService::add","Batch service not enabled. Queuing message.");var t=this._aspen.getConfig("batchMode"),n=this._aspen.getConfig("batchModeAmount");t===c&&null===this._timer?(o.debug("BatchService::add","Starting timer on message-add."),this._timer=setTimeout(this._postTimerEvent,1e3*n)):t===l?this._queue.length>=n&&this.post():t===d?this.post():t!==c&&this.post(),i.empty(this._queue)||("error"===e.eventType?this.flushByError(e.eventData):"error"===e.eventType||i.undef(this._aspen.getConfig("highPriorityEvents"))||this.flushByEvent(e.eventType))},post:function(){if(this._postThrottled)return void o.debug("BatchService::post","Batch posting is throttled. Batch not posted.");if(!this._enabled)return void o.debug("BatchService::post","Batch posting is not enabled.");var e={sessionId:this._sessionId,events:this._queue};if(o.debug("BatchService::post","send batch string"),"gzip"===this._aspen.getConfig("batchContentEncoding")){var t="?aspenJson="+s.stringify(e);e=encodeURIComponent(t).replace(/%20/g,"+")}a.createRequest(this._aspen.getConfig("batchApi"),e,this._postSuccess,this._postFailure,this),this._queue.length=0},_postTimerEvent:function(){i.empty(this._queue)?(o.log("BatchService::_postTimerEvent","no messages to post"),this._timer=null):(o.log("BatchService::_postTimerEvent","queue.length: "+this._queue.length),this.post(),this._timer=setTimeout(this._postTimerEvent,1e3*this._aspen.getConfig("batchModeAmount")))},_firstPostTimerEvent:function(){i.empty(this._queue)?o.log("BatchService::_firstPostTimerEvent","no messages to post"):(o.log("BatchService::_firstPostTimerEvent","queue.length: "+this._queue.length),this.post())},_postSuccess:function(e){o.log("BatchService::_postSuccess",e)},_postFailure:function(e){o.log("BatchService::_postFailure",e)},flushByError:function(e){var t=this._aspen.getConfig("highPriorityErrors");if(i.isString(e.errorCode)&&i.isString(t)){for(var n=e.errorCode,r=n.substring(0,2),s=n.substring(2,4),a=n.substring(4,6),l=n.substring(6),c=t.split(/[, ]+/),d="",u="",h="",p="",g=[],f=[],_=[],m=[],v=0,y=c.length;y>v;++v)switch(v){case 0:d=c[v],g=d.split("+");break;case 1:u=c[v],f=u.split("+");break;case 2:h=c[v],_=h.split("+");break;case 3:p=c[v],m=p.split("+")}for(v=0,y=g.length;y>v;++v){var C=g[v];if(r===C||"*"===C)for(var E=0,P=f.length;P>E;++E){var b=f[E];if(s===b||"*"===b)for(var T=0,A=_.length;A>T;++T){var w=_[T];if(a===w||"*"===w)for(var S=0,k=m.length;k>S;++S){var I=m[S];(l===I||"*"===I)&&(o.debug("BatchService::flushByError","found match, flushing batch"),this.post())}}}}}},flushByEvent:function(e){var t=this._aspen.getConfig("highPriorityEvents");if(i.isString(t))for(var n=t.split(/[, ]+/),r=0,s=n.length;s>r;++r){var a=n[r];a===e&&(o.debug("BatchService::flushByEvent","found match, flushing batch"),this.post())}},setSessionId:function(e){this._sessionId=e},setPostThrottled:function(e){this._postThrottled=e},disableTimer:function(){this._aspen.getConfig("batchMode")===c&&clearTimeout(this._timer)}});t.exports=u},{"../cvp/shared":36,"../cvp/utils":50,"../vendor/Class":92,"../vendor/json3":94,"./log":6,"./transportmanager":9}],4:[function(e,t){var n=e("../cvp/util/dependency"),i=e("./log"),r=e("../cvp/utils"),s=e("../cvp/request"),o=n.extend({init:function(e){var t=e.basePath||".";i.log("Using config base path: "+t);var n=t+"/aspenanalytics.json?_="+r.now();i.log("config url: ",n),this._super(n,!1)},load:function(){s.getJSONP({jsonpCallback:"cvp_onAnalyticsConfigReceived",url:this._assetUrl,success:r.bind(this._loadConfigSuccess,this),error:r.bind(this._loadConfigFailure,this)})},_loadConfigSuccess:function(e){i.log("Config loaded successfully"),this._success(e,this._assetUrl)},_loadConfigFailure:function(e){i.log("Config failed to load",e),this._failure(e)},getDesc:function(){return"Aspen ConfigDependency: "+this._assetUrl}});t.exports=o},{"../cvp/request":35,"../cvp/util/dependency":44,"../cvp/utils":50,"./log":6}],5:[function(e,t){var n=e("../core/app"),i=e("../cvp/utils"),r=e("../cvp/customevent"),s=e("../cvp/events"),o=e("../cvp/browser"),a=e("../vendor/json3"),l=e("./log"),c=e("./batchservice"),d=e("./configfile"),u=e("./transportmanager"),h=e("./sessionid"),p=e("./sessiontoken"),g=n.CDN_ORIGIN+"/xslo/cvp/config/",f={WAITING:"loadStateWaiting",LOADING:"loadStateLoading",READY:"loadStateReady",FAILED:"loadStateFailed"},_=function(e){var t=!0,_={applicationName:"cvp",applicationVersion:n.VERSION,context:"default",deviceModel:"desktop",deviceType:"desktop",deviceVersion:"desktop",platformName:"javascript",platformVersion:o.version?String(o.version):void 0};return"object"==typeof e&&("aspenAppSignature"in e&&(_=i.extend({},_,e.aspenAppSignature)),"useSharedSessionToken"in e&&(t=!!e.useSharedSessionToken)),{initialized:!1,ready:!1,config:{throttled:!0,timeDifference:0,progressReportInterval:37,adProgressReportInterval:17},batchService:null,sessionObject:{},serviceUrlRoot:"",_retryTimer:null,_retries:0,_retriesMade:0,_retryTime:0,_savedSession:{},_messageQueue:[],_loadState:f.WAITING,eInitSuccess:new r("AspenInitSuccess"),eInitFailure:new r("AspenInitFailure"),init:function(e){var t=this;return this.initialized?void l.warn("Aspen is already set up!"):(this._helloRetry=i.bind(this._helloRetry,this),this.initialized=!0,this._options=e||{},this._options.site=this._options.site||n._cvpsetup&&n._cvpsetup.site||"cvp",i.empty(this._options.site)?void l.error("Unable to start Aspen, no site provided"):(this.batchService=new c(this),this._loadState=f.LOADING,void s.onReady(function(){var e=t._options.configBaseUrl||g+t._options.site,n=t._dependency=new d({basePath:!t._options.dt&&e});n.eSuccess.addListener(t._onConfigLoaded,t),n.eFailure.addListener(t._onConfigLoadFailure,t),n.load()})))},_freeDependency:function(){this._dependency&&(this._dependency.eSuccess.removeListener(this._onConfigLoaded,this),this._dependency.eFailure.removeListener(this._onConfigLoadFailure,this),this._dependency=null)},dispose:function(){this._freeDependency(),clearTimeout(this._retryTimer),this.batchService.dispose(),this.batchService=null},_setupConfig:function(e,t){var n=i.extend({},e["default"],"context"in this._options?e[this._options.context]:null);n.enabled="true"===n.enabled&&!i.empty(n.servicesUrl),n.batchMode=n.batchMode||"total",n.batchModeAmount=n.batchModeAmount&&Number(n.batchModeAmount)||10,n.helloRetryCount=isNaN(n.helloRetryCount=Number(n.helloRetryCount))?5:n.helloRetryCount,n.helloRetryTime=n.helloRetryTime&&Number(n.helloRetryTime)||1e4,n.batchContentEncoding=n.batchContentEncoding||"json",n.transportFormats=n.transportFormats&&n.transportFormats.split(/[, ]+/)||u.getDefaultFormats(),n.propertyName=n.propertyName||this._options.site,i.print(n,"Aspen config"),this.config=n,this.configSourceUrl=t,this.send(this.config,"aspenConfigDetails")},getConfig:function(e){return e in this.config?this.config[e]:void 0},_onConfigLoaded:function(e,t){this._freeDependency(),this._setupConfig(e,t),this._loadState=f.READY,l.log("_onConfigLoaded - config successfully loaded"),this.config.enabled?(l.log("analytics enabled via config"),u.init({transportFormats:this.config.transportFormats,servicesUrl:this.config.servicesUrl}),this.serviceUrlRoot=this.config.servicesUrl,this._hello()):(l.log("analytics disabled via config"),this._initFailure())},_onConfigLoadFailure:function(e){this._freeDependency(),this._loadState=f.FAILED,l.log("_onConfigLoadFailure - failed to load "+e)},_hello:function(){l.log("hello");var e=h.get(),n=t?p.read():p.create(),r=i.extend({},_,{aspenConfigUrl:this.configSourceUrl,propertyName:this.config.propertyName,pageUrl:document.URL,context:this._options.context,debug:this._options.dt?"true":"false",sessionId:e,sessionToken:n,protocol:"1.0"});u.bootstrapTM(),u.createRequest(this.config.helloApi,r,this._helloSuccess,this._helloFailure,this),this._retryTimer=setTimeout(this._helloRetry,this.config.helloRetryTime)},_helloSuccess:function(e){l.log("_helloSuccess"),clearTimeout(this._retryTimer),this.config.throttled=i.isString(e.throttled)?"no"!==e.throttled:this.config.throttled,this.config.sessionId=e.sessionId,this.config.timeDifference=e.timestamp?e.timestamp-i.now():this.config.timeDifference,this.config.progressReportInterval=e.progressReportInterval||this.config.progressReportInterval,this.config.adProgressReportInterval=e.adProgressReportInterval||this.config.adProgressReportInterval,l.debug("throttled: "+e.throttled+" => "+this.config.throttled),l.debug("sessionId: "+e.sessionId),l.debug("timeDifference: "+this.config.timeDifference),l.debug("progressReportInterval: "+this.config.progressReportInterval),l.debug("adProgressReportInterval: "+this.config.adProgressReportInterval),e.sessionId&&h.set(e.sessionId),this.batchService.setSessionId(h.get()),this.batchService.setPostThrottled(this.config.throttled),this.batchService.start();var t=i.getQueryParam("sessionToken");t&&this.send({},"authSessionReload"),this._initSuccess()},_helloFailure:function(e){l.log("_helloFailure url: "+e),u.fallback()&&this._hello()},_helloRetry:function(){l.log("helloRetry"),this._retries===this.config.helloRetryCount?(l.log("retries exhasted"),clearTimeout(this._retryTimer),this._retries=0,u.fallback()?this._hello():(l.debug("retries exhasted, fallbacks exhausted, aspen is disabled"),this.config.throttled=!0,this.batchService.setBatchThrottled(!0),this.batchService.setPostThrottled(!0),this.batchService.disableTimer())):(this._retries+=1,this._retryTime=this._retries*this.config.helloRetryTime,this._savedSession.retries=this._retries,this._savedSession.retryTime=this._retryTime,this._hello())},isMessageExcluded:function(e){return i.isString(this.config.messageExcludes)&&-1!==this.config.messageExcludes.indexOf(e)},send:function(e,t){return this.disabled?void l.debug("send - Aspen is disabled, message was not sent"):(e.timestamp=(e.timestamp||i.now())+this.config.timeDifference,this.ready?this.config.throttled?void l.debug("Add message to batch is throttled! Message not added."):this.isMessageExcluded(t)?void l.debug("message excluded by config, not added to batch",t):void this._send(e,t):(l.debug("send - Aspen's not ready, queuing message"),void this._messageQueue.push({message:e,type:t})))},_send:function(e,t){switch(t){case"appConfig":e=i.extend({},_,e),e.aspenConfigUrl=this.configSourceUrl}"applicationName"in _&&!("applicationName"in e)&&(e.applicationName=_.applicationName);var n={};n.eventType=t,n.eventData=e,l.log("add to batch json message: "+a.stringify(n)),this.batchService.add(n)},_initSuccess:function(){l.log("Successful init"),this.ready=!0;for(var e=0,t=this._messageQueue.length;t>e;++e)this.send(this._messageQueue[e].message,this._messageQueue[e].type);this._messageQueue.length=0,this.send({screenWidth:screen.width,screenHeight:screen.height,browserName:navigator.appName,userAgent:navigator.userAgent,platform:navigator.platform},"systemInfo"),this.eInitSuccess.dispatch()},_initFailure:function(){l.log("Failed init"),this.disabled=!0,this.eInitFailure.dispatch()}}};t.exports=_},{"../core/app":10,"../cvp/browser":14,"../cvp/customevent":17,"../cvp/events":27,"../cvp/utils":50,"../vendor/json3":94,"./batchservice":3,"./configfile":4,"./log":6,"./sessionid":7,"./sessiontoken":8,"./transportmanager":9}],6:[function(e,t){var n=e("../cvp/log"),i=n.getLogger("Aspen");t.exports=i},{"../cvp/log":28}],7:[function(e,t){var n,i=e("./log");t.exports={set:function(e){return n?void i.debug("sessionId is already '"+n+"'; will NOT set to '"+e+"'"):(i.debug("setting sessionId to '"+e+"'"),void(n=e))},get:function(){return i.debug("retreiving ID '"+n+"'"),n}}},{"./log":6}],8:[function(e,t){function n(){return r.randomString(25)}function i(){return o||(s.debug("sessionToken does not exist; creating anew"),o=this.create()),s.debug("retreiving sessionToken '"+o+"'"),o}var r=e("../cvp/utils"),s=e("./log"),o=r.getQueryParam("sessionToken");t.exports={create:n,read:i}},{"../cvp/utils":50,"./log":6}],9:[function(e,t){var n=e("./aspencomm"),i=e("../cvp/utils"),r=e("../cvp/request"),s=(e("../vendor/json3"),e("./log")),o={Format:{JSON:"json",JSONP:"jsonp"},getDefaultFormats:function(){return[o.Format.JSONP]},init:function(e){this._config=e,this._transportFormat=this._config.transportFormats.shift(),this._bootstrapped=!1},bootstrapTM:function(){if(s.log("TransportManager::bootstrapTM","_bootstrapped:",this._bootstrapped),this._transportFormat===o.Format.JSON&&!this._bootstrapped){var e=this._config.servicesUrl;n.init(e),this._bootstrapped=!0,s.log("TransportManager::bootstrapTM","transportFormat:",this._transportFormat)}},createRequest:function(e,t,a,l,c){s.log("TransportManager::createRequest");var d=this._config.servicesUrl+e+"."+this._transportFormat,u=i.bind(a,c),h=i.bind(l,c);switch(this._transportFormat){case o.Format.JSON:n.request({url:d,method:"POST",data:{aspenJson:t}},u,h);break;case o.Format.JSONP:r.getJSONP({jsonpCallback:"parseCVPServicesInitialization",url:d,data:{aspenJson:t},success:u,failure:h})}},fallback:function(){return s.debug("TransportManager::fallback","current transport format failed",this._transportFormat),this._transportFormat=this._config.transportFormats.shift(),this._transportFormat?(s.debug("TransportManager::fallback","trying next transport format",this._transportFormat),!0):!1}};t.exports=o},{"../cvp/request":35,"../cvp/utils":50,"../vendor/json3":94,"./aspencomm":2,"./log":6}],10:[function(e,t){var n=/\bdmtdebug=(\w+)/,i=n.exec(window.location.href);if(!i&&window!==window.top)try{i=n.exec(window.top.location.href)}catch(r){}var s=!!i,o="https:"===window.location.protocol,a=o?"https://s.cdn.turner.com":"http://z.cdn.turner.com",l={VERSION:"2.8.4.1",BUILD_DATE:"2015-06-09T17:15:29-0400",FLASH_VERSION:"10.1.0.0",HTML5:"html5",FLASH:"flash",CDN_ORIGIN:a,DEBUG:s,DEBUG_LEVEL:s?i[1]:null,MAPPING_PATH:a+"/xslo/cvp/config/{site}/",MAPPING_FILE:"mapping.xml",OMNITURE_JS_URL:"",AD_MANAGER_URL:a+"/xslo/cvp/ads/freewheel/js/0/AdManager.js",AD_DFP_URL:"//www.google.com/uds/api/ima/1.7/9fd415db3bb953707e811e4827fe957b/default.IN.js",EXPRESS_INSTALL_URL:a+"/xslo/cvp/assets/flash/expressInstall.swf",FLASHXHR_SWF_URL:a+"/xslo/cvp/plugins/cvp/xhr/1.0/cvp_flashXhr.swf",LOG4JAVASCRIPT_URL:a+"/xslo/cvp/js/logging/log4javascript.js",EASYXDM_JS_URL:a+"/xslo/cvp/easyxdm/js/easyXDM.ugly.js",EASYXDM_SWF_URL:a+"/xslo/cvp/easyxdm/swf/easyxdm.swf",BLANK_MP4_URL:a+"/xslo/cvp/assets/video/blank.mp4",BLANK_IMG_URL:a+"/xslo/cvp/assets/video/blank.png",EXPIRED_MP4_URL:a+"/xslo/cvp/assets/video/video_not_available.mp4",EXPIRED_IMG_URL:a+"/xslo/cvp/assets/video/video_not_available.png",ERROR_CMS_PARSE:"CVP0201",ERROR_CMS_IO:"CVP0202",ERROR_CMS_LOADER:"CVP0206",ERROR_CONTENT_EXPIRED:"CVP2052"};t.exports=l},{}],11:[function(e){var t=e("./cvp/main");window.CVP=t},{"./cvp/main":29}],12:[function(e,t){var n=e("../vendor/when"),i=e("./utils"),r=e("../vendor/json3"),s=e("./log"),o=s.getLogger(),a={get:function(e){return e.method="GET",this._request(e)},getXml:function(e){return e.type="xml",this.get(e)},getJSON:function(e){var t=n.defer(),i=e.success;return e.type="json",e.success=function(e){try{var n=r.parse(e);t.resolve(n)}catch(i){t.reject(i)}},this.get(e),n(t.promise,i,e.error),t.promise},getJSONP:function(e){return this.JSONP._request(e)},post:function(e){return e.method="POST",this._request(e)},_request:function(e){var t=new XMLHttpRequest,i=n.defer();return t.onreadystatechange=function(){4===t.readyState&&(200<=t.status&&t.status<300||304===t.status?i.resolve(t.responseText):i.reject(t),t.onreadystatechange=Function.prototype,t.abort(),t=null)},n(i.promise,e.success,e.error),t.open(e.method,e.url,!0),t.send("POST"===e.method?e.data:null),i.promise}};a.JSONP={requestTimeout:5e3,maxRetries:0,_externalRoutes:{},requestMap:{},_counter:0,_request:function(e){return e=i.extend({timeout:this.requestTimeout,maxRetries:this.maxRetries},e),e.tries=0,e.deferred=n.defer(),o.debug("JSONP - creating request with timeout ",e.timeout," and maxRetries ",e.maxRetries),this._sendRequest(e),n(e.deferred.promise,e.success,e.error),e.deferred.promise},_sendRequest:function(e){var t=this,n=this._createCallback(e),i=this._createScript(n,e.url);if(!i){var r="JSONP - unable to create script for request "+e.url;throw o.error(r),e.deferred.reject(e.url),new Error(r)}e.timeout&&setTimeout(function(){t._onError(n,e)},e.timeout)},_onSuccess:function(e,t,n){if(this.requestMap[e]){if(this._destroyRequest(e,t),i.isString(n))try{n=r.parse(n)}catch(s){o.error("JSON failed to parse",s)}o.info("JSONP","success",t.url),t.deferred.resolve(n)}},_onError:function(e,t){if(this.requestMap[e]){if(this._destroyRequest(e,t),++t.tries,t.maxRetries&&t.tries<t.maxRetries)return o.warn("Request failed - resending"),void this._sendRequest(t);o.error("JSONP","error",t.url),t.deferred.reject(t.url)}},_destroyRequest:function(e,t){this._deregisterExternalCallback(t.jsonpCallback,e),delete this.requestMap[e],this._counter--;var n=document.getElementById(this._getScriptName(e));n&&(n.parentNode.removeChild(n),n=null)},_createScript:function(e,t){var n="script",i=document.getElementsByTagName(n)[0],r=document.createElement(n);return r.type="text/javascript",e&&(r.id=this._getScriptName(e)),r.src=t,r.async=!0,i.parentNode.insertBefore(r,i),r},_getScriptName:function(e){return"cvp_jsonp_"+e},_createCallback:function(e){var t=this;if(i.empty(e.jsonpCallback))return null;++this._counter;var n="request_"+this._counter+"_"+i.now();this.requestMap[n]=function(i){t._onSuccess(n,e,i)};var r=function(e){o.debug("JSONP","Internal CB received for request:",n),t.requestMap[n]?t.requestMap[n](e):o.debug("Request response came in after allotted time: ",n)};return this._registerExternalCallback(e.jsonpCallback,n,r),n},_registerExternalCallback:function(e,t,n){window[e]||this._createExternalCallback(e,this._routeExternalCallback(e)),this._externalRoutes[e]||(this._externalRoutes[e]=[]),this._externalRoutes[e].push({id:t,cb:n})},_routeExternalCallback:function(e){var t=this;return function(n){if(o.info("JSONP","routing:",e),!t._externalRoutes)return void o.error("JSONP","routes haven't been initialized");if(!t._externalRoutes[e])return void o.error("JSONP","routing hasn't been initialized for:",e);if(!t._externalRoutes[e].length)return void o.error("JSONP","no waiting requests for route:",e);var r=t._externalRoutes[e].shift();o.info("JSONP","request retrieved - id: ",r.id,"cb:",typeof r.cb),i.isFunc(r.cb)&&r.cb(n)}},_createExternalCallback:function(e,t){window[e]=t},_deregisterExternalCallback:function(e,t){for(var n=0,i=this._externalRoutes[e].length;i>n;n++){var r=this._externalRoutes[e][n];if(r.id===t)return o.info("JSONP","removing request from route:",e,"with id:",t),void this._externalRoutes[e].splice(n,1)}}},t.exports=a},{"../vendor/json3":94,"../vendor/when":96,"./log":28,"./utils":50}],13:[function(e,t){var n=e("./utils"),i=e("./static"),r=e("./shared"),s=e("../vendor/swfobject"),o=e("./events"),a={getDOMPlayer:-1!==navigator.appName.indexOf("Microsoft")?function(){return window[this.getId()]}:function(){return document[this.getId()]},sendMessage:function(e,t){return this.getDOMPlayer().sendMessage(e,t),this},getPlayer:function(e){return this._playerType===i.FLASH?(this.getDOMPlayer().getPlayerJS(e),this):this.getDOMPlayer()},setDefaultPlayer:function(e){return this.getDOMPlayer().setDefaultPlayer(e),this},embedSWF:function(){return this.embed.apply(this,arguments)},embed:function(e){if(this._playerType===i.FLASH){var t=this.getId(),a=this.getFlashVars();a.domId=i.sanitizeId(t);var l=this.getEmbed(),c=l.containerSwf,d=l.options,u=l.expressInstallSwf,h=r.validateFlashVersion(l.flashVersion),p={id:t,name:t};s.hasFlashPlayerVersion("1.0.0")||i.onCallback(t,["onNoFlashDetected"]),s.embedSWF(c,e,this.getWidth(),this.getHeight(),h,u,a,d,p)}else{var g=this.getPlayer();n.isFunc(g.embed)&&o.onReady(function(){g.embed(e)})}return this},removeSWF:function(){return this.remove.apply(this,arguments)},remove:function(){if(this.stop(),this._playerType===i.FLASH)s.removeSWF(this.getId());else{var e=this.getPlayer();n.isFunc(e.remove)&&e.remove()}return this},destroy:function(){var e=this.getId();if(i.findInstance(e)){if(this.remove(),this._playerType===i.FLASH);else{var t=this.getPlayer();n.isFunc(t.dispose)&&t.dispose()}i.unregisterInstance(e)}},play:function(e,t){return this.getDOMPlayer().playContent(e,t||{}),this},playFromObject:function(e,t){return this.getDOMPlayer().playFromObject(e,t||{}),this},reportAnalytics:function(e,t){return this.getDOMPlayer().reportAnalytics(e,t),this},replay:function(){return this.getDOMPlayer().replayContent(),this},playNextInQueue:function(){return this.getDOMPlayer().playNextInQueue(),this},pause:function(){return this.getDOMPlayer().pause(),this},resume:function(){return this.getDOMPlayer().resume(),this},stop:function(){return this.getDOMPlayer().stopContent(),this},queue:function(e,t,n){return"undefined"==typeof n&&(n=-1),this.getDOMPlayer().queue(e,t||{},n),this},queueFromObject:function(e,t,n){return"undefined"==typeof n&&(n=-1),this.getDOMPlayer().queueFromObject(e,t||{},n),this},dequeue:function(e){return this.getDOMPlayer().dequeue(e),this},emptyQueue:function(){return this.getDOMPlayer().emptyQueue(),this},setQueueAutoplay:function(e){return this.getDOMPlayer().setQueueAutoplay(e),this},getQueue:function(){return this.getDOMPlayer().getQueue()},seek:function(e){return this.getDOMPlayer().seek(e),this},mute:function(){return this.getDOMPlayer().mute(),this},unmute:function(){return this.getDOMPlayer().unmute(),this},setVolume:function(e){return this.getDOMPlayer().setVolume(e),this},getVolume:function(){return this.getDOMPlayer().getVolume()},isMuted:function(){return this.getDOMPlayer().isMuted()},getContentEntry:function(e){return this.getDOMPlayer().getContentEntry(e)},goFullscreen:function(){return this.getDOMPlayer().goFullscreen(),this},resize:function(e,t,n){return this.getDOMPlayer().resize(e,t,n),this},setMaxBitrate:function(e){return this.getDOMPlayer().setMaxBitrate(e),this},switchBitrateId:function(e){return this.getDOMPlayer().switchBitrateId(e),this},setAutoBitrateSwitch:function(e){return this.getDOMPlayer().setAutoBitrateSwitch(e),this},getAvailableBitrates:function(e){return this.getDOMPlayer().getAvailableBitrates(e)},getBitrateId:function(){return this.getDOMPlayer().getBitrateId()},setGroupOrder:function(e){return this.getDOMPlayer().setGroupOrder(e),this},getShareOptions:function(){return this.getDOMPlayer().getShareOptions()},setClosedCaptions:function(e,t){return this.getDOMPlayer().setClosedCaptions(e,t),this},setAdSection:function(e){return this.getDOMPlayer().setAdSection(e),this},setAdKeyValue:function(e,t){return this.getDOMPlayer().setAdKeyValue(e,t),this},getAdKeyValues:function(){return this.getDOMPlayer().getAdKeyValues()},clearAdKeyValues:function(){return this.getDOMPlayer().clearAdKeyValues(),this},setAdExchangeValue:function(e,t){return this.getDOMPlayer().setAdExchangeValue(e,t),this},setAdVisibility:function(e){return this.getDOMPlayer().setAdVisibility(e),this},switchAdContext:function(e){return this.getDOMPlayer().switchAdContext(e),this},switchTrackingContext:function(e){return this.getDOMPlayer().switchTrackingContext(e),this},setTrackingInterval:function(e){return this.getDOMPlayer().setTrackingInterval(e),this},setDataSrc:function(e){return this.getDOMPlayer().setDataSrc(e),this},setFileKey:function(e){return this.getDOMPlayer().setFileKey(e),this},sendUIMessage:function(e,t){return this.getDOMPlayer().sendUIMessage(e,t),this},sendUserReportedIssue:function(e){return this.getDOMPlayer().sendUserReportedIssue(e),this}};t.exports=a},{"../vendor/swfobject":95,"./events":27,"./shared":36,"./static":37,"./utils":50}],14:[function(e,t){function n(e){var t={};for(var n in d)t[n]=d[n].exec(e);return t}var i=e("./version"),r=window.navigator.userAgent,s="object"==typeof console&&"function"==typeof console.log?function(){console.log.apply(console,arguments)}:function(){},o={IOS:"iOS",OSX:"OSX",ANDROID:"Android",SAFARI:"Safari",SILK:"Silk",CHROME:"Chrome",FIREFOX:"Firefox",OPERA:"Opera",IE:"Internet Explorer",IPAD:"iPad",IPOD:"iPod",IPHONE:"iPhone",KINDLE:"Kindle",DESKTOP:"desktop",MOBILE:"mobile",TABLET:"tablet"},a=document.createElement("video"),l=/^(maybe|probably)$/,c=function(e){try{return l.test(a.canPlayType(e))}catch(t){return!1}};o.supports={},o.supports.video="function"==typeof a.canPlayType,o.supports.mp4=o.supports.video&&c("video/mp4"),o.supports.m3u8=o.supports.video&&(c("application/x-mpegURL")||c("application/vnd.apple.mpegURL"));var d={Safari:/ Safari\/\d+(?:\.\d+){0,2}/,Version:/ Version\/(\d+(?:\.\d+){0,2})/,Opera:/^Opera\/\d+(?:\.\d+){0,2}/,Silk:/ Silk\/(\d+(?:\.\d+){0,2})/,InternetExplorer:/; MSIE (\d+(?:\D\d+){0,2})/,InternetExplorer11:/; Trident\/[^)]*; rv:(\d+(?:\D\d+){0,2})/,Firefox:/ Firefox\/(\d+(?:\D\d+){0,2})/,Chrome:/ Chrome\/(\d+(?:\D\d+){0,2})/,RenderingEngine:/ (AppleWebKit|Trident|Gecko|Presto)\/(\d+(?:\D\d+){0,2})/,AppleDevice:/ \((iP(?:[ao]d|hone));/,Android:/; Android(?: (\d+(?:\D\d+){0,2}))?[;)]/,iOS:/ OS (\d+(?:\D\d+){0,2}) like(?: Mac)? OS X/,OSX:/ OS X (\d+(?:\D\d+){0,2})/,MobileSafari:/ Mobile(?:\/\S+)? Safari\//,MobileFirefox:/; Mobile; .+ Firefox\/| Fennec\//,TabletFirefox:/; Tablet; .+ Firefox\//,IEMobile:/; IEMobile\/(\d+(?:\.\d+){0,2})/,OperaMobile:/; Opera (Mini|Mobi)\//,OperaTablet:/; Opera Tablet\//,SilkAccelerated:/ Silk-Accelerated=(true|false)/};!function(e){function t(e,t){var n=t||window,i=[].slice.call(arguments,2);return function(){return e.apply(n,i.concat([].slice.call(arguments)))}}e.Firefox?(o.name=o.FIREFOX,o.version=new i(e.Firefox[1])):e.InternetExplorer?(o.name=o.IE,o.version=new i(e.InternetExplorer[1])):e.InternetExplorer11?(o.name=o.IE,o.version=new i(e.InternetExplorer11[1])):e.Opera&&e.Version?(o.name=o.OPERA,o.version=new i(e.Version[1])):e.Silk?(o.name=o.SILK,o.version=new i(e.Silk[1])):e.Chrome?(o.name=o.CHROME,o.version=new i(e.Chrome[1])):e.Safari&&e.Version&&(o.name=o.SAFARI,o.version=new i(e.Version[1])),o.engine={},e.RenderingEngine&&(o.engine.name=e.RenderingEngine[1],o.engine.version=new i(e.RenderingEngine[2])),o.os={},e.Android?(o.os.name=o.ANDROID,"undefined"!=typeof e.Android[1]&&(o.os.version=new i(e.Android[1]))):e.iOS?(o.os.name=o.IOS,o.os.version=new i(e.iOS[1])):e.OSX&&(o.os.name=o.OSX,o.os.version=new i(e.OSX[1])),o.device={},e.AppleDevice?o.device.name=e.AppleDevice[1]:e.Silk&&(o.device.name=o.KINDLE),o.device.type=o.DESKTOP,(e.MobileSafari||e.MobileFirefox||e.IEMobile||e.OperaMobile)&&(o.device.type=o.MOBILE),(e.TabletFirefox||e.OperaTablet||e.Android&&o.device.type!==o.MOBILE)&&(o.device.type=o.TABLET);var n=function(e,t,n){var i,r=/^(!?~|[!=><]=?)?(\d.*)$/,a=function(e,t){var n,i=r.exec(t),s=e.is;if(!i)throw new Error("checkVersion: The pattern -- "+t+" -- was not considered valid.");switch(i[1]){case"~":s=e.is;break;case"!~":s=e.isnt;break;case"=":case"==":s=e.eq;break;case"!":case"!=":s=e.ne;break;case">":s=e.gt;break;case">=":s=e.gte;break;case"<":s=e.lt;break;case"<=":s=e.lte}return n=s.call(e,i[2])};switch(e){case"browser":i=t===o.name,n&&(i=i&&a(o.version,n));break;case"engine":i=t===o.engine.name,n&&(i=i&&a(o.engine.version,n));break;case"os":i=t===o.os.name,n&&(i=i&&a(o.os.version,n));break;case"device":i=t===o.device.name;break;case"platform":i=t===o.device.type;break;default:s('Browser.is() did not understand property "'+e+'"')}return i};o.isBrowser=t(n,this,"browser"),o.isEngine=t(n,this,"engine"),o.isOS=t(n,this,"os"),o.isDevice=t(n,this,"device"),o.isPlatform=t(n,this,"platform"),o.isOS(o.ANDROID,"<4")&&(o.supports.m3u8=!1),o.device.name===o.KINDLE&&(o.device.type=o.MOBILE),o.device.name===o.IPAD&&(o.device.type=o.TABLET),o.forcesFullscreen=o.isPlatform(o.MOBILE)}(n(r)),t.exports=o},{"./version":51}],15:[function(require,module,exports){function jsonTextToJsObject(jsontext){if(logger.log("Convert::jsonTextToJsObject"),Utils.isNull(jsontext))return null;if(jsontext=Utils.trim(jsontext),""===jsontext)return null;var jsobject=null;try{jsobject=JSON3.parse(jsontext)}catch(e){if(logger.warn("Provided text was not valid JSON.  Attempting to eval()..."),isValidJSON(jsontext))try{jsobject=eval("("+jsontext+")")}catch(e2){logger.error("Unable to eval text into JS object.")}}return jsobject}function xmlTextToXmlDoc(e){logger.log("Convert::xmlTextToXmlDoc");var t;return e?(t=XML.stringToDoc(e),t||(logger.warn("Provided text was not valid XML.  Attempting to clean and parse again..."),e=XML.cleanString(e),t=XML.stringToDoc(e)),t):null}function xmlDocToXmlText(e){return logger.log("Convert::xmlDocToXmlText"),XML.docToString(e)}function xmlDocToJsonText(e){return logger.log("Convert::xmlDocToJsonText"),JsonConverter.xmlToJson(e)}function xmlDocToJsObject(e){return logger.log("Convert::xmlDocToJsObject"),JsonConverter.xmlToObject(e)}function xmlTextToJsonText(e){return logger.log("Convert::xmlTextToJsonText"),xmlDocToJsonText(xmlTextToXmlDoc(e))}function xmlTextToJsObject(e){return logger.log("Convert::xmlTextToJsObject"),jsonTextToJsObject(xmlTextToJsonText(e))}var JSON3=require("../vendor/json3"),Utils=require("./utils"),JsonConverter=require("./util/jsonconverter"),XML=require("./util/xml"),Log=require("./log"),logger=Log.getLogger(),allBackslashPairsRegex=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,allSimpleValueTokensRegex=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,allOpenBracketsRegex=/(?:^|:|,)(?:\s*\[)+/g,onlyValidLeftoverCharsRegex=/^[\],:{}\s]*$/,isValidJSON=function(e){
return onlyValidLeftoverCharsRegex.test(e.replace(allBackslashPairsRegex,"@").replace(allSimpleValueTokensRegex,"]").replace(allOpenBracketsRegex,""))};module.exports={jsonTextToJsObject:jsonTextToJsObject,xmlTextToXmlDoc:xmlTextToXmlDoc,xmlDocToXmlText:xmlDocToXmlText,xmlDocToJsonText:xmlDocToJsonText,xmlDocToJsObject:xmlDocToJsObject,xmlTextToJsonText:xmlTextToJsonText,xmlTextToJsObject:xmlTextToJsObject}},{"../vendor/json3":94,"./log":28,"./util/jsonconverter":46,"./util/xml":49,"./utils":50}],16:[function(e,t){var n=e("./static"),i=e("./api"),r=e("./shared"),s=e("./utils"),o=e("../core/app"),a=e("./browser"),l=e("../vendor/swfobject"),c=e("./players/html5"),d=e("./players/null"),u=e("./log"),h=e("./util/log4js"),p=e("../flash/global"),g=function(e){var t=this;this.options=s.extend({id:"cvp_player",width:"320",height:"240",flashVars:{},initialize:function(){}},e);var i=u.getLogger(this.options.id);if(this.options.embed=s.extend({containerSwf:"",expressInstallSwf:o.EXPRESS_INSTALL_URL,flashVersion:o.FLASH_VERSION},this.options.embed),this.options.embed.options=s.extend({quality:"high",bgcolor:"#000000",allowFullScreen:"true",allowScriptAccess:"always"},this.options.embed.options),!this.options.embed.containerSwf)throw i.error("Invalid containerSwf...exiting"),new Error("Invalid containerSwf");this.options.initialize();var g=this.options.id,f=this.options.width,_=this.options.height,m=this.options.flashVars,v=this.options.embed;this._playerType=this.options.playerType;var y=[o.FLASH,o.HTML5];this._playerType&&-1!==s.indexOf(y,this._playerType)||(this._playerType=o.FLASH,a.supports.video&&!l.hasFlashPlayerVersion("1.0.0")&&(this._playerType=o.HTML5));var C=null;if(this._playerType===o.HTML5?(m.site&&m.profile?(i.info("instantiating the HTML5 player"),C=new c(this.options)):(i.error("invalid HTML5 params...instantiating null player"),this._playerType=!1,C=new d(this.options)),this.getDOMPlayer=function(){return C}):(i.info("instantiating the Flash player"),h.install(),s.extend(window,p)),n.findInstance(g)||s.byId(g))throw i.error(g+" is already in use...exiting"),new Error(g+" is already in use");if(this.getId=function(){return g},this.getWidth=function(){return f},this.getHeight=function(){return _},this.getFlashVars=function(){return m},this.getEmbed=function(){return v},this.getPlayerType=function(){return this._playerType},!r.createCallbackHandler(g))throw i.error('callback handler for id "'+g+'" could not be created...exiting'),new Error('callback handler for id "'+g+'" could not be created...exiting');this.callbacks={},delete this.options.initialize;var E,P;for(E in this.options)s.hasOwn(this.options,E)&&(P=this.options[E],s.isFunc(P)&&(this.callbacks[E]=P));var b={handleCallBack:function(e){var n,r;if(arguments.length){var o=s.slice(arguments,1);if(r=t[e],s.isFunc(r))try{n=r.apply(t,o)}catch(a){i.warn("exception on internal CB "+e,a.message)}if(r=t.callbacks[e],s.isFunc(r))try{n=r.apply(t,o)}catch(l){i.error("exception on user CB "+e,l.message)}}return n},onPageOrientationChange:function(e){t.isCVPReady()&&e!==t.getPageOrientation()&&(this._sendPageStateChange({orientation:e}),this.handleCallBack("onPageOrientationChange",g,e))},onPageVisibilityChange:function(e){t.isCVPReady()&&e!==t.isPageVisible()&&(this.handleCallBack("onPageVisibilityChange",g,e),this._fireCVPVisibilityChange())},onViewportVisibilityChange:function(e){t.isCVPReady()&&e!==t.isViewportVisible()&&(this.handleCallBack("onViewportVisibilityChange",g,e),this._fireCVPVisibilityChange())},_fireCVPVisibilityChange:function(){this.handleCallBack("onCVPVisibilityChange",g,t.isCVPVisible())},_sendPageStateChange:function(e){this._invokeAPI("sendMessage","pageStateChange",e)},_invokeAPI:function(e){var n=s.slice(arguments,1);if(e in t)try{t[e].apply(t,n)}catch(r){i.warn("[_invokeAPI] Error calling: "+e)}}},T=function(e){if(s.hasOwn(b,e))try{return b[e].apply(b,s.slice(arguments,1))}catch(t){i.warn("exception on message "+e,t.message)}},A=!1,w=m.contentId||"",S=m.context||"",k=S,I=0,L=0,x=0,R=0,D=-1,O=!1,F=!1,M=!1,N=window.orientation||"unknown",B=!0,V=!0;return this.isCVPReady=function(){return A},this.getDOMPlayerInstance=function(){return k},this.getContentId=function(){return w},this.getContext=function(){return S},this.getContentWidth=function(){return I},this.getContentHeight=function(){return L},this.getDuration=function(){return x},this.getPlayhead=function(){return R},this.getAbsolutePlayhead=function(){return D},this.isBuffering=function(){return O},this.isPaused=function(){return F},this.isFullscreen=function(){return M},this.getPageOrientation=function(){return N},this.isPageVisible=function(){return B},this.isViewportVisible=function(){return V},this.isCVPVisible=function(){return B&&V},this.onCVPReady=function(){A=!0},this.onPlayerReady=function(){k=this.getDOMPlayerInstance()},this.onPageVisibilityChange=function(e,t){B=t},this.onViewportVisibilityChange=function(e,t){V=t},this.onContentMetadata=function(e,t,n,i,r){w=t,R=0,x=n,I=i,L=r},this.onContentBegin=function(e,t){F=!0,w=t},this.onAdPlay=function(){F=!1},this.onContentPlay=function(){F=!1},this.onContentBuffering=function(e,t,n){O=n},this.onContentPlayhead=function(e,t,n,i,r){R=n,D=r||-1},this.onContentPause=function(e,t,n){F=n},this.onContentResize=function(e,t,n,i){M=i},n.registerInstance(g,this,T),this};g.prototype=i,t.exports=g},{"../core/app":10,"../flash/global":52,"../vendor/swfobject":95,"./api":13,"./browser":14,"./log":28,"./players/html5":30,"./players/null":31,"./shared":36,"./static":37,"./util/log4js":47,"./utils":50}],17:[function(e,t){var n=e("../vendor/Class"),i=e("./utils"),r=e("./log"),s=r.getLogger(),o=n.extend({init:function(e){this._type=e,this._listeners=[]},addListener:function(e,t){i.isFunc(e)||s.warn("A function was not provided to `addListener`."),this._listeners.push({fn:e,ctxt:t})},removeListener:function(e,t){for(var n,i=0,r=this._listeners;i<r.length;)n=r[i],n.fn===e&&n.ctxt===t?r.splice(i,1):++i},dispatch:function(){for(var e,t=0,n=this._listeners.slice(),i=n.length;i>t;++t)e=n[t],e.fn.apply(e.ctxt,arguments)}});t.exports=o},{"../vendor/Class":92,"./log":28,"./utils":50}],18:[function(e,t){var n=e("../../vendor/Class"),i=n.extend({getType:function(){throw new Error("'getType' must be implemented by child class.")},canUse:function(){throw new Error("'canUse' must be implemented by child class.")},isComposable:function(){return!0},start:function(){throw new Error("'start' must be implemented by child class.")},stop:function(){throw new Error("'stop' must be implemented by child class.")}});t.exports=i},{"../../vendor/Class":92}],19:[function(e,t){var n=e("../../vendor/Class"),i=e("../utils"),r=e("../log"),s=e("./pagevisibilitystrategy"),o=e("./pagefocusstrategy"),a=e("./pagefocusinstrategy"),l=r.getLogger(),c=n.extend({init:function(e){e=i.extend({callback:null,strategies:null,mode:c.AGGRESSIVE},e),this._mode=e.mode,this._callback=e.callback,this._visible=null,this._onChangeBind=i.bind(this._onChange,this),this._availableStrategies=e.strategies||[new s({callback:this._onChangeBind}),new o({callback:this._onChangeBind}),new a({callback:this._onChangeBind})],this._strategies=[];for(var t=0;t<this._availableStrategies.length;++t)if(this._availableStrategies[t].canUse()){if(this._strategies.length>0&&!this._availableStrategies[t].isComposable())continue;if(this._strategies.push(this._availableStrategies[t]),l.log("[PageFocusDetector] Using detection strategy: "+this._availableStrategies[t].getType()),this._mode!==c.AGGRESSIVE){l.log("[PageFocusDetector] Conservative mode - sticking with one strategy");break}}this._strategies.length||l.log("[PageFocusDetector] Warning - no valid detection strategies found.")},_onChange:function(e){(null==this._visible||this._visible!==e)&&(this._visible=e,this._callback&&this._callback(e))},start:function(){i.each(this._strategies,function(e){e.start()})},stop:function(){i.each(this._strategies,function(e){e.stop()})}});c.CONSERVATIVE="conservative",c.AGGRESSIVE="aggressive",t.exports=c},{"../../vendor/Class":92,"../log":28,"../utils":50,"./pagefocusinstrategy":20,"./pagefocusstrategy":21,"./pagevisibilitystrategy":23}],20:[function(e,t){var n=e("./basestrategy"),i=e("../utils"),r=e("../browser"),s=e("../events"),o=n.extend({init:function(e){e=i.extend({callback:null},e),this._delayFireBlur=!1,this._timerId=null,this._callback=e.callback,this._onFocusFiredBind=i.bind(this._onFocusFired,this),this._onBlurFiredBind=i.bind(this._onBlurFired,this),this._fireBlurBind=i.bind(this._fireBlur,this)},getType:function(){return"PageFocusInStrategy"},canUse:function(){return r.isBrowser(r.IE)===!0},_onFocusFired:function(){return this._delayFireBlur?(this._timerId&&window.clearTimeout(this._timerId),void(this._delayFireBlur=!1)):void this._onChange(!0)},_onBlurFired:function(){this._delayFireBlur=!0,this._timerId=window.setTimeout(this._fireBlurBind,500)},_fireBlur:function(){this._delayFireBlur&&this._callback&&this._onChange(!1),this._delayFireBlur=!1},_onChange:function(e){this._callback&&this._callback(e)},start:function(){s.addListener(document,"focusin",this._onFocusFiredBind),s.addListener(document,"focusout",this._onBlurFiredBind)},stop:function(){s.removeListener(document,"focusin",this._onFocusFiredBind),s.removeListener(document,"focusout",this._onBlurFiredBind)}});t.exports=o},{"../browser":14,"../events":27,"../utils":50,"./basestrategy":18}],21:[function(e,t){var n=e("./basestrategy"),i=e("../utils"),r=e("../browser"),s=e("../events"),o=n.extend({init:function(e){e=i.extend({callback:null},e),this._delayFireBlur=!1,this._timerId=null,this._callback=e.callback,this._onFocusFiredBind=i.bind(this._onFocusFired,this),this._onBlurFiredBind=i.bind(this._onBlurFired,this),this._fireBlurBind=i.bind(this._fireBlur,this)},getType:function(){return"PageFocusStrategy"},canUse:function(){return r.isBrowser(r.IE)===!1},_onFocusFired:function(){return this._delayFireBlur?(this._timerId&&window.clearTimeout(this._timerId),void(this._delayFireBlur=!1)):void this._onChange(!0)},_onBlurFired:function(){this._delayFireBlur=!0,this._timerId=window.setTimeout(this._fireBlurBind,500)},_fireBlur:function(){this._delayFireBlur&&this._callback&&this._onChange(!1),this._delayFireBlur=!1},_onChange:function(e){this._callback&&this._callback(e)},start:function(){s.addListener(window,"focus",this._onFocusFiredBind),s.addListener(window,"blur",this._onBlurFiredBind)},stop:function(){s.removeListener(window,"focus",this._onFocusFiredBind),s.removeListener(window,"blur",this._onBlurFiredBind)}});t.exports=o},{"../browser":14,"../events":27,"../utils":50,"./basestrategy":18}],22:[function(e,t){var n=e("../../vendor/Class"),i=e("../utils"),r=e("../events"),s=n.extend({init:function(e){e=i.extend({callback:function(){}},e),this._callback=e.callback,this.handleOrientationBind=i.bind(this._handleScroll,this)},_handleScroll:function(){var e;switch(window.orientation){case-90:case 90:e="landscape";break;default:e="portrait"}this._callback&&this._callback(e)},start:function(){r.addListener(window,"orientationchange",this.handleOrientationBind)},stop:function(){r.removeListener(window,"orientationchange",this.handleOrientationBind)}});t.exports=s},{"../../vendor/Class":92,"../events":27,"../utils":50}],23:[function(e,t){var n=e("./basestrategy"),i=e("../utils"),r=e("../events"),s=n.extend({init:function(e){e=i.extend({callback:null},e),this._callback=e.callback,this._eventName=null,this._propName=null;for(var t=[{event:"msvisibilitychange",prop:"msHidden"},{event:"webkitvisibilitychange",prop:"webkitHidden"},{event:"mozvisibilitychange",prop:"mozHidden"},{event:"visibilitychange",prop:"hidden"}],n=0;n<t.length;++n)t[n].prop in document&&(this._propName=t[n].prop,this._eventName=t[n].event);this._onChangeBind=i.bind(this._onChange,this)},getType:function(){return"PageVisibilityStrategy"},canUse:function(){return null!=this._propName},_onChange:function(){var e=this._getHiddenValue();this._callback&&this._callback(!e)},_getHiddenValue:function(){return document[this._propName]},start:function(){r.addListener(document,this._eventName,this._onChangeBind)},stop:function(){r.removeListener(document,this._eventName,this._onChangeBind)}});t.exports=s},{"../events":27,"../utils":50,"./basestrategy":18}],24:[function(e,t){var n=e("../../vendor/Class"),i=e("../utils"),r=e("../events"),s=e("../log"),o=s.getLogger(),a=n.extend({init:function(e){e=i.extend({callback:function(){},delay:500},e),this._callback=e.callback,this._interval=e.interval,o.log("[ScrollDetector] debouncing with a delay of: "+e.delay),this.handleScrollBind=i.debounce(i.bind(this._handleScroll,this),e.delay)},_handleScroll:function(){var e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,t=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,n=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,i=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;this._callback&&this._callback({scrollTop:e,scrollLeft:t,windowWidth:n,windowHeight:i})},start:function(){r.addListener(window,"scroll",this.handleScrollBind),r.addListener(window,"resize",this.handleScrollBind)},stop:function(){r.removeListener(window,"scroll",this.handleScrollBind),r.removeListener(window,"resize",this.handleScrollBind)}});t.exports=a},{"../../vendor/Class":92,"../events":27,"../log":28,"../utils":50}],25:[function(e,t){var n=e("../../vendor/Class"),i=e("../utils"),r=e("./scrolldetector"),s=n.extend({init:function(e){e=i.extend({delay:500},this._validateTargetOptions(e)),this._targets=[],this.addTarget(e),this._scrollDetector=new r({callback:i.bind(this._onScroll,this),delay:e.delay})},_validateTargetOptions:function(e){return i.extend({elementId:null,callback:function(){}},e)},addTarget:function(e){if(e=this._validateTargetOptions(e),null!=e.elementId){var t=e.elementId,n=e.callback;this._targets.push({elementId:t,callback:n,clipped:!1})}},_onScroll:function(e){function t(e){var t,n,i={top:0,left:0};return(t=e&&e.ownerDocument)?(n=t.documentElement,"undefined"!=typeof e.getBoundingClientRect&&(i=e.getBoundingClientRect()),{top:i.top+r-(n.clientTop||0),left:i.left+s-(n.clientLeft||0),width:e.offsetWidth,height:e.offsetHeight}):null}function n(e,t,n){return e!=t&&n&&n(!e),e}var r=e.scrollTop,s=e.scrollLeft,o=e.windowWidth,a=e.windowHeight;i.each(this._targets,function(e){var l=e.elementId;if(i.isString(l)&&(l=i.byId(l)),l){var c=t(l);c&&(r>=c.top+c.height||s>=c.left+c.width||c.top>=r+a||c.left>=s+o?e.clipped=n(!0,e.clipped,e.callback):c.top>r&&c.top+c.height<r+a&&(e.clipped=n(!1,e.clipped,e.callback)))}})},start:function(){this._scrollDetector.start()},stop:function(){this._scrollDetector.stop()}});t.exports=s},{"../../vendor/Class":92,"../utils":50,"./scrolldetector":24}],26:[function(e,t){function n(e){var t=""+i.AD_ERROR+s.AD_RUNTIME_ERROR+o.LOW;switch(e){case a.AD_TYPE_NOT_TRAFFICKED:return""+i.AD_ERROR+s.AD_RUNTIME_ERROR+o.HIGH+"4000";case a.NO_AD_PLAYED_AT_AD_SPOT:return""+i.AD_ERROR+s.AD_RUNTIME_ERROR+o.HIGH+"4001";case a.AD_RULE_FAILED:return t+"4006";case a.AD_SKIPPED_DUE_TO_SENSITIVITY:return t+"4005";case a.AD_SKIPPED_BY_JAVASCRIPT:return t+"4004";case a.PLAY_CALL_2ND_PARAM_DISABLED_AD:return t+"4003";case a.AD_SERVER_NOT_CONFIGURED:return""+i.AD_ERROR+s.AD_RUNTIME_ERROR+o.HIGH+"4002";case a.AD_EXISTS_BUT_FAILED:return""+i.AD_ERROR+s.AD_RUNTIME_ERROR+o.HIGH+"4007";default:return""+i.AD_ERROR+s.AD_RUNTIME_ERROR+o.HIGH+"4009"}}var i={ASPEN_REPORTING:"AS",CONTENT_ERROR:"CT",AD_ERROR:"AD",PLAYER_ERROR:"PL",CONTAINER_ERROR:"CR",EXTERNAL_ERROR:"EX"},r={PLAYER_CONFIG_ERROR:"PC",PLAYER_INIT_ERROR:"PI",VIDEO_ASSET_ERROR:"VA",NOT_AVAILABLE_:"NA",CONTENT_TOKEN_SERVICE_ERROR:"CA",TOKEN_SERVICE_ERROR:"TS",CLOSED_CAPTION_ERROR:"CC"},s={AD_LOAD_ERROR:"LD",AD_INIT_ERROR:"IN",AD_RUNTIME_ERROR:"RT",FW_NOTIFICATION:"FN"},o={HIGH:"hi",MEDIUM:"md",LOW:"lo"},a={AD_TYPE_NOT_TRAFFICKED:"ad type not trafficked",NO_AD_PLAYED_AT_AD_SPOT:"slot finished but no ad to play in slot",AD_SKIPPED_DUE_TO_SENSITIVITY:"ad skipped due to ad sensitivity setting",AD_SERVER_NOT_CONFIGURED:"no ad server is configured",PLAY_CALL_2ND_PARAM_DISABLED_AD:"ad was disabled via optional second param on play call",AD_SKIPPED_BY_JAVASCRIPT:"skipped as directed by the javascript callback",AD_RULE_FAILED:"skipped because did not pass ad rules",AD_PLAYBACK_ERROR:"unknown ad playback error",AD_EXISTS_BUT_FAILED:"ad exists but failed to play in slot",AD_INTERRUPTED:"slot was interrupted"};t.exports={ErrorType:i,PlayerErrorSubType:r,AdErrorSubType:s,ErrorLevel:o,ErrorMessage:a,determineAdErrorCode:n}},{}],27:[function(e,t,n){function i(e){l.addDomLoadEvent(e)}function r(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else{n.$$guid||(n.$$guid=u++),e._cvpStoredEvents||(e._cvpStoredEvents={});var i=e._cvpStoredEvents[t];i||(i=e._cvpStoredEvents[t]={},e["on"+t]&&(i[0]=e["on"+t]),e["on"+t]=o),i[n.$$guid]=n}}function s(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e._cvpStoredEvents&&e._cvpStoredEvents[t]&&n.$$guid&&delete e._cvpStoredEvents[t][n.$$guid]}function o(e){e=e||a(window.event);var t,n=!0,i=this._cvpStoredEvents[e.type];for(t in i)c.hasOwn(i,t)&&(this.$$handler=i[t],this.$$handler(e)===!1&&(n=!1));return this.$$handler&&(this.$$handler=null),n}function a(e){return e.preventDefault=a._preventDefault,e.stopPropagation=a._stopPropagation,e}var l=e("../vendor/swfobject"),c=e("./utils"),d=e("./customevent"),u=1;a._preventDefault=function(){this.returnValue=!1},a._stopPropagation=function(){this.cancelBubble=!0},n.onReady=i,n.addListener=r,n.removeListener=s,n.CustomEvent=d},{"../vendor/swfobject":95,"./customevent":17,"./utils":50}],28:[function(e,t){function n(e){if(h){var t=typeof console[e];L[e]=t===o||t===s&&p?u.call(console[e],console):g}}function i(e){var t=this;this.id=e||"",this.setLevel(w),this._logger={};for(var n in L)(function(e,n){t._logger[e]=function(){var i,r;return r=e.toUpperCase(),t.getLevel()>=P[r]?(i=c.call(arguments),i.unshift("["+m+"|"+v+"|"+t.id+"|"+(f()-_)+"]",r),n.apply(t,i)):void 0},t[e]=function(){return t._logger[e].apply(t._logger,arguments)}})(n,L[n])}for(var r=e("../core/app"),s="object",o="function",a="string",l="number",c=Array.prototype.slice,d=Function.prototype,u=d.bind,h=typeof console===s,p=typeof u===o,g=function(){if(h){var e=typeof console.log;if(e===o||e===s&&p)return u.call(console.log,console)}return d}(),f=typeof Date.now===o?Date.now:function(){return(new Date).getTime()},_=f(),m="CVP",v=window.self===window.top?"_top":window.name||"",y=["error","warn","info","debug","log"],C=[].concat("fatal",y,"trace"),E=[].concat("none",C,"all"),P={},b=null,T=0,A=E.length;A>T;++T)b=E[T],P[b.toUpperCase()]=T;var w=P.WARN,S=/NO|NONE|OFF|SILENT|QUIET/,k=function(e){return e=e.toUpperCase(),P[e]||(S.test(e)?P.NONE:P.ALL)},I=function(e){switch(typeof e){case a:return k(e);case l:return e;default:return w}};r.DEBUG_LEVEL&&(w=I(r.DEBUG_LEVEL));for(var L={},x=0,R=C.length;R>x;++x)n(C[x]);i.prototype.setLevel=function(e){return this.loggerLevel=I(e),this.loggerLevel},i.prototype.getLevel=function(){return this.loggerLevel};var D=[],O=function(e){return null==e&&(e=""),D[e]=D[e]||new i(e),D[e]};t.exports={Level:P,getDefaultLevel:function(){return w},setDefaultLevel:function(e){return w=I(e)},getLogger:O}},{"../core/app":10}],29:[function(e,t){var n=e("../core/app"),i=e("./static"),r=e("./core"),s=e("./shared"),o=e("./utils");i.Class=e("../vendor/Class"),i.swfobject=e("../vendor/swfobject"),i.Utils=o,i.Utils.CommandQueue=e("./util/commandqueue"),i.Utils.Asset=e("./util/asset"),i.Utils.Dependency=e("./util/dependency"),i.Utils.DependencyManager=e("./util/dependencymanager"),i.Utils.JsonConverter=e("./util/jsonconverter"),i.Utils.XML=e("./util/xml"),i.Utils.Timing=e("./util/timing"),i.Utils.ViewportDetector=e("./detectors/viewportdetector"),i.Utils.PageFocusDetector=e("./detectors/pagefocusdetector"),i.Ajax=e("./ajax"),i.Events=e("./events"),i.JSON=e("../vendor/json3"),i.Log=e("./log"),i.Version=e("./version"),i.Browser=e("./browser"),i.Request=e("./request"),i.Store=e("./store"),i.PluginManager=e("./pluginmanager"),i.Plugins=e("./plugins"),i.init=function(e){var t,i;if(!o.isSimpleObject(e))throw new Error("CVP.init() requires one param: a simple object");for(t in e)o.hasOwn(e,t)&&(i=e[t],n._cvpsetup[t]=o.isSimpleObject(i)?o.extend(n._cvpsetup[t],i):i)},i.createPlayer=function(e){return new r(e)},i.getSessionToken=function(){return"Aspen"in window?window.Aspen.getSessionToken():void 0};var a=function(e){return i.createPlayer(e)};s.addBeforeUnLoadEvent(i.cleanup),t.exports=o.extend(a,i)},{"../core/app":10,"../vendor/Class":92,"../vendor/json3":94,"../vendor/swfobject":95,"./ajax":12,"./browser":14,"./core":16,"./detectors/pagefocusdetector":19,"./detectors/viewportdetector":25,"./events":27,"./log":28,"./pluginmanager":32,"./plugins":33,"./request":35,"./shared":36,"./static":37,"./store":38,"./util/asset":40,"./util/commandqueue":41,"./util/dependency":44,"./util/dependencymanager":45,"./util/jsonconverter":46,"./util/timing":48,"./util/xml":49,"./utils":50,"./version":51}],30:[function(e,t){var n=e("../static"),i=e("./null"),r=e("../util/commandqueue"),s=e("../utils"),o=e("../log"),a=e("../../html5/api"),l=s.bind,c=o.getLogger(),d=function(e){this._instance=new e(this._options),this._instance.ePlayerLoaded.addListener(this._onPlayerLoaded,this),this._instance.ePlayerLoadError.addListener(this._onPlayerLoadError,this),this._instance.ePlayerReady.addListener(this._onPlayerReady,this),this._instance.ePlayerReady.addListener(this._onCVPReady,this),this._instance.ePlayerReady.addListener(l(this._onCallBack,this,"onPlayerReady")),this._instance.ePlayerReady.addListener(l(this._onCallBack,this,"onCVPReady")),this._instance.eContentBegin.addListener(l(this._onCallBack,this,"onContentBegin")),this._instance.eContentPlay.addListener(l(this._onCallBack,this,"onContentPlay")),this._instance.eContentPause.addListener(l(this._onCallBack,this,"onContentPause")),this._instance.eContentEnd.addListener(l(this._onCallBack,this,"onContentEnd")),this._instance.eContentComplete.addListener(l(this._onCallBack,this,"onContentComplete")),this._instance.eContentEntryLoad.addListener(l(this._onCallBack,this,"onContentEntryLoad")),this._instance.eContentEntryLoadError.addListener(l(this._onCallBack,this,"onContentEntryLoadError")),this._instance.eContentMetadata.addListener(l(this._onCallBack,this,"onContentMetadata")),this._instance.eContentPlayhead.addListener(l(this._onCallBack,this,"onContentPlayhead")),this._instance.eContentBuffering.addListener(l(this._onCallBack,this,"onContentBuffering")),this._instance.eContentResize.addListener(l(this._onCallBack,this,"onContentResize")),this._instance.eContentQueue.addListener(l(this._onCallBack,this,"onContentQueue")),this._instance.eContentQueueAutoplay.addListener(l(this._onCallBack,this,"onContentQueueAutoplay")),this._instance.eContentVolume.addListener(l(this._onCallBack,this,"onContentVolume")),this._instance.eContentError.addListener(l(this._onCallBack,this,"onContentError")),this._instance.eAdPlayhead.addListener(l(this._onCallBack,this,"onAdPlayhead")),this._instance.eAdPlay.addListener(l(this._onCallBack,this,"onAdPlay")),this._instance.eAdEnd.addListener(l(this._onCallBack,this,"onAdEnd")),this._instance.eAdError.addListener(l(this._onCallBack,this,"onAdError")),this._instance.eAdSensitive.addListener(l(this._onCallBack,this,"onAdSensitive")),this._instance.eTrackingAdStart.addListener(l(this._onCallBack,this,"onTrackingAdStart")),this._instance.eTrackingAdComplete.addListener(l(this._onCallBack,this,"onTrackingAdComplete")),this._instance.eTrackingAdProgress.addListener(l(this._onCallBack,this,"onTrackingAdProgress")),this._instance.eTrackingAdCountdown.addListener(l(this._onCallBack,this,"onTrackingAdCountdown")),this._instance.eTrackingAdClick.addListener(l(this._onCallBack,this,"onTrackingAdClick")),this._instance.eTrackingContentPlay.addListener(l(this._onCallBack,this,"onTrackingContentPlay")),this._instance.eTrackingContentBegin.addListener(l(this._onCallBack,this,"onTrackingContentBegin")),this._instance.eTrackingContentProgress.addListener(l(this._onCallBack,this,"onTrackingContentProgress")),this._instance.eTrackingContentComplete.addListener(l(this._onCallBack,this,"onTrackingContentComplete")),this._instance.eTrackingContentReplay.addListener(l(this._onCallBack,this,"onTrackingContentReplay")),this._instance.eTrackingContentSeek.addListener(l(this._onCallBack,this,"onTrackingContentSeek")),this._instance.eTrackingContentSeekEnd.addListener(l(this._onCallBack,this,"onTrackingContentSeekEnd")),this._instance.eTrackingFullscreen.addListener(l(this._onCallBack,this,"onTrackingFullscreen")),this._instance.eTrackingMuted.addListener(l(this._onCallBack,this,"onTrackingMuted")),this._instance.eTrackingPaused.addListener(l(this._onCallBack,this,"onTrackingPaused"))},u=i.extend({init:function(e){this._super(),this._options=e,this._loadQ=new r,this._loaded=!1,d.call(this,a)},_onPlayerLoaded:function(){c.debug("_onPlayerLoaded"),this._loaded=!0,this._loadQ.execute()},_onPlayerLoadError:function(){c.debug("_onPlayerLoadError"),this._onCallBack("onPlayerLoadError")},_onPlayerReady:function(){c.debug("_onPlayerReady")},_onCVPReady:function(){c.debug("_onCVPReady")},embed:function(e){return this._loaded?(c.info("executing embed"),void this._instance.render(e)):(c.info("queuing embed"),void this._loadQ.push(this.embed,this,arguments))},remove:function(){this._instance.remove()},dispose:function(){this._instance.dispose(),this._instance=null},playContent:function(e,t){this._instance.play(e,t)},playFromObject:function(e,t){this._instance.playFromObject(e,t)},replayContent:function(){this._instance.replay()},playNextInQueue:function(){this._instance.playNextInQueue()},pause:function(){this._instance.pause()},resume:function(){this._instance.resume()},stopContent:function(){this._instance.stop()},queue:function(e,t,n){this._instance.queue(e,t,n)},queueFromObject:function(e,t,n){this._instance.queueFromObject(e,t,n)},dequeue:function(e){this._instance.dequeue(e)},emptyQueue:function(){this._instance.emptyQueue()},setQueueAutoplay:function(e){this._instance.setQueueAutoplay(e)},getQueue:function(){return this._instance.getQueue()},seek:function(e){this._instance.seek(e)},resize:function(e,t){this._instance.resize(e,t)},goFullscreen:function(){this._instance.goFullscreen()},mute:function(){this._instance.mute()},unmute:function(){this._instance.unmute()},setVolume:function(e){this._instance.setVolume(e)},getVolume:function(){return this._instance.getVolume()},isMuted:function(){return this._instance.isMuted()},getContentEntry:function(e){return this._instance.getContentEntry(e)},setAdSection:function(e){this._instance.setAdSection(e)},setAdKeyValue:function(e,t){this._instance.setAdKeyValue(e,t)},getAdKeyValues:function(){return this._instance.getAdKeyValues()},clearAdKeyValues:function(){this._instance.clearAdKeyValues()},setTrackingInterval:function(e){this._instance.setTrackingInterval(e)},setDataSrc:function(e){this._instance.setDataSrc(e)},reportAnalytics:function(e,t){this._instance.reportAnalytics(e,t)},_onCallBack:function(){n.onCallback(this._options.id,arguments)},instance:function(){return this._instance}});t.exports=u},{"../../html5/api":59,"../log":28,"../static":37,"../util/commandqueue":41,"../utils":50,"./null":31}],31:[function(e,t){var n=e("../../vendor/Class"),i=n.extend({init:function(){for(var e,t="sendMessage setDefaultPlayer play playFromObject replay playNextInQueue pause resume stop queue queueFromObject dequeue emptyQueue setQueueAutoplay getQueue seek mute unmute setVolume getVolume isMuted getContentEntry goFullscreen resize setMaxBitrate switchBitrateId setAutoBitrateSwitch getAvailableBitrates getBitrateId setGroupOrder getShareOptions setClosedCaptions setAdSection setAdKeyValue getAdKeyValues clearAdKeyValues setAdExchangeValue setAdVisibility switchAdContext switchTrackingContext setTrackingInterval setDataSrc setFileKey sendUIMessage sendUserReportedIssue".split(" "),n=function(){},i=0,r=t.length;r>i;++i)e=t[i],this[e]||(this[e]=n)}});t.exports=i},{"../../vendor/Class":92}],32:[function(e,t){var n=e("./static"),i=e("./utils"),r=e("./log"),s=i.extend,o=i.slice,a=i.isFunc,l=i.now,c=r.getLogger("PluginManager"),d={LMDB:"lmdb"},u={},h=function(e,t){return e=(e||"").toUpperCase(),d[e]?void(u[e]=t):void c.warn("[registerPlugin] Invalid plugin type. Unable to register: "+e)},p={};p.create=function(e,t){return e=(e||"").toUpperCase(),u[e]?new u[e](t):(c.warn("[create] Invalid plugin type. Unable to create: "+e),null)},p.createLMDB=function(e){return p.create(d.LMDB,e)};var g={},f=function(e,t){g[e]=t},_=function(e,t,n){var i=this;if(this.id=e,!t||!n)return c.error("[PluginHostAdapter] Invalid host or plugin. Aborting"),null;var r=function(e){return function(){return n[e].apply(n,arguments)}};for(var s in n)a(n[s])&&(this[s]=r(s));var l=function(e){var n=t();return function(){n._sendToPluginHost(i.id,e,o(arguments))}};for(var d in n.getEvents())n.on(d,l(d))};_.create=function(e,t,i,r){var s=[e,t,i,l()].join("_"),o=function(){var t=n.findInstance(e);return t.instance.getDOMPlayer()},a=p.create(i,r);return new _(s,o,a)};var m=function(e,t){var n=t.shift(),i=t.shift(),r=null;if(c.debug("[onPluginHostAPIRequest] request received: "+n+", "+i),!n)return"create"!==i?(c.error("[onPluginHostAPIRequest] Invalid create method passed"),null):(r=_[i].apply(_,[e].concat(t)),f(r.id,r),r.id);r=g[n];try{return r[i].apply(r,t)}catch(s){c.warn("[onPluginHostAPIRequest] Unable to call method: "+i+" on plugin: "+n)}},v={register:h};v=s(v,d),v=s(v,p),v.onPluginHostRequest=m,t.exports=v},{"./log":28,"./static":37,"./utils":50}],33:[function(e,t){var n=e("./pluginmanager"),i=e("./plugins/lmdb"),r={};n.register(n.LMDB,i),r.LMDB=n.createLMDB({lazy:!0}),t.exports=r},{"./pluginmanager":32,"./plugins/lmdb":34}],34:[function(e,t){var n=e("../../vendor/Class"),i=e("../customevent"),r=e("../utils"),s=e("../request"),o=e("../util/timing"),a=e("../convert"),l=e("../log"),c=l.getLogger("LMDB"),d=function(e,t){return o.periodically(e,t)},u=function(e){return e&&0===e.indexOf("<")&&e.lastIndexOf(">")===e.length-1},h=n.extend({init:function(e){var t=this;this.setOptions(e),this.events={dataReceived:new i("dataReceived"),dataReceivedError:new i("dataReceivedError")},this._onDataReceived=function(e,n){c.debug("[LMDB.onDataReceived] url: "+e),u(n)&&t.options.convertXML&&(c.debug("[LMDB.onDataReceived] Detected XML - converting"),n=a.xmlTextToJsonText(n)),t.events.dataReceived.dispatch(e,a.jsonTextToJsObject(n))},this._onDataReceivedError=function(e,n){c.debug("[LMDB.onDataReceivedError] url: "+e),t.events.dataReceivedError.dispatch(e,n)}},setOptions:function(e){var t={convertXML:!0};if(this.options=r.extend(this.options||t,e||{}),c.debug("[LMDB.setOptions] url: "+this.options.url+", interval: "+this.options.interval),this.options.interval&&this.options.url){if(r.toInt(this.options.interval)<=0)return;c.debug("[LMDB.setOptions] creating timer with interval: "+this.options.interval),this.periodical&&this.periodical.stop(),this.periodical=d(r.bind(this.request,this,this.options.url),this.options.interval)}},getEvents:function(){return this.events},request:function(e){c.info("[LMDB.request] url: "+e),this._transport=s.get({url:e,lazy:this.options.lazy,success:r.bind(this._onDataReceived,this,e),failure:r.bind(this._onDataReceivedError,this,e)})},on:function(e,t){r.hasOwn(this.events,e)&&this.events[e].addListener(r.bind(t,this))},start:function(e){c.debug("[LMDB.start]"),r.undef(e)&&(e=!0),this.periodical&&(this.periodical.start(),e&&this.request(this.options.url))},stop:function(){this.periodical&&this.periodical.stop()},getScheduleItems:function(e){var t=[];return e&&e.hasOwnProperty("LiveFeed")&&e.LiveFeed.hasOwnProperty("tveLiveSched")&&e.LiveFeed.tveLiveSched.hasOwnProperty("SchedItem")?t.concat(e.LiveFeed.tveLiveSched.SchedItem):t;

},getScheduleItem:function(e,t){for(var n=this.getScheduleItems(e),i=r.undef(t),s=r.isFunc(t),o=0;o<n.length;++o){if(i)return n[o];if(s){if(t(n[o]))return n[o]}else if(n[o].AiringID==t)return n[o]}return null}});t.exports=h},{"../../vendor/Class":92,"../convert":15,"../customevent":17,"../log":28,"../request":35,"../util/timing":48,"../utils":50}],35:[function(e,t){function n(){return O.apply(this,arguments)}var i=e("../core/app"),r=e("./utils"),s=e("./log"),o=e("./transports/flashxhr"),a=e("../vendor/easyXDM"),l=e("../vendor/json3"),c=e("../vendor/swfobject"),d=e("./convert"),u=e("../vendor/when"),h=s.getLogger(),p="GET",g="POST",f="withCredentials",_=function(e,t,n){return function(){if(e&&4===e.readyState)try{200<=e.status&&e.status<300||304===e.status?n.resolve(e.responseText):n.reject(e.status+" "+e.statusText)}catch(t){h.error("Exception with XHR: ",t),n.reject(t.message)}finally{e.onreadystatechange=Function.prototype,e.abort(),e=null}}},m=function(e,t){for(var n in t)r.hasOwn(t,n)&&e.setRequestHeader(n,t[n])},v=function(e){return r.isNull(e)?e:r.isObject(e)?r.encodeParams(e):window.encodeURIComponent(e).replace(/%20/g,"+")},y=function(e){if(r.isNull(e))return e;if(r.isObject(e)){var t={};return r.each(e,function(e,n){t[e]=r.isSimpleObject(n)?l.stringify(n):n}),t}return e},C={accepts:function(e){return!r.isCrossDomain(e.url)},request:function(e){h.log("Request::AjaxTransport.request",e.url),e.method===p&&e.data&&(e.url=r.augmentQueryString(e.url,e.data),e.data=null);var t=u.defer(),n=new window.XMLHttpRequest;n.onreadystatechange=_(n,e,t.resolver),n.open(e.method,e.url,!0),m(n,e.headers);var i=v(e.data);return n.send(e.method===g?i:null),t.promise}},E={_uniqId:0,_paramRE:/([^?&]+)=\?(?=&|$)/,createCallbackName:function(e){return"cvp_jsonp_"+e+"_"+r.now()},determineCallbackParam:function(e){var t=this._paramRE.exec(e);return t?t[1]:void 0},accepts:function(e){return"jsonp"===e.type||e.jsonpCallback},request:function(e){h.log("Request::JSONPTransport.request",e.url);var t=++this._uniqId;e.data=e.data||{},e.timeout=e.timeout||5e3;var n,i=u.defer(),s=function(e){n=e,i.resolve(e)},o="script",a=document.getElementsByTagName(o)[0],l=document.createElement(o),c=/^(complete|loaded)$/,d=!1,p=e.jsonpParam||this.determineCallbackParam(e.url),g=e.jsonpCallback||this.createCallbackName(t),f=window[g];window[g]=s,p&&(e.data[p]=g),e.cache===!1&&(e.data._=r.now()),e.url=r.augmentQueryString(e.url,e.data);var _=function(){d||"readyState"in l&&!c.test(l.readyState.toString())||(d=!0,h.info("installed "+this.src))},m=function(){var e="failed to install "+this.src;d=!0,h.error(e),i.reject(e)},v=function(){if(!d){var t="timeout while attempting to load "+e.url;d=!0,h.warn(t),i.reject(t)}},y="number"==typeof e.timeout?window.setTimeout(v,e.timeout):null,C=function(){window[g]=f,window.clearTimeout(y),l.onload=l.onreadystatechange=l.onerror=null,l.parentElement.removeChild(l),n&&r.isFunction(f)&&f(n),a=l=f=n=void 0,void 0===window[g]&&delete window[g]};return i.promise.ensure(C),l.onload=l.onreadystatechange=_,l.onerror=m,l.id=e.id||this.createCallbackName(t),l.src=e.url,a.parentNode.insertBefore(l,a),i.promise}},P={accepts:function(){return c.hasFlashPlayerVersion("8.0.0")},request:function(e){h.log("Request::FlashXHRTransport.request",e.url);var t=u.defer(),n=new o(e.lazy),i=function(e,n){t.resolve(n)},r=function(e,n){t.reject(n)};n.on("dataReceived",i),n.on("dataReceivedError",r);var s=y(e.data);return n.request(e.url,{type:e.method,data:s}),t.promise}},b={accepts:function(){return window.XMLHttpRequest&&f in new window.XMLHttpRequest||!r.isUndefined(window.XDomainRequest)},request:function(e){h.log("Request::CORSTransport.request",e.url);var t=new window.XMLHttpRequest,n=u.defer();if(e.method===p&&e.data&&(e.url=r.augmentQueryString(e.url,e.data),e.data=null),t.onreadystatechange=_(t,e,n.resolver),r.isBoolean(e.withCredentials)&&f in t&&(t.withCredentials=e.withCredentials),f in t)t.open(e.method,e.url,!0),e.method===g&&m(t,{"Content-Type":"application/x-www-form-urlencoded"});else{if(r.isUndefined(window.XDomainRequest))throw t=null,new Error("Did not find CORS-compatible interface.");t=new window.XDomainRequest,t.open(e.method,e.url)}var i=v(e.data);return t.send(e.method===g?i:null),n.promise}},T=[],A=function(e){if(h.log("Request::registerXDM"),r.isArray(e))h.debug("Request::registerXDM - merging provided array with xdmRegistry"),T.push.apply(T,e);else if(r.isSimpleObject(e)){h.debug("Request::registerXDM - adding each property to xdmRegistry");for(var t in e)r.hasOwn(e,t)&&T.push({match:t,path:e[t]})}else{if(2!==arguments.length)throw new Error("Invalid parameters to `registerXDM` -- use either registerXDM(list/map) or registerXDM(string/regex, path-to-iframe)");h.debug("Request::registerXDM - adding xdmRegistry for '"+arguments[0]+"' with path '"+arguments[1]+"'"),T.push({match:arguments[0],path:arguments[1]})}},w=function(e){h.log("Request::unregisterXDM");for(var t,n=e.toString(),i=T.length-1;i>=0;i--)if(t=T[i],n===t.match.toString())return T.splice(i,1)},S=function(e,t){h.log("Request::testPattern");var n="[object RegExp]"===Object.prototype.toString.call(t)?String.prototype.search:String.prototype.indexOf;return-1!==n.call(e,t)},k=function(e){h.log("Request::lookupIframe");for(var t,n=T.length-1;n>=0;n--){if(t=T[n],S(e,t.match))return h.debug("Request::lookupIframe - origin '"+e+"' matched '"+t.match+"'"),e+t.path;h.debug("Request::lookupIframe - origin '"+e+"' did not match '"+t.match+"'")}},I={getIframe:function(e){var t=r.parseUrl(e),n=t.origin;return k(n)},hasIframe:function(e){return!!this.getIframe(e)},accepts:function(e){return r.isCrossDomain(e.url)&&this.hasIframe(e.url)},request:function(e){h.log("Request::XDMTransport.request",e.url);var t=this.getIframe(e.url);if(!t){var n=r.parseUrl(e.url),s=n.origin;throw new Error("Did not find a registered XDM iframe for origin '"+s+"'.")}h.log("Found a registered XDM iframe at '"+t+"'.");var o=u.defer(),c=new a.Rpc({swf:i.EASYXDM_SWF_URL,remote:t},{serializer:l,remote:{request:{}}}),d={url:e.url,method:e.method,headers:e.header||void 0,timeout:e.timeout||void 0,data:y(e.data)},p=function(e){h.log("XDMTransport request success: ",e);try{o.resolve(e.data)}catch(t){o.reject(r.extend(e,{responseText:e.data}))}},g=function(e){h.log("XDMTransport request failure: ",e),"data"in e&&(e=r.extend({responseText:e.data.data,statusText:e.message},e.data)),o.reject(e)};return c.request(d,p,g),o.promise}},L=[{name:"jsonp",impl:E,exclusive:!0},{name:"ajax",impl:C,exclusive:!0},{name:"flxhr",impl:P},{name:"cors",impl:b},{name:"xdm",impl:I}],x=/\.(js(?:onp?)?|(?:ht|x)ml)$/i,R=function(e){if(e.type)return e.type.toLowerCase();var t=r.parseUrl(e.url),n=x.exec(t.pathname);return n?n[1].toLowerCase():""},D=function(e){for(var t,n=[],i=[].concat(e.transports||e.transport||[]),s=r.isEmpty(i),o=0,a=L.length;a>o&&(t=L[o],!s&&-1===r.indexOf(i,t.name)||!t.impl.accepts(e)||(n.push(t.impl),!t.exclusive));++o);return n},O=function(e){if(!r.isSimpleObject(e))throw new Error("Request.createRequest requires an object parameter.");var t=u.defer();e.method=(e.method||p).toUpperCase(),e.type=R(e),e.data=e.data||null,e.headers=e.headers||{},e.success=e.callback||e.success,e.failure=e.error||e.failure,t.promise.then(e.success,e.failure);var n=D(e),i=null,s=function(e){t.resolve(e)},o=function(e){i=e,a()},a=function(){if(0===n.length)t.reject(i);else{var r=n.shift();try{var a=r.request(e);a.then(s,o)}catch(l){o(l)}}};return a(),t.promise};n.registerXDM=A,n.unregisterXDM=w,n.get=function(e){return e.method=p,O(e)},n.getXML=function(e){return e.type="xml",O(e).then(d.xmlTextToXmlDoc)},n.getJSON=function(e){return e.type="json",O(e).then(d.jsonTextToJsObject)},n.getJSONP=function(e){return e.type="jsonp",O(e)},n.post=function(e){return e.method=g,O(e)},n.registerXDM(/^(http:\/\/[iz]|https:\/\/s)\.cdn\.turner\.com(:\d+)?$/,"/xslo/xslo/test/xdm_iframe"),n.registerXDM(/^https?:\/\/aspen\.turner\.com(:\d+)?$/,"/static/xdm_iframe.html"),n.registerXDM(/^https?:\/\/refwebapp\.aspen\.vgtf\.net(:\d+)?$/,"/static/xdm_iframe.html"),t.exports=n},{"../core/app":10,"../vendor/easyXDM":93,"../vendor/json3":94,"../vendor/swfobject":95,"../vendor/when":96,"./convert":15,"./log":28,"./transports/flashxhr":39,"./utils":50}],36:[function(e,t,n){function i(e){var t=o.createCallbackHandlerName(e);return c.isFunc(window[t])?!1:(window[t]=function(){return arguments.length&&"_pluginRequest"===arguments[0]?o.PluginManager.onPluginHostRequest(e,c.slice(arguments,1)):o.onCallback(e,arguments)},!0)}function r(e){if(e===l.FLASH_VERSION)return e;try{var t=new a(e);if(t.gt(l.FLASH_VERSION))return t.toString()}catch(n){u.warn("Failure to compare Flash versions",l.FLASH_VERSION,e)}return l.FLASH_VERSION}function s(e){var t=window.onbeforeunload;window.onbeforeunload="function"!=typeof window.onbeforeunload?e:function(){t&&t(),e()}}var o=e("./static"),a=e("./version"),l=e("../core/app"),c=e("./utils"),d=e("./log"),u=d.getLogger();n.createCallbackHandler=i,n.validateFlashVersion=r,n.addBeforeUnLoadEvent=s},{"../core/app":10,"./log":28,"./static":37,"./utils":50,"./version":51}],37:[function(e,t){var n=e("../core/app"),i=e("./detectors/pageorientationdetector"),r=e("./detectors/pagefocusdetector"),s=e("./detectors/viewportdetector"),o=e("./utils"),a=e("./log"),l=a.getLogger(),c={},d={initialized:!1,init:function(){var e=this;this.initialized||(this._pageOrientationDetector=new i({callback:function(t){e._sendToAllInstances("onPageOrientationChange",t)}}),this._pageFocusDetector=new r({callback:function(t){e._sendToAllInstances("onPageVisibilityChange",t)}}),this._viewportDetector=new s,this._pageOrientationDetector.start(),this._pageFocusDetector.start(),this._viewportDetector.start(),this.initialized=!0)},registerInstance:function(e){var t=c.findInstance(e);t&&this._addViewportTarget(e)},unregisterInstance:function(){},_addViewportTarget:function(e){var t=this;this._viewportDetector.addTarget({elementId:e,callback:function(n){t._sendToInstance(e,"onViewportVisibilityChange",n)}})},_sendToAllInstances:function(){var e=o.slice(arguments);o.each(c.instances,function(t,n){n.send.apply(n,e)})},_sendToInstance:function(e){var t=o.slice(arguments,1),n=c.instances[e];n&&n.send.apply(n,t)}};c.HTML5=n.HTML5,c.FLASH=n.FLASH,c.version=n.VERSION,c.buildDate=n.BUILD_DATE,c.VIDEO_NOT_FOUND_ERROR="video not found",c.VIDEO_XML_NOT_FOUND_ERROR="cms error",c.MEDIA_ERR_UNKNOWN="Unknown error.",c.MEDIA_ERR_ABORTED="The fetching process for the media resource was aborted by the user agent at the user's request.",c.MEDIA_ERR_NETWORK="A network error of some description caused the user agent to stop fetching the media resource, after the resource was established to be usable.",c.MEDIA_ERR_DECODE="An error of some description occurred while decoding the media resource, after the resource was established to be usable.",c.MEDIA_ERR_SRC_NOT_SUPPORTED="The media resource indicated by the src attribute was not suitable.",c.instances={};var u=/[-+*\\\/]/g,h={},p={};c.sanitizeId=function(e){if(e in h)return h[e];if(!u.test(e))return e;var t=e.replace(u,"_");return h[e]=t,p[t]=e,l.warn("The provided ID '"+e+"' contains characters that interfere with Flash ExternalInterface; sanitizing to '"+t+"'."),t},c.unsanitizeId=function(e){return e in p?p[e]:e},c.createCallbackHandlerName=function(e){return c.sanitizeId(e)+"_callback_handler"},c.registerInstance=function(e,t,n){c.instances[e]={instance:t,send:n},d.initialized||d.init(),d.registerInstance(e)},c.unregisterInstance=function(e){if(e in c.instances){var t=c.createCallbackHandlerName(e);t in window&&(window[t]=null),c.instances[e]=null,delete c.instances[e]}},c.findInstance=function(e){var t=c.instances[e];return t&&t.instance||t},c.onCallback=function(e,t){var n=c.instances[e];if(!n)throw l.error("onCallback - unable to find instance "+e),new Error("onCallback - unable to find instance "+e);return n.send.apply(n.instance,["handleCallBack"].concat(o.slice(t)))},c.cleanup=function(){o.each(c.instances,function(e,t){try{t.instance.destroy(),c.unregisterInstance(e)}catch(n){}})},t.exports=c},{"../core/app":10,"./detectors/pagefocusdetector":19,"./detectors/pageorientationdetector":22,"./detectors/viewportdetector":25,"./log":28,"./utils":50}],38:[function(e,t){var n=e("./utils"),i={};t.exports={get:function(e,t){var n=i[e];return t&&delete i[e],n},keys:function(){var e=[];for(var t in i)n.hasOwn(i,t)&&e.push(t);return e},set:function(e,t){i[e]=t}}},{"./utils":50}],39:[function(e,t){var n=e("../../core/app"),i=e("../utils"),r=e("../store"),s=e("../customevent"),o=e("../util/commandqueue"),a=e("../log"),l=e("../../vendor/Class"),c=e("../../vendor/swfobject"),d=a.getLogger(),u=l.extend({init:function(e){d.debug("[Transport.init]"),this.ready=!1,this.queue=new o,this.events={dataReceived:new s("dataReceived"),dataReceivedError:new s("dataReceivedError")},this.channelId=u.nextChannel(),u.registerInstance(this),e=i.undef(e)?!1:e,e||u.loadDependencies()},onReady:function(){d.debug("[Transport.onReady] channel: "+this.channelId),this.createListeners(),this.ready=!0,this.queue.executeAsync()},createListeners:function(){var e=this;r.set(u.getResponseCallback(this.channelId),function(t,n){setTimeout(function(){e.fireDataReceived(t,n)},0)}),r.set(u.getResponseErrorCallback(this.channelId),function(t,n){setTimeout(function(){e.fireDataReceivedError(t,n)},0)})},request:function(e,t){return u.dependenciesLoaded||u.loadDependencies(),this.ready?(d.debug("[Transport.request] channel: "+this.channelId),void u.getSwf().request(this.channelId,e,t)):void this.queue.push(this.request,this,arguments)},on:function(e,t){this.events.hasOwnProperty(e)&&this.events[e].addListener(t)},fireDataReceived:function(e,t){this.events.dataReceived.dispatch(e,t)},fireDataReceivedError:function(e,t){this.events.dataReceivedError.dispatch(e,t)}});u.instances=[],u.registerInstance=function(e){var t={instance:e,ready:!1};u.dependenciesLoaded&&(e.onReady(),t.ready=!0),u.instances.push(t)},u.callPrefix="cvp_flash_xhr",u.readySuffix="ready",u.responseSuffix="response",u.responseErrorSuffix="response_error",u.getReadyCallback=function(){return[u.callPrefix,u.readySuffix].join("_")},u.getResponseCallback=function(e){return[u.callPrefix,e,u.responseSuffix].join("_")},u.getResponseErrorCallback=function(e){return[u.callPrefix,e,u.responseErrorSuffix].join("_")},u.channelIndex=0,u.nextChannel=function(){return"flaxhr."+ ++u.channelIndex},u.dependenciesLoading=!1,u.dependenciesLoaded=!1,u.loadDependencies=function(){u.dependenciesLoading||u.dependenciesLoaded||(u.dependenciesLoading=!0,u.embed(i.bind(u.onDependenciesLoaded,u)))},u.onDependenciesLoaded=function(){u.dependenciesLoading=!1,u.dependenciesLoaded=!0;for(var e=u.instances,t=0;t<e.length;++t)e[t].ready||(e[t].instance.onReady(),e[t].ready=!0)},u.swfId="cvpXhrFlash",u.swfUrl=n.FLASHXHR_SWF_URL,u.getSwf=function(){return document.getElementById(u.swfId)},u.embed=function(e){function t(e){if(!e||!e.success||!e.ref)return d.warn("[Transport.embed] failed to embed!");var t=e.ref.style;t.position="fixed",t.top=0,t.left=0}d.debug("[Transport.embed] Checking if xhr is required on the page");var s=u.swfUrl,o=u.swfId;if(u.getSwf())return d.debug("[Transport.embed] cvpXhrFlash already present on the page. Proceeding."),void(i.isFunc(e)&&e());var a=this.swfId+"_container",l=document.createElement("div");l.id=a,l.style.height="1px",l.style.width="1px",l.style.position="fixed",l.style.overflow="hidden",l.style.right=0,l.style.top=0,document.body.appendChild(l),r.set(u.getReadyCallback(),function(){d.debug("[Transport.ready] Callback received"),i.isFunc(e)&&e()});var h={callPrefix:this.callPrefix,log:"true"},p={menu:"false",scale:"noScale",allowScriptAccess:"always",wmode:"transparent"},g={id:o};d.debug("[Transport.embed] Embedding xhr swf"),c.embedSWF(s,a,"10","10","8.0.0",n.EXPRESS_INSTALL_URL,h,p,g,t)},t.exports=u},{"../../core/app":10,"../../vendor/Class":92,"../../vendor/swfobject":95,"../customevent":17,"../log":28,"../store":38,"../util/commandqueue":41,"../utils":50}],40:[function(e,t){var n=e("../../vendor/Class"),i=e("../utils"),r=e("../customevent"),s=e("../log"),o=s.getLogger(),a=n.extend({init:function(e,t){this._firedSuccess=!1,this._url=e,this._type=i.empty(t)?this._determineType():t,this.id="cvp_asset_"+i.getRandomInt(1,1e3),this.eSuccess=new r,this.eFailure=new r},_determineType:function(){return i.empty(this._url)?"":this._url.substring(this._url.lastIndexOf(".")+1)},load:function(){switch(o.info("Asset","loading type",this._type),this._type){case"js":this._loadJs();break;case"css":this._loadCss();break;default:this._failure()}},_success:function(){o.info("Asset","successfully loaded asset",this._url),this.eSuccess.dispatch(),this._firedSuccess=!0},_failure:function(){o.error("Asset","failed to load asset",this._url),this.eFailure.dispatch()},_loadJs:function(){var e=document.getElementsByTagName("head")[0];if(!e)return void this._failure();var t=document.createElement("script");t.id=this.id,t.type="text/javascript";var n=i.bind(function(){this._firedSuccess||(this._success(),t.onload=t.onreadystatechange=null,e.removeChild(t))},this);t.onload=n,t.onerror=i.bind(this._failure,this),t.onreadystatechange=function(){("loaded"===this.readyState||"complete"===this.readyState)&&n()},t.src=this._url,e.appendChild(t)},_loadCss:function(){var e,t=document.getElementsByTagName("head")[0];return t?(e=document.createElement("link"),e.type="text/css",e.rel="stylesheet",e.href=this._url,e.media="screen",t.appendChild(e),void this._success()):void this._failure()}});t.exports=a},{"../../vendor/Class":92,"../customevent":17,"../log":28,"../utils":50}],41:[function(e,t){var n=e("../../vendor/Class"),i=e("../utils"),r=n.extend({init:function(){this._queue=[]},clear:function(){this._queue.length=0},push:function(e,t,n){var i=this._queue.length;return this._queue.push({fn:e,scope:t,args:n}),i},remove:function(e){e="number"!=typeof e?this._queue.length-1:e,this._queue.splice(e,1)},execute:function(){for(var e,t=0,n=this._queue.length;n>t;++t)e=this._queue[t],e.fn.apply(e.scope,e.args)},executeAsync:function(e){e=i.undef(e)?10:e;var t,n=this._queue.length;n&&(t=this._queue.shift(),t.fn.apply(t.scope,t.args),setTimeout(i.bind(this.executeAsync,this,e),e))}});t.exports=r},{"../../vendor/Class":92,"../utils":50}],42:[function(e,t){var n=e("../utils"),i=e("../log"),r=i.getLogger(),s=function(e,t,i){this._interval=n.isNull(i)?10:i,this._maxTries=500,this._condition=e,this._success=t,this._tries=0,this.conditionWrapper=n.bind(function(){var e=this._condition();e?(window.clearInterval(this._timer),this._success()):this._tries>this._maxTries&&(r.warn("condition never met!"),window.clearInterval(this._timer)),++this._tries},this),this.start=function(){this._timer=window.setInterval(this.conditionWrapper,this._interval)}};t.exports=s},{"../log":28,"../utils":50}],43:[function(e,t,n){function i(e,t,n){var i,r=this.getReplacementPatterns(e),s=0,a=0,l="";if(!o.empty(r))for(a=r.length;a>s;++s)i=r[s],l="",l=this.getReplacementText(i,t),o.empty(l)?l="":n&&(l=encodeURI(l)),e=e.replace(i,l);return e}function r(e){return e&&e.match(/[$][{][^}]*[}]/g)}function s(e,t){var n="",i="",r=[],s="";switch(e){case"${page.domain}":n=document.domain;break;case"${page.url}":n=location.href;break;case"${videoId}":case"${video.id}":t&&(n=t.getId());break;default:if(i=e.substr(2,e.length-3),r=i.split("."),s=r[0],r.length>1)switch(i=i.substr(s.length+1),s){case"video":t&&(n=a.getNodeValue(t._xmlEntry,i));break;case"javascript":window.cvpSearchTheClient&&(n=window.cvpSearchTheClient(null,i));break;default:n=e}else n=e}return n}var o=e("../utils"),a=e("./xml");n.stringReplace=i,n.getReplacementPatterns=r,n.getReplacementText=s},{"../utils":50,"./xml":49}],44:[function(e,t){var n=e("../../vendor/Class"),i=e("../customevent"),r=e("./asset"),s=e("../log"),o=s.getLogger(),a=n.extend({init:function(e,t){this._assetUrl=e,this.required=t,this._manager=null,this.eSuccess=new i,this.eFailure=new i},load:function(){o.info("Dependency","loading asset",this._assetUrl),this._assetLoader=new r(this._assetUrl),this._assetLoader.eSuccess.addListener(this._success,this),this._assetLoader.eFailure.addListener(this._failure,this),this._assetLoader.load()},_success:function(){o.info("Dependency","successfully loaded dependency",this._assetUrl),this.eSuccess.dispatch.apply(this.eSuccess,arguments),this._complete()},_failure:function(){o.error("Dependency","failed to load dependency",this._assetUrl),this.eFailure.dispatch.apply(this.eFailure,arguments),this._complete()},_complete:function(){this._assetLoader&&(this._assetLoader.eSuccess.removeListener(this._success,this),this._assetLoader.eFailure.removeListener(this._failure,this),this._assetLoader=null)},setManager:function(e){this._manager=e},getDesc:function(){return this._assetUrl}});t.exports=a},{"../../vendor/Class":92,"../customevent":17,"../log":28,"./asset":40}],45:[function(e,t){var n=e("../../vendor/Class"),i=e("../customevent"),r=n.extend({init:function(){this._dependencies=[],this._currentDependency=null,this.eSuccess=new i,this.eFailure=new i,this.eDependencySuccess=new i,this.eDependencyFailure=new i},addDependency:function(e){e.setManager(this),this._dependencies.push(e)},load:function(){this._currentDependency=this._dependencies.shift(),this._currentDependency.eSuccess.addListener(this._onDependencySuccess,this),this._currentDependency.eFailure.addListener(this._onDependencyFailure,this);var e=this;window.setTimeout(function(){e._currentDependency.load()},10)},_onDependencySuccess:function(e){this.eDependencySuccess.dispatch(this._currentDependency,e),this._next()},_onDependencyFailure:function(e){return this.eDependencyFailure.dispatch(this._currentDependency,e),this._currentDependency.required?void this._onFailure(this._currentDependency.getDesc()):void this._next()},_next:function(){this._currentDependency.eSuccess.removeListener(this._onDependencySuccess,this),this._currentDependency.eFailure.removeListener(this._onDependencyFailure,this),this._currentDependency=null,this._dependencies.length?this.load():this._onSuccess()},_onSuccess:function(){this.eSuccess.dispatch()},_onFailure:function(e){this.eFailure.dispatch(e)}});t.exports=r},{"../../vendor/Class":92,"../customevent":17}],46:[function(e,t,n){function i(e){return C.test(e.nodeName)}function r(e){return e.nodeName}function s(e){var t=_.map(e,r),n=_.uniq(t);return t.length!==n.length}function o(e){return!i(e)}function a(e){return _.filter(_.slice(e.attributes),o)}function l(e,t){return t=t||{},e.length?(_.each(e,function(e){t[e.nodeName]=e.nodeValue}),t):t}function c(e){if(!e.hasChildNodes())return null;var t=e.textContent||e.innerText||"";return _.trim(t).replace(y," ")}function d(e,t){t=_.isSimpleObject(t)?t:{};var n,i=e.nodeName,r=e.nodeType,o={};switch(r){case Node.DOCUMENT_NODE:n=f.getChildElements(e),t=n.length?d(n[0]):null;break;case Node.ELEMENT_NODE:n=f.getChildElements(e);var u=a(e);if(n.length)s(n)?o=_.map(n,function(e){return d(e)}):(u.length&&l(u,o),_.each(n,function(e){return d(e,o)}));else{var h=c(e);u.length?(l(u,o),null!==h&&(o.text=h)):o=h||""}t[i]=o;break;default:v.debug("Ignoring type "+r+' node with name "'+i+'"')}return t}function u(e){if(!e||!e.nodeType||!e.nodeName||e.nodeType!==Node.ELEMENT_NODE||"video"!==e.nodeName)return v.debug('Not a "video" node; passing through.'),d(e);v.debug('Processing "video" children...');var t={},n=f.getChildElements(e),i=a(e);if(n.length)i.length&&l(i,t),_.each(n,function(e){return d(e,t)});else{var r=c(e);i.length?(l(i,t),null!==r&&(t.text=r)):t=r||""}return{video:t}}function h(e){try{e.normalize()}catch(t){if(9===e.nodeType)try{var n=f.getChildElements(e);n.length&&n[0].normalize()}catch(i){}}var r=u(e);if(r)for(var s in r)return r[s];return null}function p(e){return g.stringify(h(e),null,"	")}var g=e("../../vendor/json3"),f=e("./xml"),_=e("../utils"),m=e("../log"),v=m.getLogger("JSONConverter"),y=/[\t\n\r\xA0]+/g,C=/^xmlns($|:)/;n.encodeXmlObject=p,n.xmlToJson=p,n.xmlToObject=h},{"../../vendor/json3":94,"../log":28,"../utils":50,"./xml":49}],47:[function(e,t,n){function i(){!l||d||c||window.log4javascript||(a.info("installing log4javascript"),c=!0,function(e,t,n){var i=e.createElement(t),r=e.getElementsByTagName(t)[0],o=/^(complete|loaded)$/,l=!1;i.onload=i.onreadystatechange=function(){l||n in i&&o.test(i[n])||(i.onload=i.onreadystatechange=null,l=!0,a.info("installed log4javascript"),d=!0)},i.src=s.LOG4JAVASCRIPT_URL,r.parentNode.insertBefore(i,r)}(document,"script","readyState"))}function r(){return d}var s=e("../../core/app"),o=e("../log"),a=o.getLogger(),l=s.DEBUG,c=!1,d=!1;n.install=i,n.isInstalled=r},{"../../core/app":10,"../log":28}],48:[function(e,t){function n(e,t){function n(){r&&(window.clearTimeout(r),r=null)}function i(){n(),r=window.setTimeout(e,t)}var r;if(!isFinite(t)||"function"!=typeof e)throw new Error("usage: eventually(cb, ms)");return{start:i,stop:n}}function i(e,t){var n,i=0,r=function(){e(++i,t)},s=function(){window.clearInterval(n)},o=function(){n&&s(),n=window.setInterval(r,t||1e3)};return{start:o,stop:s}}t.exports={eventually:n,periodically:i}},{}],49:[function(e,t,n){function i(e){return 1===e.nodeType}function r(e){var t=c.slice(e.children||e.childNodes||[]);return t.length?c.filter(t,i):t}function s(e,t){if(!e)return null;if(!t)return c.isNull(e.firstChild)?null:e.firstChild.nodeValue;var n=e.getElementsByTagName(t);return n.length>0&&n[0].firstChild?n[0].firstChild.nodeValue:void 0}function o(e,t){if(e&&e.attributes&&t){var n=e.attributes.getNamedItem(t);return n?n.nodeValue:null}}function a(e,t){if(!e||!t)return null;for(var n,i=e.getElementsByTagName("param"),r=0,s=i.length;s>r;++r)if(n=i[r],o(n,"name")===t)return o(n,"value")}function l(e,t){for(var n,i=0,r=t&&t.length||0;r>i;++i)n=t[i],e[n.nodeName]=n.nodeValue}var c=e("../utils.js"),d="DOMParser",u="XMLSerializer",h="ActiveXObject",p=function(){var e,t;return d in window?(e=new window[d],t=function(e){var t=e.getElementsByTagName("parsererror");return t&&0!==t.length},function(n){var i;return n?(i=e.parseFromString(c.trim(n),"text/xml"),t(i)?null:i):null}):h in window?(t=function(e){var t=e.parseError;return t&&0!==t.errorCode},function(e){var n;return e?(n=new window[h]("Microsoft.XMLDOM"),n.async="false",n.loadXML(e),t(n)?null:n):null}):void 0}(),g=function(){if(u in window){var e=new window[u];return function(t){return e.serializeToString(t)}}return h in window?function(e){return e.xml}:void 0}(),f=function(){var e=/>\s+</g,t=/\t+/g,n=/[\r\n]+/g,i=/<!--(.*?)-->/g,r=/&(?!amp;)/g,s=/xmlns(?::[^\s=]+)?=['"][^'"]*['"]/g;return function(o){return o=o.replace(e,"><"),o=o.replace(t," "),o=o.replace(n," "),o=o.replace(i,""),o=o.replace(r,"&amp;"),o=o.replace(s,"")}}();n.stringToDoc=p,n.docToString=g,n.cleanString=f,n.getChildElements=r,n.getNodeValue=s,n.getParamValue=a,n.getAttribute=o,n.assignAttributes=l},{"../utils.js":50}],50:[function(e,t,n){"use strict";function i(e){if(!e)return document.cookie;for(var t,n=encodeURIComponent(e)+"=",i=document.cookie.split("; "),r=0,s=i.length;s>r;++r)if(t=i[r],0===t.indexOf(n))return decodeURIComponent(t.substring(n.length,t.length));return null}function r(e,t,n){if(e){var i=null;n&&(i=isNaN(Number(n))?n:new Date(n).toUTCString()),document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+(i?"; expires="+n:"")+"; path=/"}}function s(e){e&&r(e,"",-1)}function o(e){return document.getElementById(e)}function a(e,t){return Array.prototype.slice.call(e,t||0)}function l(e,t){var n=a(arguments,2);return function(){var i=n.concat(a(arguments));return e.apply(t,i)}}function c(e){return"undefined"==typeof e}function d(e){return c(e)||null===e}function u(e){return"function"==typeof e}function h(e){return"object"==typeof e}function p(e){return"[object Object]"===Object.prototype.toString.call(e)}function g(e){return"string"==typeof e}function f(e){return"boolean"==typeof e}function _(e){if(d(e))return!0;if(g(e)||ce(e))return 0===e.length;for(var t in e)if(le(e,t))return!1;return!0}function m(e,t){if(f(e))return e;if(_(e))return t;switch(e.toLowerCase()){case"yes":case"true":case"on":return!0;default:return!1}}function v(e,t){var n,i,r,s,o=arguments.length>2?a(arguments,1):t?[t]:[];for(e=e||{},n=0,i=o.length;i>n;++n)if(r=o[n],r&&h(r))for(s in r)e[s]=r[s];return e}function y(e,t,n){var i,r,s;if(ce(e))for(r=0,s=e.length;s>r&&(i=t.call(n||e[r],e[r],r,e),i!==!1);++r);else for(r in e)if(le(e,r)&&(i=t.call(n||e[r],r,e[r],e),i===!1))break}function C(e){var t=[];for(var n in e)le(e,n)&&t.push(n);return t}function E(e,t,n){var i=[];return null==e?i:(y(e,function(e,r,s){i.push(t.call(n,e,r,s))}),i)}function P(e){var t=[];return y(e,function(e){-1===de(t,e)&&t.push(e)}),t}function b(e){return e}function T(e,t,n){t=t||b;var i=!0;return null==e?i:(y(e,function(e,r,s){return(i=i&&t.call(n,e,r,s))?void 0:!1}),!!i)}function A(e,t,n){t=t||b;var i=!1;return null==e?i:(y(e,function(e,r,s){return i||(i=t.call(n,e,r,s))?!1:void 0}),!!i)}function w(e,t,n){t=t||b;var i=[];return null==e?i:(y(e,function(e,r,s){t.call(n,e,r,s)&&i.push(e)}),i)}function S(e,t,n){return t=t||b,w(e,function(e,i,r){return!t.call(n,e,i,r)},n)}function k(e,t,n){t=t||b;var i;return A(e,function(e,r,s){return t.call(n,e,r,s)?(i=e,!0):void 0}),i}function I(e,t,n){t=t||b;var i=-1;return A(e,function(e,r,s){return t.call(n,e,r,s)?(i=r,!0):void 0}),i}function L(e,t,n){var i,r,s,o=null,a=0;n=n||{},t=t||250;var l=function(){a=n.leading===!1?0:ae(),o=null,s=e.apply(i,r)};return function(){var c=ae();a||n.leading!==!1||(a=c);var d=t-(c-a);return i=this,r=arguments,0>=d?(window.clearTimeout(o),o=null,a=c,s=e.apply(i,r)):o||n.trailing===!1||(o=window.setTimeout(l,d)),s}}function x(e,t,n){var i,r,s,o,a;return t=t||250,function(){s=this,r=arguments,o=ae();var l=function(){var c=ae()-o;t>c?i=window.setTimeout(l,t-c):(i=null,n||(a=e.apply(s,r)))},c=n&&!i;return i||(i=window.setTimeout(l,t)),c&&(a=e.apply(s,r)),a}}function R(e){var t=e.match(/\{[^{}]*\}/g),n=0,i=0,r=a(arguments,1),s=r.length;if(t)for(n=0,i=t.length;i>n&&s>n;++n)e=e.replace(t[n],r[n]);else se.info("No {placeholders} present in template: ",e);return e}function D(e,t){var n,i=[];d(t)&&(t=",");for(n in e)le(e,n)&&i.push(n+"="+e[n]);return i.join(t)}function O(e){return 0===e.indexOf("//")||-1!==e.indexOf("://")}function F(e){return!O(e)}function M(e){var t=document.createElement("a");t.href=e;var n=t.href;t=null;var i=ue.exec(n);return i?{href:i[0]||"",origin:i[1]||"",protocol:i[2]||"",scheme:i[3]||"",host:i[4]||"",hostname:i[5]||"",port:i[6]||"",pathname:i[7]||"",dir:i[8]||"",file:i[9]||"",search:i[10]||"",query:i[11]||"",hash:i[12]||"",anchor:i[13]||""}:void 0}function N(e){var t={};return d(e)?t:(e.replace(he,function(e,n,i){return t[n]=i?window.decodeURIComponent(i):"",e}),t)}function B(e){var t={},n=e||window.location.href,i=M(n);return i.query&&(t=N(i.query)),t}function V(e){return B()[e]}function U(e){var t,n,i=[],r=window.encodeURIComponent;for(t in e)le(e,t)&&(n=e[t],i.push(r(t)+(""!==n?"="+r(h(n)?ie.stringify(n):n):"")));return i.join("&").replace(/%20/g,"+")}function q(e){var t=U(e);return t?"?"+t:""}function j(e,t){var n=M(e),i=N(n.query);i=v(i,t);var r=q(i);return n.origin+n.pathname+r+n.hash}function Q(e){var t={"http:":"80","https:":"443"};return e=M(e),e.hostname.toLowerCase()!==location.hostname.toLowerCase()||(e.port||t[e.protocol])!==(location.port||t[location.protocol])||e.protocol.toLowerCase()!==location.protocol.toLowerCase()}function H(){window.console&&window.console.log&&te.DEBUG&&window.console.log(a(arguments).join(" | "))}function W(e,t){var n;"nested"!==t&&se.info("Print all values for ",t);for(n in e)if(le(e,n)){if(!n)continue;h(e[n])?(se.info("Printing nested object value",n),W(e[n],"nested")):se.info("nested"===t?"	":"","key:",n,"value:",e[n])}"nested"!==t&&se.info("End Print all values for ",t)}function K(e){var t=ne.defer();return setTimeout(t.resolve,e),t.promise}function X(e,t){var n=ne.defer();return e.then(n.resolve,n.reject),setTimeout(function(){
n.reject(new Error("timed out"))},t),n.promise}function z(e,t){return 1===arguments.length?Math.floor(Math.random()*e):Math.floor(Math.random()*(t-e+1))+e}function J(e){return+e}function G(e){return parseInt(e,10)}function $(e){return Number(e).toFixed(3)}function Y(e){var t,n="",i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".split("");for(e||(e=z(i.length)),t=0;e>t;t++)n+=i[z(i.length)];return n}function Z(e){return String(e).replace(pe,"\\$&")}function ee(e,t,n){if(_(e))return e;var i=Z(t);return e.replace(new RegExp(i+"$","i"),n)}var te=e("../core/app"),ne=e("../vendor/when"),ie=e("../vendor/json3"),re=e("./log"),se=re.getLogger(),oe=function(){function e(e,t,n){return n.toUpperCase()}if("getComputedStyle"in window)return function(e,t){return window.getComputedStyle(e,null).getPropertyValue(t)};var t=/(-([a-z]))/g;return function(n,i){return"currentStyle"in n?("float"===i&&(i="styleFloat"),i=i.replace(t,e),n.currentStyle[i]||null):null}}(),ae="function"==typeof Date.now?Date.now:function(){return(new Date).getTime()},le="function"==typeof Object.prototype.hasOwnProperty?function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}:function(e,t){return e[t]!==Object.prototype[t]},ce="function"==typeof Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},de=function(){var e=Array.prototype.indexOf,t=u(e)?e:function(e,t){if(this){var n=this.length;for(t=t?0>t?Math.max(0,n+t):t:0;n>t;++t)if(t in this&&this[t]===e)return t}return-1};return function(e,n,i){return g(e)?e.indexOf(n,i):ce(e)?t.call(e,n,i):void 0}}(),ue=/^((([^:\/?#]+):)?(?:\/\/(([^\/?#]*)(?::(\d+))?))?)(([^?#]*\/)([^\/?#]*)?)(\?([^#]*))?(#(.*))?$/,he=/[?&]?([^&=]+)(?:=([^&=]+))?/g,pe=/[.*+?^${}()|[\]\\]/g,ge=function(){var e=/^[\s\xA0]+|[\s\xA0]+$/g,t=String.prototype.trim;return u(t)?function(e){return d(e)?"":t.call(e)}:function(t){return d(t)?"":String(t).replace(e,"")}}();n.trim=ge,n.getStyle=oe,n.now=ae,n.getCookie=i,n.setCookie=r,n.deleteCookie=s,n.undef=c,n.isUndefined=c,n.nil=d,n.isNull=d,n.empty=_,n.isEmpty=_,n.isFunc=u,n.isFunction=u,n.isObject=h,n.isSimpleObject=p,n.isString=g,n.isBoolean=f,n.isArray=ce,n.indexOf=de,n.isFlagActive=m,n.extend=v,n.each=y,n.keys=C,n.map=E,n.uniq=P,n.identity=b,n.every=T,n.some=A,n.filter=w,n.reject=S,n.find=k,n.findIndex=I,n.throttle=L,n.debounce=x,n.byId=o,n.slice=a,n.hasOwn=le,n.bind=l,n.template=R,n.joinKeys=D,n.isAbsolute=O,n.isRelative=F,n.isRelativePath=F,n.parseUrl=M,n.parseQueryString=N,n.getQueryParams=B,n.getQueryParam=V,n.encodeParams=U,n.toQueryString=q,n.augmentQueryString=j,n.isCrossDomain=Q,n.log=H,n.print=W,n.delay=K,n.timeout=X,n.getRandomInt=z,n.toNum=J,n.toInt=G,n.toFixed=$,n.randomString=Y,n.escapeRegExp=Z,n.replaceExtension=ee},{"../core/app":10,"../vendor/json3":94,"../vendor/when":96,"./log":28}],51:[function(e,t){function n(e){if("string"!=typeof e)throw new TypeError("Version() only accepts a string");this.raw=e,this.major=0/0,this.minor=0/0,this.revision=0/0;var t=i.exec(e);if(!t)throw new SyntaxError('Version string "'+this.raw+'" failed to parse as a valid version number');var n=t[1],s=t[3],o=t[5];this.major=n,s&&!r.test(t[2])&&(this.minor=s,o&&!r.test(t[4])&&(this.revision=o))}var i=/(\d+)(?:(\D)(\d+))?(?:(\D)(\d+))?/,r=/^[abd]$/;n.prototype.toString=function(){return this.toArray().join(".")},n.prototype.toArray=function(e){for(var t,n=[this.major,this.minor,this.revision],i=[],r=0,s=n.length;s>r&&(t=+n[r],e||!isNaN(t));++r)i.push(t);return i},n.prototype.compare=function(e,t){if(!(e instanceof n))return this.compare(new n(e),t);var i,r,s,o=0,a=0,l=this.toArray(!0);for(i=t?e.toArray():e.toArray(!0),a=i.length;a>o;++o){if(r=+l[o]||0,s=+i[o]||0,r>s)return 1;if(s>r)return-1}return 0},n.prototype.is=function(e){return 0===this.compare(e,!0)},n.prototype.eq=function(e){return 0===this.compare(e)},n.prototype.gt=function(e){return this.compare(e)>0},n.prototype.lt=function(e){return this.compare(e)<0},n.prototype.isnt=function(e){return!this.is(e)},n.prototype.ne=function(e){return!this.eq(e)},n.prototype.lte=function(e){return!this.gt(e)},n.prototype.gte=function(e){return!this.lt(e)},t.exports=n},{}],52:[function(require,module,exports){function cvpSearchTheClient(theObj,thePath){var index=thePath.indexOf("."),objName="",subPath="",childObj;return null===theObj&&(theObj=window),-1===index?-1!==thePath.indexOf("(")&&-1!==thePath.indexOf(")")?eval("theObj."+thePath):theObj[thePath]:(objName=thePath.substring(0,index),subPath=thePath.substring(index+1),childObj=theObj[objName],-1!==objName.indexOf("(")&&-1!==objName.indexOf(")")&&(childObj=eval("theObj."+objName)),null===childObj?"":subPath.length<1?childObj.toString():cvpSearchTheClient(childObj,subPath))}exports.cvpSearchTheClient=cvpSearchTheClient},{}],53:[function(e,t){var n=e("../../vendor/Class"),i=e("../../cvp/customevent"),r=e("../../cvp/log"),s=e("./adtypes"),o=e("./videostates"),a=e("./freewheelimpl"),l=e("./dfpimpl"),c=e("../../cvp/errors"),d=c.ErrorMessage,u=r.getLogger("AdServerProxy"),h=n.extend({init:function(e){return this._adPolicy=e,this.eAdPlay=new i,this.eAdPlayhead=new i,this.eAdEnd=new i,this.eAdError=new i,this.eAdClick=new i,this.eAdReady=new i,this.eAdStopped=new i,this._adServerType=this._adPolicy.ads.attr.type.toLowerCase(),this._adServer=this._createImpl(),this._adServer?void this._listen(!0):(u.warn("Unable to create ad server impl."),void this._onAdError(d.AD_SERVER_NOT_CONFIGURED))},_listen:function(e){if(this._isListening!==e){this._isListening=e;var t=e?"addListener":"removeListener";this._adServer.eAdPlay[t](this._onAdPlay,this),this._adServer.eAdPlayhead[t](this._onAdPlayhead,this),this._adServer.eAdEnd[t](this._onAdEnd,this),this._adServer.eAdError[t](this._onAdError,this),this._adServer.eAdClick[t](this._onAdClick,this),this._adServer.eAdReady[t](this._onAdReady,this),this._adServer.eAdStopped[t](this._onAdStopped,this)}},_createImpl:function(){var e=this._adServerType;switch(e){case"freewheel":return new a(this._adPolicy);case"dfp":return new l(this._adPolicy);default:return null}},setAdSection:function(e){this._adServer&&this._adServer.setAdSection(e)},getAdSection:function(){return this._adServer?this._adServer.getAdSection():void 0},setAdKeyValue:function(e,t){this._adServer&&this._adServer.setAdKeyValue(e,t)},getAdKeyValue:function(e){return this._adServer?this._adServer.getAdKeyValue(e):void 0},getAdKeyValues:function(){return this._adServer?this._adServer.getAdKeyValues():void 0},clearAdKeyValues:function(){this._adServer&&this._adServer.clearAdKeyValues()},setVideoState:function(e){this._adServer&&this._adServer.setVideoState(e)},setVideoStatePlaying:function(){this.setVideoState(o.PLAYING)},setVideoStatePaused:function(){this.setVideoState(o.PAUSED)},setVideoStateStopped:function(){this.setVideoState(o.STOPPED)},setVideoStateCompleted:function(){this.setVideoState(o.COMPLETED)},getVideoState:function(){return this._adServer?this._adServer.getVideoState():void 0},setVideoDisplayBase:function(e){this._adServer&&this._adServer.setVideoDisplayBase(e)},isEnabled:function(){return this._adServer?this._adServer.enabled:!1},playPreroll:function(){this._adServer&&this._adServer.playPreroll()},getMidrolls:function(){return this._adServer?this._adServer.getMidrolls():void 0},playMidroll:function(e){this._adServer&&this._adServer.playMidroll(e)},playPostroll:function(){this._adServer&&this._adServer.playPostroll()},loadAds:function(e){this._adServer&&this._adServer.loadAds(e)},stop:function(){this._adServer&&this._adServer.stop()},dispose:function(){this._adServer&&(this._listen(!1),this._adServer.dispose(),this._adServer=null)},getCurrentAdId:function(){return this._adServer?this._adServer.getCurrentAdId():""},getCurrentAdDuration:function(){return this._adServer?this._adServer.getCurrentAdDuration():0},getCurrentAdType:function(){return this._adServer?this._adServer.getCurrentAdType():void 0},getAdAnalyticsData:function(){return this._adServer?this._adServer.getAdAnalyticsData():void 0},getAdAnalyticsDataForCurrentSlot:function(){return this._adServer?this._adServer.getAdAnalyticsDataForCurrentSlot():void 0},_onAdPlay:function(e){u.debug("_onAdPlay",e.adType),this.eAdPlay.dispatch(e)},_onAdPlayhead:function(e,t){this.eAdPlayhead.dispatch(e,t)},_onAdEnd:function(e){u.debug("_onAdEnd",e.adType),this.eAdEnd.dispatch(e)},_onAdError:function(e){u.debug("_onAdError",e.adType),this.eAdError.dispatch(e)},_onAdClick:function(e){u.debug("_onAdClick",e.adType,e.url),this.eAdClick.dispatch(e.url)},_onAdReady:function(){u.log("_onAdReady"),this.eAdReady.dispatch()},_onAdStopped:function(){u.log("_onAdStopped"),this.eAdStopped.dispatch()}});h.PREROLL=s.PREROLL,h.MIDROLL=s.MIDROLL,h.POSTROLL=s.POSTROLL,t.exports=h},{"../../cvp/customevent":17,"../../cvp/errors":26,"../../cvp/log":28,"../../vendor/Class":92,"./adtypes":54,"./dfpimpl":56,"./freewheelimpl":57,"./videostates":58}],54:[function(e,t){t.exports={PREROLL:"preroll",MIDROLL:"midroll",POSTROLL:"postroll"}},{}],55:[function(e,t){var n=e("../../vendor/Class"),i=e("../../cvp/utils"),r=e("../../cvp/customevent"),s=e("../../cvp/log"),o=s.getLogger(),a=n.extend({init:function(e){this._adPolicy=e,this._keyValues={},this._adServerInfo=this._adPolicy.ads,this._adSection=this.getConfigProperty("adSection"),this.currentAdType="",this.currentAdId="",this.currentAdDuration=0,this.eAdPlayhead=new r,this.eAdPlay=new r,this.eAdEnd=new r,this.eAdError=new r,this.eAdClick=new r,this.eAdReady=new r,this.eAdStopped=new r},stop:function(){},dispose:function(){},setAdSection:function(e){this._adSection=e},getAdSection:function(){return this._adSection},setAdKeyValue:function(e,t){e&&(null===t?delete this._keyValues[e]:this._keyValues[e]=t)},getAdKeyValue:function(e){return this._keyValues[e]||void 0},getAdKeyValues:function(){return this._keyValues},clearAdKeyValues:function(){this._keyValues={}},setVideoState:function(e){this._videoState=e},getVideoState:function(){return this._videoState},getAdAnalyticsData:function(){},getAdAnalyticsDataForCurrentSlot:function(){},getMidrolls:function(){return{}},getConfigProperty:function(e){var t=null,n=!1;switch(e){case"adApi":t=this._adServerInfo.apiUrl,n=!0;break;case"adServerRootUrl":t=this._adServerInfo.adServerRootUrl,n=!0;break;case"adNetworkId":t=this._adServerInfo.adNetworkId,n=!0;break;case"adVideoNetworkId":t=this._adServerInfo.adVideoNetworkId,n=!0;break;case"adVideoAssetId":t=this._adServerInfo.adVideoAssetId,n=!0;break;case"adSection":t=this._adServerInfo.adSection,n=!0;break;case"adPlayerProfile":t=this._adServerInfo.adPlayerProfile,n=!0;break;case"renderersUrl":t=this._adServerInfo.renderersUrl,n=!1;break;case"sensitiveFallbackId":t=this._adServerInfo.sensitiveFallbackId,n=!1;break;case"adLiveContentDuration":t=this._adServerInfo.liveDuration,n=!1}return i.empty(t)&&(n?o.error("the following required ad server config value is missing:",e):o.warn("the following optional ad server config value is missing:",e)),t},getCurrentAdType:function(){return this.currentAdType},getCurrentAdId:function(){return this.currentAdId},getCurrentAdDuration:function(){return this.currentAdDuration},_emitAdPlay:function(e){var t=i.extend({ads:[],token:null,mode:"standard",id:this.getCurrentAdId(),duration:this.getCurrentAdDuration(),adType:this.getCurrentAdType(),adAnalyticsData:this.getAdAnalyticsDataForCurrentSlot()},e);this.eAdPlay.dispatch(t)},_emitAdEnd:function(e){var t=i.extend({token:null,mode:"standard",id:this.getCurrentAdId(),adType:this.getCurrentAdType()},e);this.eAdEnd.dispatch(t)},_emitAdError:function(e){var t=i.extend({id:this.getCurrentAdId(),adType:this.getCurrentAdType(),errors:[]},e);this.eAdError.dispatch(t)},_emitAdClick:function(e){var t=i.extend({id:this.getCurrentAdId(),adType:this.getCurrentAdType(),url:""},e);this.eAdClick.dispatch(t)}});t.exports=a},{"../../cvp/customevent":17,"../../cvp/log":28,"../../cvp/utils":50,"../../vendor/Class":92}],56:[function(e,t){var n=e("./baseimpl"),i=e("../../cvp/utils"),r=e("../../cvp/util/configutils"),s=e("../../cvp/errors"),o=e("../../cvp/log"),a=e("./adtypes"),l=s.ErrorMessage,c=o.getLogger("DFPImpl"),d=n.extend({init:function(){c.debug("Instantiating"),this._super.apply(this,arguments),this.enabled=!1,this._loader=new window.google.ima.AdsLoader,this._loader.addEventListener(window.google.ima.AdsLoadedEvent.Type.ADS_LOADED,i.bind(this._onAdsLoaded,this)),this._loader.addEventListener(window.google.ima.AdErrorEvent.Type.AD_ERROR,i.bind(this._onAdLoadError,this))},setVideoDisplayBase:function(e){c.debug("setVideoDisplayBase",e),i.undef(window.google)||i.undef(window.google.ima.AdsLoader)||(this.displayBase=e,this.enabled=!0,c.debug("setVideoDisplayBase","videoDisplayBase","enabling"))},loadAds:function(e){this._catalogEntry=e,this.playPreroll()},playPreroll:function(){var e=this._catalogEntry.getAdUrl("preroll"),t=this._constructAdUrl(e,this._catalogEntry);this.currentAdType=d.PREROLL,this.loadAds(t)},playPostroll:function(){var e=this._catalogEntry.getAdUrl("postroll"),t=this._constructAdUrl(e,this._catalogEntry);this.currentAdType=d.POSTROLL,this.loadAds(t)},_convertAdTypeFromImpl:function(e){switch(e){case d.PREROLL:return a.PREROLL;case d.POSTROLL:return a.POSTROLL}},getCurrentAdType:function(){return this._convertAdTypeFromImpl(this.currentAdType)},_loadAdUrl:function(e){c.debug("_loadAdUrl - adTag",e);var t={adTagUrl:e,adType:"video"};this._loader.requestAds(t)},_constructAdUrl:function(e,t){var n="",s=this.getConfigProperty("adServerRootUrl");n=i.empty(e)?s:i.isRelative(e)?this._addToTag(s,e):e;var o=this.getAdKeyValues();for(var a in o)if(i.hasOwn(o,a)){var l=a+"="+o[a];n=this._addToTag(n,l)}return n=r.stringReplace(n,t)},_addToTag:function(e,t){if(!e)return t;var n=";";return";"===e.charAt(e.length-1)&&(n=""),e+n+t},_onAdsLoaded:function(e){c.debug("_onAdsLoaded");var t=e.getAdsManager();t.addEventListener(window.google.ima.AdErrorEvent.Type.AD_ERROR,i.bind(this._onAdError,this)),t.addEventListener(window.google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,i.bind(this._onPauseRequested,this)),t.addEventListener(window.google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,i.bind(this._onResumeRequested,this));try{var n={restoreContentState:!1},r=document.getElementById(this.displayBase).getElementsByTagName("video")[0];t.play(r,n),this._emitAdPlay()}catch(s){c.error("ad play error",s.toString()),this._emitAdError({errorMessage:l.AD_EXISTS_BUT_FAILED,errors:[s.toString()]})}},_onAdLoadError:function(){c.debug("_onAdLoadError"),this._emitAdError({errorMessage:l.AD_EXISTS_BUT_FAILED,errors:event.errors})},_onPauseRequested:function(){c.debug("_onPauseRequested")},_onResumeRequested:function(){c.debug("_onResumeRequested"),this._emitAdEnd()},_onAdError:function(e){c.debug("_onAdError",e.toString()),this._emitAdError({errorMessage:l.AD_EXISTS_BUT_FAILED,errors:[e.toString()]})}});d.PREROLL="dfpPreroll",d.POSTROLL="dfpPostroll",t.exports=d},{"../../cvp/errors":26,"../../cvp/log":28,"../../cvp/util/configutils":43,"../../cvp/utils":50,"./adtypes":54,"./baseimpl":55}],57:[function(e,t){var n=e("./baseimpl"),i=e("../../cvp/utils"),r=e("../../cvp/util/configutils"),s=e("../../cvp/util/timing"),o=e("../../cvp/errors"),a=e("../../cvp/log"),l=e("./adtypes"),c=e("./videostates"),d=o.ErrorMessage,u=a.getLogger("FreeWheelImpl"),h={READY:0,CREATING_NEW_CONTEXT:1,STOPPING_ADS:2},p=n.extend({init:function(){if(u.log("Instantiating"),this._super.apply(this,arguments),this._state=h.READY,this._freewheel=null,this.enabled=!1,i.isObject(window.tv)&&i.isObject(window.tv.freewheel)&&i.isObject(window.tv.freewheel.SDK)){p.initialized||(p.SDK=window.tv.freewheel.SDK,p.PREROLL=p.SDK.TIME_POSITION_CLASS_PREROLL,p.MIDROLL=p.SDK.TIME_POSITION_CLASS_MIDROLL,p.POSTROLL=p.SDK.TIME_POSITION_CLASS_POSTROLL,p.VIDEO_PLAYING=p.SDK.VIDEO_STATE_PLAYING,p.VIDEO_PAUSED=p.SDK.VIDEO_STATE_PAUSED,p.VIDEO_STOPPED=p.SDK.VIDEO_STATE_STOPPED,p.VIDEO_COMPLETED=p.SDK.VIDEO_STATE_COMPLETED,p.initialized=!0);var e=this.getConfigProperty("adNetworkId"),t=this.getConfigProperty("adServerRootUrl")+"/ad/g/1";this._freewheel=new p.SDK.AdManager,this._freewheel.setNetwork(e),this._freewheel.setServer(t)}this._isListening=!1,this._adProgress=0,this._adTimer=null,this._adTimerDelay=1e3,this._ads={},this._ads[p.PREROLL]=[],this._ads[p.MIDROLL]=[],this._ads[p.POSTROLL]=[],this._onRequestComplete=i.bind(this._onRequestComplete,this),this._onSlotStarted=i.bind(this._onSlotStarted,this),this._onSlotEnded=i.bind(this._onSlotEnded,this),this._onPauseRequested=i.bind(this._onPauseRequested,this),this._onResumeRequested=i.bind(this._onResumeRequested,this),this._onAdStart=i.bind(this._onAdStart,this),this._onAdEnd=i.bind(this._onAdEnd,this),this._onAdClick=i.bind(this._onAdClick,this),this.setAdKeyValue("_fw_cvp_player","html5")},_createAdIncrementor:function(e){return i.bind(function(e){var t=e.getPlayheadTime();t!==this._adProgress&&(t>this.currentAdDuration||(this._adProgress=t,this.onAdPlayhead(this._adProgress,this.currentAdDuration)))},this,e)},_updateAdTimer:function(e){this._disposeAdTimer(),this._adTimer=s.periodically(this._createAdIncrementor(e),this._adTimerDelay),this._adTimer.start()},_disposeAdTimer:function(){null!==this._adTimer&&(this._adTimer.stop(),this._adTimer=null)},setVideoDisplayBase:function(e){p.initialized&&(this.displayBase=e,this.enabled=!0)},_purgeLoadedAds:function(){this._ads[p.PREROLL].length=0,this._ads[p.MIDROLL].length=0,this._ads[p.POSTROLL].length=0},_fireAdStopped:function(){u.log("_fireAdStopped"),this.eAdStopped.dispatch()},_handleAdReset:function(){switch(this._state){case h.CREATING_NEW_CONTEXT:this._createNewContext();break;case h.STOPPING_ADS:this._fireAdStopped();break;default:u.debug("_handleAdReset","unknown or unexpected state '"+this._state+"'!")}this._state=h.READY},_disposeCurrentContext:function(){u.log("_disposeCurrentContext"),this._listen(!1),this._fwContext.dispose(),this._fwContext=null,this._handleAdReset()},_reset:function(){u.log("_reset"),this._disposeAdTimer(),this._purgeLoadedAds(),this.currentAdType=p.PREROLL,this._fwContext?this._currentSlot?this._currentSlot.stop():this._disposeCurrentContext():this._handleAdReset()},_createNewContext:function(){u.log("_createNewContext");var e=this._catalogEntry;if(e.isAdSensitive())return u.log("catalogEntry specified 'isAdSensitive'; skipping ad context creation."),void this._adError(d.AD_SKIPPED_DUE_TO_SENSITIVITY);var t=this.getConfigProperty("adNetworkId"),n=e.getTrt(),s=i.empty(this._adServerInfo.adVideoAssetId)?e.getId():r.stringReplace(this._adServerInfo.adVideoAssetId,e,!1);this._fwContext=this._freewheel.newContext(),this._fwContext.setProfile(t+":turner_html5"),this._fwContext.setVideoAsset(s,n),this._fwContext.setSiteSection(this._adSection),this._fwContext.registerVideoDisplayBase(this.displayBase);var o=this.getAdKeyValues();for(var a in o)i.hasOwn(o,a)&&this._fwContext.addKeyValue(a,o[a]);this._listen(!0),this._fwContext.submitRequest()},_listen:function(e){var t=this._fwContext;if(t&&this._isListening!==e){this._isListening=e;var n=e?t.addEventListener:t.removeEventListener;n.call(t,p.SDK.EVENT_REQUEST_COMPLETE,this._onRequestComplete),n.call(t,p.SDK.EVENT_SLOT_STARTED,this._onSlotStarted),n.call(t,p.SDK.EVENT_SLOT_ENDED,this._onSlotEnded),n.call(t,p.SDK.EVENT_CONTENT_VIDEO_PAUSE_REQUESTED,this._onContentPauseRequested),n.call(t,p.SDK.EVENT_CONTENT_VIDEO_RESUME_REQUESTED,this._onContentResumeRequested),n.call(t,p.SDK.EVENT_AD_IMPRESSION,this._onAdStart),n.call(t,p.SDK.EVENT_AD_IMPRESSION_END,this._onAdEnd),n.call(t,p.SDK.EVENT_AD_CLICK,this._onAdClick),n.call(t,p.SDK.EVENT_ERROR,this._onAdError)}},loadAds:function(e){u.log("loadAds"),this._catalogEntry=e,this._state=h.CREATING_NEW_CONTEXT,this._reset()},stop:function(){u.log("stop"),this._state=h.STOPPING_ADS,this._reset()},dispose:function(){u.log("dispose"),this.stop(),this._freewheel=null},_onRequestComplete:function(e){if(u.log("_onRequestComplete",e),e&&e.success)for(var t=e.target.getTemporalSlots(),n=0,i=t.length;i>n;++n){var r=t[n],s=r.getTimePositionClass();switch(s){case p.PREROLL:case p.MIDROLL:case p.POSTROLL:this._ads[s].push(r)}}else u.debug("_onRequestComplete","No ad event or ad request was unsuccessful.");this._createMidrollsData(),this.eAdReady.dispatch(),this.playPreroll()},_createMidrollsData:function(){var e={},t=this._ads[p.MIDROLL];i.each(t,function(t,n){var i=t.getTimePosition();i>=0&&(e[i]=n)}),this._midrolls=e},getMidrolls:function(){return i.extend({},this._midrolls)},_onSlotStarted:function(e){u.log("_onSlotStarted",e.type,e.target,e.slot)},_playSlot:function(e){this._currentSlot=e,this._currentSlot.play()},_continuePlayingSlots:function(e){var t=this._ads[e];return t&&t.length&&(t.shift(),t.length)?(this._playSlot(t[0]),!0):!1},_onSlotEnded:function(e){if(u.log("_onSlotEnded",e.type,e.target,e.slot),this._currentSlot=null,this._state!==h.READY)return u.log("_onSlotEnded","short-circuit because state is "+this._state),void this._disposeCurrentContext();var t=e.slot.getTimePositionClass();switch(t){case p.PREROLL:this._continuePlayingSlots(t)||this.onPrerollCompleted();break;case p.MIDROLL:this.onMidrollCompleted();break;case p.POSTROLL:this._continuePlayingSlots(t)||this.onPostrollCompleted()}},_onContentPauseRequested:function(e){u.log("_onContentPauseRequested",e.type,e.target,e.success)},_onContentResumeRequested:function(e){u.log("_onContentResumeRequested",e.type,e.target,e.slot)},_onAdStart:function(e){u.log("_onAdStart",e.type,e.target,e.adInstance)},_onAdEnd:function(e){u.log("_onAdEnd",e.type,e.target,e.adInstance)},_onAdClick:function(e){u.log("_onAdClick",e);var t=e.adInstance;if(t){var n=t.getEventCallbackUrls(p.SDK.EVENT_AD_CLICK,p.SDK.EVENT_TYPE_CLICK);u.log("_onAdClick","callbackUrls:",n),n&&n.length&&this._emitAdClick({url:n[0]})}},_onAdError:function(e){return u.debug("_onAdError",e),i.isObject(e)?void this._emitAdError({errorMessage:d.AD_EXISTS_BUT_FAILED,errors:e.errors}):void u.warn("_onAdError did not receive an object; cannot report an error")},playPreroll:function(){u.log("playPreroll"),this.currentAdType=p.PREROLL,this._adPlay(p.PREROLL)},onPrerollCompleted:function(){u.log("onPrerollCompleted"),this._adEnd()},playMidroll:function(e){u.log("playMidroll"),this.currentAdType=p.MIDROLL,this._adPlay(p.MIDROLL,e)},onMidrollCompleted:function(){u.log("onMidrollCompleted"),this._adEnd()},playPostroll:function(){u.log("playPostroll"),this.currentAdType=p.POSTROLL,this._adPlay(p.POSTROLL)},onPostrollCompleted:function(){u.log("onPostrollCompleted"),this._adEnd()},_adPlay:function(e,t){t=t||0,u.log("_adPlay",e);var n=this._catalogEntry;if(n.isAdSensitive())return u.debug("catalogEntry specified 'isAdSensitive'; skipping ad play."),void this._adError(d.AD_SKIPPED_DUE_TO_SENSITIVITY);var i=this._ads[e];if(!i.length)return u.debug("no slots provided for the ad type: "+e),void this._adError(d.AD_TYPE_NOT_TRAFFICKED);if(0>t||i.length<=t)return u.debug("no slot at index '"+t+"' provided for the ad type: "+e),void this._adError(d.NO_AD_PLAYED_AT_AD_SPOT);var r=i[t];return r&&0!==r.getAdCount()&&0!==r.getTotalDuration()?(this._currentSlot=r,this.currentAdId=r.getCustomId(),this.currentAdDuration=Number(r.getTotalDuration()),this._adProgress=0,this._updateAdTimer(r),this._emitAdPlay(),void this._playSlot(r)):(u.debug("no ad provided for the slot for ad type: "+e),void this._adError(d.NO_AD_PLAYED_AT_AD_SPOT))},_adEnd:function(){u.log("_adEnd"),this._emitAdEnd(),this._cleanup()},_adError:function(e){u.debug("_adError",e),this._emitAdError({errorMessage:e}),this._cleanup()},_cleanup:function(){this._disposeAdTimer(),this.currentAdId=""},onAdPlayhead:function(e,t){this.eAdPlayhead.dispatch(e,t)},_convertAdTypeFromImpl:function(e){switch(e){case p.PREROLL:return l.PREROLL;case p.MIDROLL:return l.MIDROLL;case p.POSTROLL:return l.POSTROLL}},getCurrentAdType:function(){return this._convertAdTypeFromImpl(this.currentAdType)},_convertVideoStateToImpl:function(e){switch(e){case c.PLAYING:return p.VIDEO_PLAYING;case c.PAUSED:return p.VIDEO_PAUSED;case c.STOPPED:return p.VIDEO_STOPPED;case c.COMPLETED:return p.VIDEO_COMPLETED}},setVideoState:function(e){if(this._super(e),this._fwContext){var t=this._convertVideoStateToImpl(e);t&&this._fwContext.setVideoState(t)}},getAdAnalyticsData:function(){var e={};if(!this._fwContext)return e;var t=this._fwContext.getTemporalSlots();return i.each(t,function(t,n){var i="temporal_"+n;e[i]=this._getDataForSlot(t)},this),e},_getDataForSlot:function(e){return{slotId:e.getCustomId(),adType:this._convertAdTypeFromImpl(e.getTimePositionClass()),position:e.getTimePosition(),category:e.getType(),duration:e.getTotalDuration(),adCount:e.getAdCount(),adInstances:this._getAdAnalyticsForSlot(e)}},getAdAnalyticsDataForCurrentSlot:function(){return this._currentSlot?{adInstances:this._getAdAnalyticsForSlot(this._currentSlot)}:void 0},_getAdAnalyticsForSlot:function(e){var t=e.getAdInstances();return i.map(t,this._getDataForAdInstance,this)},_getDataForAdInstance:function(e){var t={adId:e.getAdId()},n=e.getEventCallbackUrls(p.SDK.EVENT_AD_CLICK,p.SDK.EVENT_TYPE_CLICK);t.clickUrl=n.length?n[0]:"";var r=e.getActiveCreativeRendition();if(r&&i.isFunc(r.getPrimaryCreativeRenditionAsset)){var s=r.getPrimaryCreativeRenditionAsset();s&&(t.assetUrl=s.getUrl(),t.contentType=s.getContentType())}return t}});p.PREROLL=null,p.MIDROLL=null,p.POSTROLL=null,t.exports=p},{"../../cvp/errors":26,"../../cvp/log":28,"../../cvp/util/configutils":43,"../../cvp/util/timing":48,"../../cvp/utils":50,"./adtypes":54,"./baseimpl":55,"./videostates":58}],58:[function(e,t){t.exports={PLAYING:"PLAYING",PAUSED:"PAUSED",STOPPED:"STOPPED",COMPLETED:"COMPLETED"}},{}],59:[function(e,t){var n=e("../vendor/Class"),i=e("../cvp/customevent"),r=e("./manager"),s=e("../cvp/utils"),o=n.extend({init:function(e){this._manager=new r,this.ePlayerLoaded=new i,this.ePlayerLoadError=new i,this.ePlayerReady=new i,this.eContentMetadata=new i,this.eContentBegin=new i,this.eContentPlay=new i,this.eContentPause=new i,this.eContentEnd=new i,this.eContentComplete=new i,this.eContentPlayhead=new i,this.eContentBuffering=new i,this.eContentQueue=new i,this.eContentQueueAutoplay=new i,this.eContentVolume=new i,this.eContentError=new i,this.eContentResize=new i,this.eContentEntryLoad=new i,this.eContentEntryLoadError=new i,this.eAdPlayhead=new i,this.eAdPlay=new i,this.eAdEnd=new i,this.eAdError=new i,this.eAdSensitive=new i,this.eTrackingAdStart=new i,this.eTrackingAdComplete=new i,this.eTrackingAdProgress=new i,this.eTrackingAdCountdown=new i,this.eTrackingAdClick=new i,this.eTrackingContentPlay=new i,this.eTrackingContentBegin=new i,this.eTrackingContentProgress=new i,this.eTrackingContentComplete=new i,this.eTrackingContentReplay=new i,this.eTrackingContentSeek=new i,this.eTrackingContentSeekEnd=new i,this.eTrackingFullscreen=new i,this.eTrackingMuted=new i,this.eTrackingPaused=new i,this._isListening=!1,this.listen(!0),this._manager.load(e)},listen:function(e){if(this._isListening!==e){this._isListening=e;var t=e?"addListener":"removeListener";this._manager.ePlayerLoaded[t](this._onPlayerLoaded,this),this._manager.ePlayerLoadError[t](this._onPlayerLoadError,this),this._manager.ePlayerRendered[t](this._onPlayerRendered,this),this._manager.eContentMetadata[t](this._onContentMetadata,this),this._manager.eContentBegin[t](this._onContentBegin,this),this._manager.eContentPlay[t](this._onContentPlay,this),this._manager.eContentPause[t](this._onContentPause,this),this._manager.eContentEnd[t](this._onContentEnd,this),this._manager.eContentComplete[t](this._onContentComplete,this),this._manager.eContentPlayhead[t](this._onContentPlayhead,this),this._manager.eContentBuffering[t](this._onContentBuffering,this),this._manager.eContentQueue[t](this._onContentQueue,this),this._manager.eContentQueueAutoplay[t](this._onContentQueueAutoplay,this),this._manager.eContentVolume[t](this._onContentVolume,this),this._manager.eContentError[t](this._onContentError,this),this._manager.eContentResize[t](this._onContentResize,this),this._manager.eContentEntryLoad[t](this._onContentEntryLoad,this),this._manager.eContentEntryLoadError[t](this._onContentEntryLoadError,this),this._manager.eAdPlayhead[t](this._onAdPlayhead,this),this._manager.eAdPlay[t](this._onAdPlay,this),this._manager.eAdEnd[t](this._onAdEnd,this),this._manager.eAdError[t](this._onAdError,this),this._manager.eAdSensitive[t](this._onAdSensitive,this),this._manager.eTrackingAdStart[t](this._onTrackingAdStart,this),this._manager.eTrackingAdComplete[t](this._onTrackingAdComplete,this),this._manager.eTrackingAdProgress[t](this._onTrackingAdProgress,this),this._manager.eTrackingAdCountdown[t](this._onTrackingAdCountdown,this),this._manager.eTrackingAdClick[t](this._onTrackingAdClick,this),this._manager.eTrackingContentPlay[t](this._onTrackingContentPlay,this),this._manager.eTrackingContentBegin[t](this._onTrackingContentBegin,this),this._manager.eTrackingContentProgress[t](this._onTrackingContentProgress,this),this._manager.eTrackingContentComplete[t](this._onTrackingContentComplete,this),this._manager.eTrackingContentReplay[t](this._onTrackingContentReplay,this),this._manager.eTrackingContentSeek[t](this._onTrackingContentSeek,this),this._manager.eTrackingContentSeekEnd[t](this._onTrackingContentSeekEnd,this),this._manager.eTrackingFullscreen[t](this._onTrackingFullscreen,this),this._manager.eTrackingMuted[t](this._onTrackingMuted,this),this._manager.eTrackingPaused[t](this._onTrackingPaused,this)}},render:function(e){this._manager.render(e)},remove:function(){this._manager.remove()},dispose:function(){this.listen(!1),this._manager.dispose(),this._manager=null},getDefaultPlayer:function(){return this._manager.getCurrentPlayer()},play:function(e,t){this._manager.playContentWithId(e,t)},playFromObject:function(e,t){this._manager.playFromObject(e,t)},replay:function(){this._manager.replay()},playNextInQueue:function(){this._manager.playNextInQueue()},pause:function(){this._manager.pause()},resume:function(){this._manager.resume()},stop:function(){this._manager.stop()},queue:function(e,t,n){this._manager.queueContentWithId(e,t,n)},queueFromObject:function(e,t,n){this._manager.queueFromObject(e,t,n)},dequeue:function(e){this._manager.dequeueContentWithId(e)},emptyQueue:function(){this._manager.emptyQueue()},setQueueAutoplay:function(e){this._manager.setQueueAutoplay(e)},getQueue:function(){return this._manager.getQueue()},seek:function(e){this._manager.seek(e)},resize:function(e,t){this._manager.resize(e,t)},goFullscreen:function(){this._manager.goFullscreen()},setVolume:function(e){this._manager.setVolume(e)},getVolume:function(){return this._manager.getVolume()},mute:function(){this._manager.mute()},unmute:function(){this._manager.unmute()},isMuted:function(){return this._manager.isMuted()},getContentEntry:function(e){return this._manager.getContentEntry(e)},setAdSection:function(e){this._manager.setAdSection(e)},setAdKeyValue:function(e,t){this._manager.setAdKeyValue(e,t)},getAdKeyValues:function(){return this._manager.getAdKeyValues()},clearAdKeyValues:function(){this._manager.clearAdKeyValues()},setTrackingInterval:function(e){this._manager.setTrackingInterval(e)},setDataSrc:function(e){this._manager.setDataSrc(e)},switchAdContext:function(e,t){this._manager.switchAdContext(e,t)},switchTrackingContext:function(e,t){this._manager.switchTrackingContext(e,t)},reportAnalytics:function(e,t){this._manager.reportAnalytics(e,t)},_mungeArgs:function(e){var t=s.slice(e);return t.unshift(this.getDefaultPlayer()),t},_onPlayerLoaded:function(){this.ePlayerLoaded.dispatch()},_onPlayerLoadError:function(){this.ePlayerLoadError.dispatch()},_onPlayerRendered:function(){this.ePlayerReady.dispatch.apply(this.ePlayerReady,this._mungeArgs(arguments))},_onContentMetadata:function(){this.eContentMetadata.dispatch.apply(this.eContentMetadata,this._mungeArgs(arguments))},_onContentBegin:function(){this.eContentBegin.dispatch.apply(this.eContentBegin,this._mungeArgs(arguments))},_onContentPlay:function(){
this.eContentPlay.dispatch.apply(this.eContentPlay,this._mungeArgs(arguments))},_onContentPause:function(){this.eContentPause.dispatch.apply(this.eContentPause,this._mungeArgs(arguments))},_onContentEnd:function(){this.eContentEnd.dispatch.apply(this.eContentEnd,this._mungeArgs(arguments))},_onContentComplete:function(){this.eContentComplete.dispatch.apply(this.eContentComplete,this._mungeArgs(arguments))},_onContentPlayhead:function(){this.eContentPlayhead.dispatch.apply(this.eContentPlayhead,this._mungeArgs(arguments))},_onContentBuffering:function(){this.eContentBuffering.dispatch.apply(this.eContentBuffering,this._mungeArgs(arguments))},_onContentQueue:function(){this.eContentQueue.dispatch.apply(this.eContentQueue,this._mungeArgs(arguments))},_onContentQueueAutoplay:function(){this.eContentQueueAutoplay.dispatch.apply(this.eContentQueueAutoplay,this._mungeArgs(arguments))},_onContentVolume:function(){this.eContentVolume.dispatch.apply(this.eContentVolume,this._mungeArgs(arguments))},_onContentError:function(){this.eContentError.dispatch.apply(this.eContentError,this._mungeArgs(arguments))},_onContentResize:function(){this.eContentResize.dispatch.apply(this.eContentResize,this._mungeArgs(arguments))},_onContentEntryLoad:function(){this.eContentEntryLoad.dispatch.apply(this.eContentEntryLoad,this._mungeArgs(arguments))},_onContentEntryLoadError:function(){this.eContentEntryLoadError.dispatch.apply(this.eContentEntryLoadError,this._mungeArgs(arguments))},_onAdPlayhead:function(){this.eAdPlayhead.dispatch.apply(this.eAdPlayhead,this._mungeArgs(arguments))},_onAdPlay:function(){this.eAdPlay.dispatch.apply(this.eAdPlay,this._mungeArgs(arguments))},_onAdEnd:function(){this.eAdEnd.dispatch.apply(this.eAdEnd,this._mungeArgs(arguments))},_onAdError:function(){this.eAdError.dispatch.apply(this.eAdError,this._mungeArgs(arguments))},_onAdSensitive:function(){this.eAdSensitive.dispatch.apply(this.eAdSensitive,this._mungeArgs(arguments))},_onTrackingAdStart:function(){this.eTrackingAdStart.dispatch.apply(this.eTrackingAdStart,this._mungeArgs(arguments))},_onTrackingAdComplete:function(){this.eTrackingAdComplete.dispatch.apply(this.eTrackingAdComplete,this._mungeArgs(arguments))},_onTrackingAdProgress:function(){this.eTrackingAdProgress.dispatch.apply(this.eTrackingAdProgress,this._mungeArgs(arguments))},_onTrackingAdCountdown:function(){this.eTrackingAdCountdown.dispatch.apply(this.eTrackingAdCountdown,this._mungeArgs(arguments))},_onTrackingAdClick:function(){this.eTrackingAdClick.dispatch.apply(this.eTrackingAdClick,this._mungeArgs(arguments))},_onTrackingContentPlay:function(){this.eTrackingContentPlay.dispatch.apply(this.eTrackingContentPlay,this._mungeArgs(arguments))},_onTrackingContentBegin:function(){this.eTrackingContentBegin.dispatch.apply(this.eTrackingContentBegin,this._mungeArgs(arguments))},_onTrackingContentProgress:function(){this.eTrackingContentProgress.dispatch.apply(this.eTrackingContentProgress,this._mungeArgs(arguments))},_onTrackingContentComplete:function(){this.eTrackingContentComplete.dispatch.apply(this.eTrackingContentComplete,this._mungeArgs(arguments))},_onTrackingContentReplay:function(){this.eTrackingContentReplay.dispatch.apply(this.eTrackingContentReplay,this._mungeArgs(arguments))},_onTrackingContentSeek:function(){this.eTrackingContentSeek.dispatch.apply(this.eTrackingContentSeek,this._mungeArgs(arguments))},_onTrackingContentSeekEnd:function(){this.eTrackingContentSeekEnd.dispatch.apply(this.eTrackingContentSeekEnd,this._mungeArgs(arguments))},_onTrackingFullscreen:function(){this.eTrackingFullscreen.dispatch.apply(this.eTrackingFullscreen,this._mungeArgs(arguments))},_onTrackingMuted:function(){this.eTrackingMuted.dispatch.apply(this.eTrackingMuted,this._mungeArgs(arguments))},_onTrackingPaused:function(){this.eTrackingPaused.dispatch.apply(this.eTrackingPaused,this._mungeArgs(arguments))}});t.exports=o},{"../cvp/customevent":17,"../cvp/utils":50,"../vendor/Class":92,"./manager":72}],60:[function(e,t){function n(e,t){h("AspenController - send",arguments),a.send(t,e)}function i(){h("AspenController - setup"),a.eInitSuccess.removeListener(i,this),u=!0,h("AspenController - setup","dispatching init success event"),this.eInitSuccess.dispatch()}function r(e){h("AspenController - init",arguments),d||(d=!0,a.eInitSuccess.addListener(i,this),a.init(e))}function s(){return u}function o(e){if(!d)throw new Error("AspenController - getConfig cannot be called until after AspenController has successfully inited!");if(!u)throw new Error("AspenController - getConfig cannot be called until after Aspen has successfully inited!");return h("AspenController - getConfig",e),a.getConfig(e)}var a=e("../aspen/aspen"),l=e("../cvp/customevent"),c=e("../cvp/log"),d=!1,u=!1,h=c.getLogger().log;t.exports={videoCount:0,eInitSuccess:new l,isReady:s,getConfig:o,send:n,init:r}},{"../aspen/aspen":1,"../cvp/customevent":17,"../cvp/log":28}],61:[function(e,t){var n=e("../vendor/Class"),i=e("../cvp/customevent"),r=e("../cvp/util/dependencymanager"),s=e("./dependencies/mapping"),o=e("./dependencies/appconfig"),a=e("./dependencies/container"),l=e("./dependencies/config"),c=e("./dependencies/adpolicy"),d=e("./dependencies/trackingpolicy"),u=e("../cvp/utils"),h=e("./shared/playerconfig"),p=r.extend({setBootstrapper:function(e){this._bootstrap=e},clearBootstrapper:function(){this._bootstrap=null},setParams:function(e){this._params=e},getParams:function(){return this._params}}),g=n.extend({init:function(e,t){this._mappingUrl=e,this._params=t||{},this.eSuccess=new i,this.eFailure=new i},load:function(){this._bootManager=new p,this._bootManager.setBootstrapper(this),this._bootManager.setParams(this._params);var e=new s(this._mappingUrl,!0);e.setContext(this._params.profile),this._bootManager.addDependency(e),this._bootManager.eDependencySuccess.addListener(this._onDependencySuccess,this),this._bootManager.eSuccess.addListener(this._success,this),this._bootManager.eFailure.addListener(this._failure,this),this._bootManager.load()},_onDependencySuccess:function(e,t){e instanceof s?this._mapping=t:e instanceof o?this._appConfig=t:e instanceof a?this._containerInfo=t:e instanceof l?this._configInfo=t:e instanceof c?this._adPolicy=t:e instanceof d&&(this._trackingPolicy=t)},_success:function(){var e={};e.data={},e.data.mapping=u.extend({},h.mapping,this._mapping),e.data.appConfig=u.extend({},h.appConfig,this._appConfig),e.data.containerInfo=u.extend({},h.containerInfo,this._containerInfo),e.data.configInfo=u.extend({},h.configInfo,this._configInfo),e.data.adPolicy=u.extend({},h.adPolicy,this._adPolicy),e.data.trackingPolicy=u.extend({},h.trackingPolicy,this._trackingPolicy),this.eSuccess.dispatch(e),this._complete()},_failure:function(){this.eFailure.dispatch(),this._complete()},_complete:function(){this._bootManager&&(this._bootManager.eDependencySuccess.removeListener(this._onDependencySuccess,this),this._bootManager.eSuccess.removeListener(this._success,this),this._bootManager.eFailure.removeListener(this._failure,this),this._bootManager.clearBootstrapper(),this._bootManager=null)}});t.exports=g},{"../cvp/customevent":17,"../cvp/util/dependencymanager":45,"../cvp/utils":50,"../vendor/Class":92,"./dependencies/adpolicy":64,"./dependencies/appconfig":65,"./dependencies/config":66,"./dependencies/container":67,"./dependencies/mapping":68,"./dependencies/trackingpolicy":69,"./shared/playerconfig":89}],62:[function(e,t){var n=e("../core/app"),i=e("../vendor/Class"),r=e("../cvp/customevent"),s=e("./contententry"),o=e("./fakecontententry"),a=e("./expiredcontententry"),l=e("../cvp/request"),c=e("../cvp/utils"),d=i.extend({init:function(){this._catalogDataURL="",this._mediaUrl="",this._requestPendingQueue=[],this._requestInProgress=!1,this._videoCatalog=[],this._objectMap={},this._onContentIdRequestComplete=c.bind(this._onContentIdRequestComplete,this),this._onContentIdRequestIOError=c.bind(this._onContentIdRequestIOError,this),this._requestCleanup=c.bind(this._requestCleanup,this),this.eRequestCompleted=new r("CmsRequestCompletedEvent")},addContentId:function(e){var t=this.getContentId(e);if(c.isNull(t))this._requestPendingQueue.push(e);else{var n=e.split("|")[1];e=e.split("|")[0],this._notifyListeners(e,e,n,"","")}this._processNextRequest()},addContentObject:function(e,t){var i=e.split("|"),r=i[0],s=new o(t),a=this._videoCatalog.length;s&&s.hasFiles()?(this._objectMap[e]=s,this._requestPendingQueue.push(e)):this._notifyListeners(r,r,a,"Invalid data",n.ERROR_CMS_PARSE),this._processNextRequest()},getContentId:function(e){e=e.split("|")[0];for(var t,n=0,i=this._videoCatalog.length;i>n;++n)if(t=this._videoCatalog[n],t.getId()===e)return t;return null},setDataUrl:function(e){this._catalogDataURL=e},setMediaUrl:function(e){this._mediaUrl=e},_getRequestUrl:function(e){var t,n=this._catalogDataURL.substr(0).search(/\$\{/);if(-1!==n){var i=this._catalogDataURL.substr(n).search(/\}/);if(-1!==i){var r=this._catalogDataURL.substr(n,i+1);t=this._catalogDataURL.replace(r,e)}}else t=this._catalogDataURL+"/"+e+".xml";return t},_createContentEntryFromRequestData:function(e,t){try{var n=new s(e);return n.setMediaUrl(this._mediaUrl),n}catch(i){alert(this._getRequestUrl(t)+": "+i.message)}return null},_processNextRequest:function(){if(!this._requestInProgress&&this._requestPendingQueue.length){var e=this._requestPendingQueue[0];if(e in this._objectMap)this._processVideoFromObject(e);else{var t=e.split("|")[0];this._requestVideoWithId(t)}}},_requestVideoWithId:function(e){var t=this._getRequestUrl(e),n=l.getXML({url:t});this._requestInProgress=!0,n.then(this._onContentIdRequestComplete,this._onContentIdRequestIOError).ensure(this._requestCleanup)},_requestCleanup:function(){this._requestInProgress=!1,this._requestPendingQueue.shift(),this._processNextRequest()},_onContentIdRequestComplete:function(e){var t=this._requestPendingQueue[0].split("|"),i=t[0],r=t[1];if(!e)return void this._notifyListeners(i,i,r,"No data",n.ERROR_CMS_PARSE);var s=this._createContentEntryFromRequestData(e,i);return s&&s.hasFiles()?(s.isExpired()&&(s=new a),s.requestId=i,this._videoCatalog.push(s),void this._notifyListeners(s.getId(),s.requestId,r,"","")):void this._notifyListeners(i,i,r,"Invalid data",n.ERROR_CMS_PARSE)},_onContentIdRequestIOError:function(e){var t=this._requestPendingQueue[0].split("|"),i=t[0],r=t[1];this._notifyListeners(i,i,r,"IOError : "+e,n.ERROR_CMS_IO)},_processVideoFromObject:function(e){var t=this._objectMap[e],n=e.split("|"),i=n[0],r=n[1];t.requestId=i,t.setMediaUrl(this._mediaUrl),this._videoCatalog.push(t),this._notifyListeners(i,t.requestId,r,"",""),this._requestCleanup()},_notifyListeners:function(e,t,n,i,r){this.eRequestCompleted.dispatch(e,t,n,i,r)}});t.exports=d},{"../core/app":10,"../cvp/customevent":17,"../cvp/request":35,"../cvp/utils":50,"../vendor/Class":92,"./contententry":63,"./expiredcontententry":70,"./fakecontententry":71}],63:[function(e,t){var n=e("../vendor/Class"),i=e("../cvp/utils"),r=e("../cvp/util/xml"),s=e("../cvp/log"),o=s.getLogger(),a=["flv"],l=n.extend({init:function(e){var t,n,s,l,c,d,u,h,p,g,f,_,m,v,y,C,E,P,b,T;if(this._xmlEntry=e.documentElement,this._requestId=null,this._mediaUrl="",this._name=r.getNodeValue(this._xmlEntry,"slug"),this._title=r.getNodeValue(this._xmlEntry,"headline"),this._category=r.getNodeValue(this._xmlEntry,"category"),this._trt=+r.getNodeValue(this._xmlEntry,"trt"),t=this._xmlEntry.getElementsByTagName("files"),t.length){for(t=r.getChildElements(t[0]),this._fileList={},d=0,u=t.length;u>d;++d)if(n=t[d],"file"===n.nodeName)if(s=r.getAttribute(n,"key")||r.getAttribute(n,"bitrate"),l=r.getAttribute(n,"fallback"),c=r.getNodeValue(n))if(h="",T=i.parseUrl(this.sanitizeUrl(c)),T&&(y=T.file.lastIndexOf("."),-1!==y&&(h=T.file.substring(y+1))),o.debug("ContentCatalogEntry",s,c,h),-1===i.indexOf(a,h)){if(s in this._fileList){var A=this._fileList[s].url;o.warn("The file key/bitrate '"+s+"' already exists with URL '"+A+"' and is now being overwritten with "+(A===c?"the same URL":"URL '"+c+"'")+".")}this._fileList[s]={url:c,fallback:l,ext:h}}else o.info("Ignoring "+c+" because extention '"+h+"' is unsupported.");else o.info("Ignoring file key/bitrate '"+s+"' because it has no text() -- no URL!")}else o.warn("ContentCatalogEntry","No file entries found!");if(p=this._xmlEntry.getElementsByTagName("images"),p.length)for(p=r.getChildElements(p[0]),this._imageList={},d=0,u=p.length;u>d;++d)g=p[d],f=r.getAttribute(g,"width"),_=r.getAttribute(g,"height"),v=r.getNodeValue(g),o.debug("ContentCatalogEntry","images",f,_,v),m=f+"|"+_,this._imageList[m]={url:v,width:f,height:_};if(C=this._xmlEntry.getElementsByTagName("ads"),C.length)for(C=r.getChildElements(C[0]),this._adList={},d=0,u=C.length;u>d;++d)E=C[d],P=r.getAttribute(E,"type"),b=r.getNodeValue(E),o.debug("ContentCatalogEntry","ad",P,b),this._adList[P]={url:b}},hasFiles:function(){return!i.empty(this._fileList)},setMediaUrl:function(e){this._mediaUrl=e},getMediaUrl:function(){return this._mediaUrl},getId:function(){var e=r.getAttribute(this._xmlEntry,"id");return i.empty(e)?this._requestId:e},getName:function(){return this._name},getTitle:function(){return this._title},getCategory:function(){return this._category},getTrt:function(){return this._trt},isExpired:function(){var e=r.getNodeValue(this._xmlEntry,"isExpired");return i.isFlagActive(e,!1)},isAdSensitive:function(){var e=r.getNodeValue(this._xmlEntry,"isAdSensitive");return i.isFlagActive(e,!1)},getSource:function(){var e=r.getAttribute(this._xmlEntry,"source");return e||void 0},getOriginId:function(){var e=r.getAttribute(this._xmlEntry,"originId");return e||void 0},getMode:function(){var e=r.getAttribute(this._xmlEntry,"isLive");return i.empty(e)?"vod":"live"},isLive:function(){return"live"===this.getMode()},sanitizeUrl:function(e){return e?(i.isRelative(e)&&(e=this._mediaUrl+e),this.token&&i.augmentQueryString(e,{hdnea:this.token}),e):e},getAllFiles:function(){var e={};return i.each(this._fileList,function(t,n){e[t]=i.extend({},n)}),e},getContentUrl:function(e){var t,n=null,r=!1;for(t in this._fileList)if(t===e){n=this.sanitizeUrl(this._fileList[t].url),r=!0;break}return r?i.empty(n)&&o.warn("text attribute is empty in the video XML for the <file> node whose quality is '"+e+"'."):o.warn("Config XML specifies a '"+e+"' bitrate entry, but there is no <file> node in video XML where bitrate attribute is '"+e+"'."),n},getContentUrlsForExtension:function(e){var t=[];return i.each(this._fileList,function(n,i){i.ext===e&&t.push(this.sanitizeUrl(i.url))},this),t},getContentUrlsByExtensions:function(e){var t=[];return i.each(e,function(e){var n=this.getContentUrlsForExtension(e);t.push.apply(t,n)},this),t},getContentUrlsByFileKeys:function(e){return i.map(e,this.getContentUrl,this)},getContentUrlFromFallback:function(e){var t=null,n=null,r="";for(r in this._fileList)if(n=this._fileList[r],!i.empty(n.fallback)&&e===n.fallback){t=this.sanitizeUrl(n.url);break}return t},getContentUrlFromType:function(e){var t,n=null,i=null;for(t in this._fileList)if(i=this._fileList[t],e===i.ext){n=this.sanitizeUrl(i.url);break}return n},getThumbnailUrl:function(e,t){var n,i=null,r=e+"|"+t;for(n in this._imageList)if(n===r){i=this._imageList[n].url;break}return i},getImageForDimensions:function(e,t){function n(n){var i={};return i.url=n.url,i.width=Number(n.width)||1,i.height=Number(n.height)||1,i.ratio=i.width/i.height,i.absDeltaWidth=Math.abs(e-i.width),i.absDeltaHeight=Math.abs(t-i.height),i.absDeltaRatio=Math.abs(r-i.ratio),i}if(o.log("getImageForDimensions",e,t),i.isEmpty(this._imageList))return o.log("getImageForDimensions","No images!"),null;var r=e/t,s=this.getThumbnailUrl(e,t);if(s)return o.log("getImageForDimensions","Found exact match!"),s;var a=[];if(i.each(this._imageList,function(e,t){a.push(n(t))}),a.length<2)return a[0].url;var l=a.sort(this._compareAbsDeltaWidth),c=l[0];o.debug("getImageForDimensions","closest by width",c);var d=l.sort(this._compareAbsDeltaHeight),u=d[0];o.debug("getImageForDimensions","closest by height",u);var h;if(c===u)o.debug("getImageForDimensions","found an obvious winner (closest by width AND height)"),h=c;else{var p=[c,u].sort(this._compareAbsDeltaRatio);o.debug("getImageForDimensions","comparing closest-by-width and closest-by-height to find the closest in aspect ratio",c,u),h=p[0]}return o.debug("getImageForDimensions","winner",h),h.url},_compareAbsDeltaWidth:function(e,t){return e.absDeltaWidth-t.absDeltaWidth},_compareAbsDeltaHeight:function(e,t){return e.absDeltaHeight-t.absDeltaHeight},_compareAbsDeltaRatio:function(e,t){return e.absDeltaRatio-t.absDeltaRatio},getAdUrl:function(e){return this._adList&&this._adList[e]&&this._adList[e].url||null},getXML:function(){return this._xmlEntry}});t.exports=l},{"../cvp/log":28,"../cvp/util/xml":49,"../cvp/utils":50,"../vendor/Class":92}],64:[function(e,t){var n=e("../../cvp/util/dependency"),i=e("../parsers/adpolicy"),r=e("../../cvp/log"),s=e("../../core/app"),o=r.getLogger(),a=n.extend({init:function(){this._super.apply(this,arguments),this.required=!0,this._parser=new i,this._parser.eParseCompleted.addListener(this._onParseCompleted,this),this._parser.eParseError.addListener(this._onParseError,this)},setContext:function(e){this._parser.setAdPolicyContext(e)},load:function(){o.info("AdPolicyDependency","loading xml",this._assetUrl),this._parser.parse(this._assetUrl)},_onParseCompleted:function(e){var t=e.ads.attr.type.toLowerCase();"freewheel"===t?(o.info("AdPolicyDependency","adding FW dependency"),this._manager.addDependency(new n(s.AD_MANAGER_URL,!0))):"dfp"===t&&(o.info("AdPolicyDependency","adding DFP dependency"),this._manager.addDependency(new n(s.AD_DFP_URL,!0))),this._success(e)},_onParseError:function(){this._failure()},_complete:function(){this._parser&&(this._parser.eParseCompleted.removeListener(this._onParseCompleted,this),this._parser.eParseError.removeListener(this._onParseError,this),this._parser=null),this._super()},getDesc:function(){return"AdPolicyDependency: "+this._assetUrl}});t.exports=a},{"../../core/app":10,"../../cvp/log":28,"../../cvp/util/dependency":44,"../parsers/adpolicy":73}],65:[function(e,t){var n=e("../../cvp/util/dependency"),i=e("../parsers/appconfig"),r=e("./container"),s=e("../../cvp/utils"),o=e("../../cvp/log"),a=o.getLogger(),l=n.extend({init:function(){this._super.apply(this,arguments),this.required=!0,this._parser=new i,this._parser.eParseCompleted.addListener(this._onParseCompleted,this),this._parser.eParseError.addListener(this._onParseError,this)},load:function(){a.info("AppConfigDependency","loading xml",this._assetUrl),this._parser.parse(this._assetUrl)},_onParseCompleted:function(e){if(!e||s.empty(e.containerUrl)||s.empty(e.configUrl))return a.error("Unable to retrieve the appConfig file."),void this._failure();var t=new r(e.containerUrl,!0);t.setConfigUrl(e.configUrl),t.passParams(this._manager.getParams()),this._manager.addDependency(t),this._success(e)},_onParseError:function(){this._failure()},_complete:function(){this._parser&&(this._parser.eParseCompleted.removeListener(this._onParseCompleted,this),this._parser.eParseError.removeListener(this._onParseError,this),this._parser=null),this._super()},getDesc:function(){return"AppConfigDependency: "+this._assetUrl}});t.exports=l},{"../../cvp/log":28,"../../cvp/util/dependency":44,"../../cvp/utils":50,"../parsers/appconfig":74,"./container":67}],66:[function(e,t){var n=e("../../cvp/util/dependency"),i=e("../parsers/config"),r=e("../../cvp/utils"),s=e("../../cvp/log"),o=s.getLogger(),a=n.extend({init:function(){this._super.apply(this,arguments),this.required=!0,this._parser=new i,this._parser.eParseCompleted.addListener(this._onParseCompleted,this),this._parser.eParseError.addListener(this._onParseError,this)},setContext:function(e){this._parser.setPlayerInstance(e)},load:function(){this._parser.parse(this._assetUrl)},_onParseCompleted:function(e){this._manager&&(r.empty(e.omniture)||r.empty(e.omniture.omniture_account)||o.info("ContainerDependency","adding Omniture dependency")),this._success(e)},_onParseError:function(){this._failure()},_complete:function(){this._parser&&(this._parser.eParseCompleted.removeListener(this._onParseCompleted,this),this._parser.eParseError.removeListener(this._onParseError,this),this._parser=null),this._super()},getDesc:function(){return"ConfigDependency: "+this._assetUrl}});t.exports=a},{"../../cvp/log":28,"../../cvp/util/dependency":44,"../../cvp/utils":50,"../parsers/config":75}],67:[function(e,t){var n=e("../../cvp/util/dependency"),i=e("../parsers/container"),r=e("./config"),s=e("./adpolicy"),o=e("./trackingpolicy"),a=e("../../cvp/utils"),l=e("../../cvp/log"),c=l.getLogger(),d=n.extend({init:function(){this._super.apply(this,arguments),this.required=!0,this._parser=new i,this._parser.eParseCompleted.addListener(this._onParseCompleted,this),this._parser.eParseError.addListener(this._onParseError,this)},setConfigUrl:function(e){this.configUrl=e},passParams:function(e){this._parser.setParams(e)},load:function(){c.info("ContainerDependency","loading xml",this._assetUrl),this._parser.parse(this._assetUrl)},_onParseCompleted:function(e){var t=new r(this.configUrl,!0);if(t.setContext(e.playerInstance),this._manager.addDependency(t),!a.empty(e.adPolicySrc)){var n=new s(e.adPolicySrc,!0);n.setContext(e.adPolicyContext),this._manager.addDependency(n)}if(!a.empty(e.trackingPolicySrc)){var i=new o(e.trackingPolicySrc,!1);i.setContext(e.trackingPolicyContext),this._manager.addDependency(i)}this._success(e)},_onParseError:function(){this._failure()},_complete:function(){this._parser&&(this._parser.eParseCompleted.removeListener(this._onParseCompleted,this),this._parser.eParseError.removeListener(this._onParseError,this),this._parser=null),this._super()},getDesc:function(){return"ContainerDependency: "+this._assetUrl}});t.exports=d},{"../../cvp/log":28,"../../cvp/util/dependency":44,"../../cvp/utils":50,"../parsers/container":76,"./adpolicy":64,"./config":66,"./trackingpolicy":69}],68:[function(e,t){var n=e("../../cvp/util/dependency"),i=e("../parsers/mapping"),r=e("./appconfig"),s=e("../../cvp/utils"),o=e("../../cvp/log"),a=o.getLogger(),l=n.extend({init:function(){this._super.apply(this,arguments),this.required=!0,this._parser=new i,this._parser.eParseCompleted.addListener(this._onParseCompleted,this),this._parser.eParseError.addListener(this._onParseError,this)},setContext:function(e){this._parser.setMappingProfile(e)},load:function(){a.info("MappingDependency","loading xml",this._assetUrl),this._parser.parse(this._assetUrl)},_onParseCompleted:function(e){if(!e||s.empty(e.url))return a.error("Unable to retrieve the mapping file."),void this._failure();var t=s.replaceExtension(e.url,"xml","json");this._manager.addDependency(new r(t,!0)),this._success(e)},_onParseError:function(){this._failure()},_complete:function(){this._parser&&(this._parser.eParseCompleted.removeListener(this._onParseCompleted,this),this._parser.eParseError.removeListener(this._onParseError,this),this._parser=null),this._super()},getDesc:function(){return"MappingDependency: "+this._assetUrl}});t.exports=l},{"../../cvp/log":28,"../../cvp/util/dependency":44,"../../cvp/utils":50,"../parsers/mapping":78,"./appconfig":65}],69:[function(e,t){var n=e("../../cvp/util/dependency"),i=e("../parsers/trackingpolicy"),r=e("../../cvp/log"),s=r.getLogger(),o=n.extend({init:function(){this._super.apply(this,arguments),this._parser=new i,this._parser.eParseCompleted.addListener(this._onParseCompleted,this),this._parser.eParseError.addListener(this._onParseError,this)},setContext:function(e){this._parser.setTrackingPolicyContext(e)},load:function(){s.info("TrackingPolicyDependency","loading xml",this._assetUrl),this._parser.parse(this._assetUrl)},_onParseCompleted:function(e){this._success(e)},_onParseError:function(){this._failure()},_complete:function(){this._parser&&(this._parser.eParseCompleted.removeListener(this._onParseCompleted,this),this._parser.eParseError.removeListener(this._onParseError,this),this._parser=null),this._super()},getDesc:function(){return"TrackingPolicyDependency: "+this._assetUrl}});t.exports=o},{"../../cvp/log":28,"../../cvp/util/dependency":44,"../parsers/trackingpolicy":79}],70:[function(e,t){var n=e("./contententry"),i=e("../core/app"),r=e("../cvp/util/xml"),s=n.extend({init:function(){var e='<video id="not_avail"><headline>The requested video is not available.</headline><description></description><isExpired>true</isExpired><isAdSensitive>true</isAdSensitive><trt>0</trt><files><file>'+i.EXPIRED_MP4_URL+'</file></files><images><image width="320" height="240">'+i.EXPIRED_IMG_URL+"</image></images></video>",t=r.stringToDoc(e);this._super(t)}});t.exports=s},{"../core/app":10,"../cvp/util/xml":49,"./contententry":63}],71:[function(e,t){var n=e("./contententry"),i=e("../cvp/utils"),r=e("../cvp/util/xml"),s=n.extend({init:function(e){var t=null,n="",s=e.id||e.url;if(i.isString(e.url)&&(t=e.url),i.isObject(e.metadata))for(var o in e.metadata)"files"===o&&t||(n+="<"+o+">"+e.metadata[o]+"</"+o+">");t&&(n+="<files><file>"+t+"</file></files>");var a="<video id='"+s+"'> "+n+"</video>",l=r.stringToDoc(a);this._super(l)}});t.exports=s},{"../cvp/util/xml":49,"../cvp/utils":50,"./contententry":63}],72:[function(e,t){var n=e("../vendor/Class"),i=e("../cvp/customevent"),r=e("../cvp/ajax"),s=e("../cvp/utils"),o=e("../cvp/util/jsonconverter"),a=e("../cvp/log"),l=e("../core/app"),c=e("./bootstrapper"),d=e("./aspencontroller"),u=e("./cms"),h=e("./player/instance"),p=e("./tracking/trackingmanager"),g=e("./tracking/aspentracking"),f=e("./player/videobegetter"),_=a.getLogger(),m=n.extend({init:function(){this._configData={},this.ePlayerLoaded=new i,this.ePlayerLoadError=new i,this.ePlayerRendered=new i,this.eContentMetadata=new i,this.eContentBegin=new i,this.eContentPlay=new i,this.eContentPause=new i,this.eContentEnd=new i,this.eContentComplete=new i,this.eContentPlayhead=new i,this.eContentBuffering=new i,this.eContentQueue=new i,this.eContentQueueAutoplay=new i,this.eContentVolume=new i,this.eContentError=new i,this.eContentResize=new i,this.eContentEntryLoad=new i,this.eContentEntryLoadError=new i,this.eAdPlayhead=new i,this.eAdPlay=new i,this.eAdEnd=new i,this.eAdError=new i,this.eAdSensitive=new i,this.eTrackingAdStart=new i,this.eTrackingAdComplete=new i,this.eTrackingAdProgress=new i,this.eTrackingAdCountdown=new i,this.eTrackingAdClick=new i,this.eTrackingContentPlay=new i,this.eTrackingContentBegin=new i,this.eTrackingContentProgress=new i,this.eTrackingContentEnd=new i,this.eTrackingContentComplete=new i,this.eTrackingContentReplay=new i,this.eTrackingContentSeek=new i,this.eTrackingContentSeekEnd=new i,this.eTrackingFullscreen=new i,this.eTrackingMuted=new i,this.eTrackingPaused=new i,this._loadingEntryQueue={},this._params={}},load:function(e){this._videoBegetter=new f,this._videoBegetter.prime(),this._params=e;var t=e.flashVars;s.isSimpleObject(t)&&(e.site=t.site,e.profile=t.profile,e.context=t.context,e.contentId=t.contentId,e.containerUrl=t.containerUrl,e.configUrl=t.configUrl,e.aspenContext=t.aspenContext,e.dt=!!t.superduperdevtime,e.requestTimeout=s.toInt(t.requestTimeout),e.requestRetries=s.toInt(t.requestRetries),"autostart"in t&&(e.autostart=s.isFlagActive(t.autostart,!1)),"controls"in t&&(e.controls=s.isFlagActive(t.controls,!0))),e.requestTimeout&&(r.JSONP.requestTimeout=e.requestTimeout),e.requestRetries&&(r.JSONP.maxRetries=e.requestRetries);var n=this._calculateMappingUrl(this._params.site);return s.empty(n)?(_.error("Unable to calculate mapping file url. Failing."),void this._bootStrapFailure()):(this._bootStrapper=new c(n,this._params),this._bootStrapper.eSuccess.addListener(this._bootStrapSuccess,this),this._bootStrapper.eFailure.addListener(this._bootStrapFailure,this),this._bootStrapper.load(),void d.init({dt:this._params.dt,context:this._params.aspenContext||this._params.context,site:this._params.site}))},_calculateMappingUrl:function(e){if(s.empty(e))return null;var t=s.replaceExtension(l.MAPPING_FILE,"xml","json");return this._params.dt||(t=s.template(l.MAPPING_PATH,e)+t),t},_bootStrapSuccess:function(e){if(!e||!e.data)return _.error("MainController","Unable to retrieve config data - failing."),void this._bootStrapFailure();this._configData=e.data,_.debug("MainController","_bootStrapSuccess");var t={autostart:!1,controls:!0,muted:!1},n=this._configData.configInfo;if(n&&(s.each(t,function(e,t){n[e]=s.isFlagActive(n[e],t)}),"volume"in n)){var i=s.toInt(n.volume)/100;isFinite(i)&&(n.volume=Math.min(Math.max(i,0),1))}var r=this._params;"autostart"in r&&(this._configData.configInfo.autostart=r.autostart),"controls"in r&&(this._configData.configInfo.controls=r.controls),"iosAirplay"in r&&(this._configData.configInfo.iosAirplay=r.iosAirplay),this._playerController=new h(this._videoBegetter,{params:this._params,configData:this._configData}),this._aspenTracking=new g({playerController:this._playerController,cvpElementId:this.getCurrentPlayer()}),this._trackingManager=new p({playerController:this._playerController}),this.setTrackingInterval(this._configData.trackingPolicy.interval),this._cms=new u,this._cms.setDataUrl(this._configData.configInfo.dataSrc),this._cms.setMediaUrl(this._configData.configInfo.mediaSrc),this._listen(!0),function(e){var t=e&&e.adPolicy&&e.adPolicy.ads||{},n=e.configInfo||{},i=e.containerInfo||{},r={cvpElementId:i.elementName,adApi:t.apiUrl,adServerRootUrl:t.adServerRootUrl,adNetworkId:t.adNetworkId,adVideoNetworkId:t.adVideoNetworkId,adVideoAssetId:t.adVideoAssetId,adSection:t.adSection,adPlayerProfile:t.adPlayerProfile,renderersUrl:t.renderersUrl,sensitiveFallbackId:t.sensitiveFallbackId,adLiveContentDuration:t.liveDuration,mediaSrc:n.mediaSrc,dataSrc:n.dataSrc,adPolicyUrl:i.adPolicySrc};d.send("appConfig",{playerConfigUrl:e.appConfig&&e.appConfig.configUrl,containerName:document.URL}),d.send("elementConfig",r)}.call(this,this._configData),this.ePlayerLoaded.dispatch(),this._bootStrapComplete()},_listen:function(e){if(this._isListening!==e){this._isListening=e;var t=e?"addListener":"removeListener";this._playerController.eRendered[t](this._onRendered,this),this._playerController.eContentMetadata[t](this._onContentMetadata,this),this._playerController.eContentBegin[t](this._onContentBegin,this),this._playerController.eContentPlay[t](this._onContentPlay,this),this._playerController.eContentPause[t](this._onContentPause,this),this._playerController.eContentEnd[t](this._onContentEnd,this),this._playerController.eContentComplete[t](this._onContentComplete,this),this._playerController.eContentPlayhead[t](this._onContentPlayhead,this),this._playerController.eContentBuffering[t](this._onContentBuffering,this),this._playerController.eContentQueue[t](this._onContentQueue,this),this._playerController.eContentQueueAutoplay[t](this._onContentQueueAutoplay,this),this._playerController.eContentVolume[t](this._onContentVolume,this),this._playerController.eContentError[t](this._onContentError,this),this._playerController.eContentResize[t](this._onContentResize,this),this._playerController.eAdPlayhead[t](this._onAdPlayhead,this),this._playerController.eAdPlay[t](this._onAdPlay,this),this._playerController.eAdEnd[t](this._onAdEnd,this),this._playerController.eAdError[t](this._onAdError,this),this._playerController.eAdSensitive[t](this._onAdSensitive,this),this._trackingManager.eTrackingAdStart[t](this._onTrackingAdStart,this),this._trackingManager.eTrackingAdComplete[t](this._onTrackingAdComplete,this),this._trackingManager.eTrackingAdProgress[t](this._onTrackingAdProgress,this),this._trackingManager.eTrackingAdCountdown[t](this._onTrackingAdCountdown,this),this._trackingManager.eTrackingAdClick[t](this._onTrackingAdClick,this),this._trackingManager.eTrackingContentPlay[t](this._onTrackingContentPlay,this),this._trackingManager.eTrackingContentBegin[t](this._onTrackingContentBegin,this),this._trackingManager.eTrackingContentProgress[t](this._onTrackingContentProgress,this),this._trackingManager.eTrackingContentEnd[t](this._onTrackingContentEnd,this),
this._trackingManager.eTrackingContentComplete[t](this._onTrackingContentComplete,this),this._trackingManager.eTrackingContentReplay[t](this._onTrackingContentReplay,this),this._trackingManager.eTrackingContentSeek[t](this._onTrackingContentSeek,this),this._trackingManager.eTrackingContentSeekEnd[t](this._onTrackingContentSeekEnd,this),this._trackingManager.eTrackingFullscreen[t](this._onTrackingFullscreen,this),this._trackingManager.eTrackingMuted[t](this._onTrackingMuted,this),this._trackingManager.eTrackingPaused[t](this._onTrackingPaused,this),this._cms.eRequestCompleted[t](this._onCmsRequestCompleted,this)}},_bootStrapFailure:function(){_.debug("MainController","_bootStrapFailure"),this.ePlayerLoadError.dispatch(),this._bootStrapComplete()},_bootStrapComplete:function(){_.debug("MainController","_bootStrapComplete"),this._bootStrapper.eSuccess.removeListener(this._bootStrapSuccess,this),this._bootStrapper.eFailure.removeListener(this._bootStrapFailure,this),this._bootStrapper=null},render:function(e){this._playerController.render(e)},remove:function(){this._playerController.remove()},dispose:function(){this._videoBegetter.dispose(),this._videoBegetter=null,this._listen(!1),this._trackingManager.dispose(),this._trackingManager=null,this._aspenTracking.dispose(),this._aspenTracking=null,this._playerController.dispose(),this._playerController=null,this._cms=null},_onRendered:function(){var e=this._params.contentId;s.isNull(e)||(_.debug("MainController","Config property 'contentId' was provided with value '"+e+"'. Initiating play."),this.playContentWithId(e)),this.ePlayerRendered.dispatch()},playContentWithId:function(e,t){_.debug("MainController","playContentWithId",e),this._videoBegetter.prime();var n=this._getNextIndexForId(e),i=e+"|"+n;_.debug("MainController","playContentWithId","key",i),this._loadingEntryQueue[i]={play:!0,additionalParams:t},this._cms.addContentId(i)},playFromObject:function(e,t){if(!s.isString(e.url))return _.warn("MainController","playFromObject","The property 'url' is required of the object parameter."),void this.eContentEntryLoadError.dispatch(e.id,"Invalid object configuration",l.ERROR_CMS_PARSE,!1);var n=e.id||e.url;_.debug("MainController","playFromObject",n),this._videoBegetter.prime();var i=this._getNextIndexForId(n),r=n+"|"+i;_.debug("MainController","playFromObject","key",r),this._loadingEntryQueue[r]={play:!0,additionalParams:t},this._cms.addContentObject(r,e)},queueFromObject:function(e,t){var n=e.id||e.url;_.debug("MainController","queueFromObject",n);var i=this._getNextIndexForId(n),r=n+"|"+i;_.debug("MainController","queueFromObject","key",r),this._loadingEntryQueue[r]={play:!1,additionalParams:t},this._cms.addContentObject(r,e)},playNextInQueue:function(){this._playerController.playNextInQueue()},replay:function(){this._playerController.replay()},pause:function(){this._playerController.pause()},resume:function(){this._playerController.resume()},stop:function(){this._playerController.stop()},queueContentWithId:function(e,t){_.debug("MainController","queueContentWithId",e);var n=this._getNextIndexForId(e),i=e+"|"+n;_.debug("MainController","queueContentWithId","key",i),this._loadingEntryQueue[i]={play:!1,additionalParams:t},this._cms.addContentId(i)},dequeueContentWithId:function(e){this._playerController.dequeue(e)},emptyQueue:function(){this._playerController.emptyQueue()},setQueueAutoplay:function(e){this._playerController.setQueueAutoplay(e)},getQueue:function(){return this._playerController.getQueue()},seek:function(e){this._playerController.seek(e)},resize:function(e,t){this._playerController.resize(e,t)},goFullscreen:function(){this._playerController.goFullscreen()},setVolume:function(e){this._playerController.setVolume(e)},getVolume:function(){return this._playerController.getVolume()},mute:function(){this._playerController.mute()},unmute:function(){this._playerController.unmute()},isMuted:function(){return this._playerController.isMuted()},getContentEntry:function(e){if(!e||!s.isString(e))throw new Error("getContentEntry() requires a content ID");var t=this._cms.getContentId(e);return t?o.xmlToJson(t.getXML()):""},getContentEntryObject:function(e){if(!e||!s.isString(e))throw new Error("getContentEntryObject() requires a content ID");var t=this._cms.getContentId(e);return t?o.xmlToObject(t.getXML()):""},setAdSection:function(e){this._playerController.setAdSection(e)},setAdKeyValue:function(e,t){this._playerController.setAdKeyValue(e,t)},getAdKeyValues:function(){return this._playerController.getAdKeyValues()},clearAdKeyValues:function(){this._playerController.clearAdKeyValues()},setTrackingInterval:function(e){this._trackingManager.setTrackingInterval(e)},setDataSrc:function(e){this._cms.setDataUrl(e)},reportAnalytics:function(e,t){d.send(e,t)},getCurrentPlayer:function(){return this._configData.containerInfo.elementName},_onContentMetadata:function(e){d.send("videoConfig",{cvpElementId:this.getCurrentPlayer(),videoXmlJson:this.getContentEntryObject(e)}),this.eContentMetadata.dispatch.apply(this.eContentMetadata,arguments)},_onContentBegin:function(){this.eContentBegin.dispatch.apply(this.eContentBegin,arguments)},_onContentPlay:function(){this.eContentPlay.dispatch.apply(this.eContentPlay,arguments)},_onContentPause:function(){this.eContentPause.dispatch.apply(this.eContentPause,arguments)},_onContentEnd:function(){this.eContentEnd.dispatch.apply(this.eContentEnd,arguments)},_onContentComplete:function(){this.eContentComplete.dispatch.apply(this.eContentComplete,arguments)},_onContentPlayhead:function(){this.eContentPlayhead.dispatch.apply(this.eContentPlayhead,arguments)},_onContentBuffering:function(){this.eContentBuffering.dispatch.apply(this.eContentBuffering,arguments)},_onContentQueue:function(){this.eContentQueue.dispatch.apply(this.eContentQueue,arguments)},_onContentQueueAutoplay:function(){this.eContentQueueAutoplay.dispatch.apply(this.eContentQueueAutoplay,arguments)},_onContentVolume:function(){this.eContentVolume.dispatch.apply(this.eContentVolume,arguments)},_onContentError:function(e,t){d.send("error",{cvpElementId:this.getCurrentPlayer(),contentId:e,videoContentCount:void 0,errorCode:void 0,errorMessage:t}),this.eContentError.dispatch.apply(this.eContentError,arguments)},_onContentResize:function(){this.eContentResize.dispatch.apply(this.eContentResize,arguments)},_onAdPlayhead:function(){this.eAdPlayhead.dispatch.apply(this.eAdPlayhead,arguments)},_onAdPlay:function(){this.eAdPlay.dispatch.apply(this.eAdPlay,arguments)},_onAdEnd:function(){this.eAdEnd.dispatch.apply(this.eAdEnd,arguments)},_onAdError:function(){this.eAdError.dispatch.apply(this.eAdError,arguments)},_onAdSensitive:function(){this.eAdSensitive.dispatch.apply(this.eAdSensitive,arguments)},_onTrackingAdStart:function(){this.eTrackingAdStart.dispatch.apply(this.eTrackingAdStart,arguments)},_onTrackingAdComplete:function(){this.eTrackingAdComplete.dispatch.apply(this.eTrackingAdComplete,arguments)},_onTrackingAdProgress:function(){this.eTrackingAdProgress.dispatch.apply(this.eTrackingAdProgress,arguments)},_onTrackingAdCountdown:function(){this.eTrackingAdCountdown.dispatch.apply(this.eTrackingAdCountdown,arguments)},_onTrackingAdClick:function(){this.eTrackingAdClick.dispatch.apply(this.eTrackingAdClick,arguments)},_onTrackingContentPlay:function(){this.eTrackingContentPlay.dispatch.apply(this.eTrackingContentPlay,arguments)},_onTrackingContentBegin:function(){this.eTrackingContentBegin.dispatch.apply(this.eTrackingContentBegin,arguments)},_onTrackingContentProgress:function(){this.eTrackingContentProgress.dispatch.apply(this.eTrackingContentProgress,arguments)},_onTrackingContentEnd:function(){this.eTrackingContentEnd.dispatch.apply(this.eTrackingContentEnd,arguments)},_onTrackingContentComplete:function(){this.eTrackingContentComplete.dispatch.apply(this.eTrackingContentComplete,arguments)},_onTrackingContentReplay:function(){this.eTrackingContentReplay.dispatch.apply(this.eTrackingContentReplay,arguments)},_onTrackingContentSeek:function(){this.eTrackingContentSeek.dispatch.apply(this.eTrackingContentSeek,arguments)},_onTrackingContentSeekEnd:function(){this.eTrackingContentSeekEnd.dispatch.apply(this.eTrackingContentSeekEnd,arguments)},_onTrackingFullscreen:function(){this.eTrackingFullscreen.dispatch.apply(this.eTrackingFullscreen,arguments)},_onTrackingMuted:function(){this.eTrackingMuted.dispatch.apply(this.eTrackingMuted,arguments)},_onTrackingPaused:function(){this.eTrackingPaused.dispatch.apply(this.eTrackingPaused,arguments)},_removeLoadingQueueEntry:function(e){delete this._loadingEntryQueue[e]},_onCmsRequestCompleted:function(e,t,n,i,r){_.debug("_onCmsRequestCompleted",arguments);var o=t+"|"+n;if(r)return this.eContentEntryLoadError.dispatch(e,i,r,!1),void this._removeLoadingQueueEntry(o);var a=this._loadingEntryQueue[o],l=this._cms.getContentId(e+"|"+n),c=!1;return s.empty(a)?void _.warn("onCmsRequestCompleted","no entry for key '"+o+"' found in loading queue"):s.empty(l)?(_.error("onCmsRequestCompleted","no catalogEntry for contentId '"+e+"'"),void this._removeLoadingQueueEntry(o)):(_.debug("onCmsRequestCompleted",e,a.play),a.play?(this._playerController.emptyQueue(),this._playerController.play(l,a.additionalParams)):(this._playerController.queue(l,a.additionalParams),c=!0),this._removeLoadingQueueEntry(o),void(""===r&&this.eContentEntryLoad.dispatch(e,c)))},_getNextIndexForId:function(e){var t,n,i,r,s=0;for(t in this._loadingEntryQueue)n=t.split("|"),n&&n.length>1&&(i=n[0],r=+n[1],i===e&&!isNaN(r)&&r>=s&&(s=r+1));return s}});t.exports=m},{"../core/app":10,"../cvp/ajax":12,"../cvp/customevent":17,"../cvp/log":28,"../cvp/util/jsonconverter":46,"../cvp/utils":50,"../vendor/Class":92,"./aspencontroller":60,"./bootstrapper":61,"./cms":62,"./player/instance":85,"./player/videobegetter":87,"./tracking/aspentracking":90,"./tracking/trackingmanager":91}],73:[function(e,t){function n(e,t,n){switch(t){case"adApi":e.apiUrl=n;break;case"adManRootUrl":e.adManRootUrl=n;break;case"adServerRootUrl":e.adServerRootUrl=n;break;case"adVideoRootUrl":e.adVideoRootUrl=n;break;case"adVideoExtension":e.adVideoExtension=n;break;case"additionalVideoSegvars":e.additionalVideoSegVars=n;break;case"additionalSyncSegvars":e.additionalSyncSegVars=n;break;case"adSection":e.adSection=n;break;case"adNetworkId":e.adNetworkId=n;break;case"adVideoNetworkId":e.adVideoNetworkId=n;break;case"adVideoAssetId":e.adVideoAssetId=n;break;case"adPlayerProfile":e.adPlayerProfile=n;break;case"renderersUrl":e.renderersUrl=n;break;case"externalSlots":e.externalSlots=l.isFlagActive(n,e.externalSlots);break;case"adLiveContentDuration":e.liveDuration=n;break;default:e[t]=n}}function i(e,t){t.hasAttributes&&(e.attr||(e.attr={}),a.assignAttributes(e.attr,t.attributes))}function r(e,t){var n=null;switch(t){case"adServer":n=e.ads}return n}function s(e,t){if(!l.isNull(e))for(var o,c,d=e.childNodes,u=0,h=d.length;h>u;++u)c=d[u],o=r(t,c.nodeName),l.isNull(o)?"param"===c.nodeName&&n(t,a.getAttribute(c,"name"),a.getAttribute(c,"value")):(i(o,c),c.childNodes.length&&s(c,o))}var o=e("./generic"),a=e("../../cvp/util/xml"),l=e("../../cvp/utils"),c=e("../shared/playerconfig"),d=o.extend({setAdPolicyContext:function(e){this.adPolicyContextName=e||""},parseData:function(e){var t=l.extend({},c.adPolicy),n=e.documentElement,i=n.getElementsByTagName("default");0!==i.length&&s(i[0],t);for(var r=null,o=n.getElementsByTagName("context"),d=0,u=o.length;u>d;++d)if(a.getAttribute(o[d],"name")===this.adPolicyContextName){r=o[d];break}l.isNull(r)||s(r,t),l.print(t,"adPolicy"),this._fireLoadedSuccess(t)}});t.exports=d},{"../../cvp/util/xml":49,"../../cvp/utils":50,"../shared/playerconfig":89,"./generic":77}],74:[function(e,t){var n=e("./generic"),i=e("../../cvp/request"),r=n.extend({_createRequest:function(e){return i.getJSONP({url:e,jsonpCallback:"cvp_onAppConfigReceived"})},parseData:function(e){var t=e.appConfig;this._fireLoadedSuccess(t)}});t.exports=r},{"../../cvp/request":35,"./generic":77}],75:[function(e,t){function n(e,t,n){switch(t){default:e[t]=n}}function i(e,t){t.hasAttributes&&(e.attr||(e.attr={}),a.assignAttributes(e.attr,t.attributes))}function r(e,t){var n=null;switch(t){case"akamai2":e.akamai2={},n=e.akamai2;break;case"akamaiSpe":e.akamaiSpe={},n=e.akamaiSpe;break;case"tokenAuth":e.token={},n=e.token}return n}function s(e,t){if(!l.isNull(e))for(var o,c,d=e.childNodes,u=0,h=d.length;h>u;++u)c=d[u],o=r(t,c.nodeName),l.isNull(o)?"param"===c.nodeName&&n(t,a.getAttribute(c,"name"),a.getAttribute(c,"value")):(i(o,c),c.childNodes.length&&s(c,o))}var o=e("./generic"),a=e("../../cvp/util/xml"),l=e("../../cvp/utils"),c=e("../shared/playerconfig"),d=o.extend({setPlayerInstance:function(e){this.playerInstanceName=e||""},parseData:function(e){var t=l.extend({},c.configInfo),n=e.documentElement,i=n.getElementsByTagName("default");i.length>0&&s(i[0],t);for(var r=null,o=n.getElementsByTagName("player"),d=null;o.length;)d=o[o.length-1],a.getAttribute(d,"name")===this.playerInstanceName&&(r=d.cloneNode(!0)),n.removeChild(d);l.isNull(r)||s(r,t),l.print(t,"configInfo"),this._fireLoadedSuccess(t)}});t.exports=d},{"../../cvp/util/xml":49,"../../cvp/utils":50,"../shared/playerconfig":89,"./generic":77}],76:[function(e,t){function n(e,t){var n=r.getParamValue(e,"adPolicySrc"),i=r.getParamValue(e,"adPolicyContext"),o=r.getParamValue(e,"trackingPolicySrc"),a=r.getParamValue(e,"trackingPolicyContext");s.empty(n)||(t.adPolicySrc=n),s.empty(i)||(t.adPolicyContext=i),s.empty(o)||(t.trackingPolicySrc=o),s.empty(a)||(t.trackingPolicyContext=a)}var i=e("./generic"),r=e("../../cvp/util/xml"),s=e("../../cvp/utils"),o=e("../shared/playerconfig"),a=i.extend({setParams:function(e){this._params=e},parseData:function(e){var t=0,i=0,a=e.documentElement,l=this._params.context||"",c=this._params.element||"",d=null,u=null,h=[],p=s.extend({},o.containerInfo),g=a.getElementsByTagName("default");if(g.length&&(h=g[0].getElementsByTagName("policies"),h.length&&n(h[0],p)),p.elementName=c,d=a.getElementsByTagName("context"),d.length){for(i=d.length;i>t;++t)if(r.getAttribute(d[t],"name")===l){u=d[t];break}if(u){var f=u.getElementsByTagName("element"),_=null,m=null;for(t=0,i=f.length;i>t;++t)if(_=f[t],r.getAttribute(_,"id")===c){m=_;break}m||(m=f[0]),c=r.getAttribute(m,"id"),h=m.getElementsByTagName("policies"),h.length&&n(h[0],p);var v=m.getElementsByTagName("player"),y=r.getAttribute(v[v.length-1],"playerInstance");s.empty(y)&&(y=l),p.playerInstance=y}s.empty(c)||(p.elementName=c)}s.print(p,"containerInfo"),this._fireLoadedSuccess(p)}});t.exports=a},{"../../cvp/util/xml":49,"../../cvp/utils":50,"../shared/playerconfig":89,"./generic":77}],77:[function(e,t){var n=e("../../vendor/Class"),i=e("../../cvp/customevent"),r=e("../../cvp/utils"),s=e("../../cvp/request"),o=e("../../cvp/log"),a=o.getLogger(),l=n.extend({init:function(){this.onLoaded=r.bind(this.onLoaded,this),this.onLoadError=r.bind(this.onLoadError,this),this.eParseCompleted=new i,this.eParseError=new i},parse:function(e){a.debug("Parser","Loading the file to parse",e),this.load(e)},load:function(e){this._createRequest(e).then(this.onLoaded,this.onLoadError)},_createRequest:function(e){return s.getXML({url:e})},onLoaded:function(e){a.debug("Parser","Data loaded"),this.parseData(e)},onLoadError:function(e){a.error("Parser","onLoadError:",e),this._fireLoadedFailure()},parseData:function(){a.error("Parser","`parseData` requires implementation")},_fireLoadedSuccess:function(){a.debug("Parser","successfully Loaded asset"),this.eParseCompleted.dispatch.apply(this.eParseCompleted,arguments)},_fireLoadedFailure:function(){a.error("Parser","failed to Load asset"),this.eParseError.dispatch.apply(this.eParseError,arguments)}});t.exports=l},{"../../cvp/customevent":17,"../../cvp/log":28,"../../cvp/request":35,"../../cvp/utils":50,"../../vendor/Class":92}],78:[function(e,t){var n=e("./generic"),i=e("../../cvp/utils"),r=e("../../cvp/request"),s=n.extend({_createRequest:function(e){return r.getJSONP({url:e,jsonpCallback:"cvp_onMappingReceived"})},setMappingProfile:function(e){this.profile=e},parseData:function(e){var t,n,r;if(i.undef(e)||i.undef(e.mappings))return void this.eParseError.dispatch();if(n=e.mappings,i.empty(this.profile))return void this.onLoadError(null,"No mapping profile provided","Invalid mapping profile");for(r in n)n[r].profile===this.profile&&(t=n[r]);return i.empty(t)?void this.onLoadError(null,"No mapping profile '"+this.profile+"' found","Invalid mapping profile"):void this._fireLoadedSuccess(t)}});t.exports=s},{"../../cvp/request":35,"../../cvp/utils":50,"./generic":77}],79:[function(e,t){function n(e,t,n){switch(t){case"interval":e.interval=n}}function i(e,t){if(!o.isNull(e))for(var i,r=s.getChildElements(e),a=0,l=r.length;l>a;++a)i=r[a],"param"===i.nodeName&&n(t,s.getAttribute(i,"name"),s.getAttribute(i,"value"))}var r=e("./generic"),s=e("../../cvp/util/xml"),o=e("../../cvp/utils"),a=e("../shared/playerconfig"),l=r.extend({setTrackingPolicyContext:function(e){this.trackingPolicyContextName=e||""},parseData:function(e){var t=o.extend({},a.trackingPolicy),n=e.documentElement,r=n.getElementsByTagName("default");r.length&&i(r[0],t);for(var l,c=null,d=n.getElementsByTagName("context"),u=0,h=d.length;h>u;++u)if(l=d[u],s.getAttribute(l,"name")===this.trackingPolicyContextName){c=l;break}c&&i(c,t),o.print(t,"trackingPolicy"),this._fireLoadedSuccess(t)}});t.exports=l},{"../../cvp/util/xml":49,"../../cvp/utils":50,"../shared/playerconfig":89,"./generic":77}],80:[function(e,t){var n=e("../../vendor/Class"),i=e("../../cvp/customevent"),r=e("../../cvp/utils"),s=e("../../cvp/util/conditionaltask"),o=e("../../cvp/log"),a=o.getLogger(),l=n.extend({init:function(e){if(this._config=e.config,this.options=r.extend({containerElement:"",elementId:"",controls:!0,width:0,height:0},e),this.elementId=this.options.elementId,r.empty(this.elementId))throw a.error("Invalid element id...exiting"),new Error("Invalid element id");this.playerOptions={},this.width=this.options.width,this.height=this.options.height,this.element=null,this._isRendered=!1,this.position={top:null,right:null,bottom:null,left:null},this.eRendered=new i,this.eContentMetadata=new i,this.eContentPlay=new i,this.eContentPause=new i,this.eContentEnd=new i,this.eContentPlayhead=new i,this.eContentBuffering=new i,this.eContentVolume=new i,this.eContentError=new i,this.eContentResize=new i,this.eContentSeek=new i,this.eContentSeekEnd=new i,this.eFullscreenChange=new i,this.eFullscreenError=new i,this.ePlayerMuted=new i,this.ePlayerPaused=new i,this.ePlayerStopped=new i},embed:function(){},render:function(e){if(a.debug("Player","render"),this.containerElement=r.byId(e||this.options.containerElement),r.isNull(this.containerElement))throw a.error("Container element could not be found...cannot render...exiting"),new Error("Container could not be found");var t=this,n=function(){return!r.isNull(r.byId(t.elementId))},i=function(){t._isRendered=!0,t.element=r.byId(t.elementId),t.fireRendered()};if(this.containerElement.hasChildNodes()&&(this.containerElement.innerHTML=""),this.embed(this.containerElement),n())a.info("Player element was found; render immediately."),i();else{a.info("Player element was not found; render eventually.");var o=new s(n,i);o.start()}},rendered:function(){return this._isRendered},show:function(){this.element&&this.position.left&&(this.element.style.left=this.position.left)},hide:function(){this.element&&(this.position.left=this.element.style.left,this.element.style.left="-5000px")},remove:function(){a.debug("Player","remove");var e=this.containerElement;if(r.isNull(e))throw a.error("Container element could not be found .. cannot remove"),new Error("Container element could not be found");for(;e.firstChild;)e.removeChild(e.firstChild);e.parentNode&&e.parentNode.removeChild(e)},dispose:function(){this.removePlayerListeners(),this.remove()},addPlayerListeners:function(){},removePlayerListeners:function(){},fireRendered:function(){this.eRendered.dispatch()},getContentId:function(){return this._catalogEntry?this._catalogEntry.getId():""},firePlay:function(){this.eContentPlay.dispatch(this.getContentId(),"")},fireEnded:function(){this.eContentEnd.dispatch(this.getContentId())}});t.exports=l},{"../../cvp/customevent":17,"../../cvp/log":28,"../../cvp/util/conditionaltask":42,"../../cvp/utils":50,"../../vendor/Class":92}],81:[function(e,t){var n=e("../../vendor/Class"),i=e("../../cvp/static"),r=e("../../cvp/utils"),s=e("../../cvp/util/commandqueue"),o=e("../../cvp/customevent"),a=e("../../cvp/log"),l=e("./videoplayer"),c=e("../ads/adserverproxy"),d=a.getLogger("PlayerController"),u="",h="AD",p="CONTENT",g=0,f=1,_=2,m="play",v="replay",y=0,C=n.extend({init:function(e,t){this._videoBegetter=e,this._autostart="autostart"in t.configInfo?!!t.configInfo.autostart:!1;var n="controls"in t.configInfo?!!t.configInfo.controls:!0;this._commandQ=new s,this._stoppingQ=new s;var i=t.params;this._elementId=i.id,this._videoElement=e.getElement(),e.setControls(n),this._videoPlayer=new l(this._videoElement,{config:t,containerElement:"player_container",elementId:this._elementId,width:i.width,height:i.height,controls:n,autostart:this._autostart}),this._adProxy=new c(t.adPolicy),this._listen(!0),this._state=g,this._listeningForVideoElementActivation=!1,this._listeningForStart=!1,this._currentContentId="",this._contentQueue=[],this._seekTo=0,this._triggeredAd=!1,this._contentStarted=!1,this._fullscreen=!1,this._queueAutoplay=!0,this._metadataFired=!1,this._playEventQueue=[],this.eRendered=new o,this.eFullscreenChange=new o,this.eFullscreenError=new o,this.ePlayerPaused=new o,this.ePlayerMuted=new o,this.ePlayerStopped=new o,this.eContentMetadata=new o,this.eContentBegin=new o,this.eContentPlay=new o,this.eContentPause=new o,this.eContentEnd=new o,this.eContentComplete=new o,this.eContentReplay=new o,this.eContentPlayhead=new o,this.eContentSeek=new o,this.eContentSeekEnd=new o,this.eContentBuffering=new o,this.eContentQueue=new o,this.eContentQueueAutoplay=new o,this.eContentVolume=new o,this.eContentError=new o,this.eContentResize=new o,this.eContentStart=new o,this.eAdPlayhead=new o,this.eAdPlay=new o,this.eAdEnd=new o,this.eAdError=new o,this.eAdSensitive=new o,this.eAdClick=new o},_listen:function(e){if(this._isListening!==e){this._isListening=e;var t=e?"addListener":"removeListener";this._videoPlayer.eRendered[t](this._onRendered,this),this._videoPlayer.eFullscreenChange[t](this._onFullscreenChange,this),this._videoPlayer.eFullscreenError[t](this._onFullscreenError,this),this._videoPlayer.ePlayerPaused[t](this._onPlayerPaused,this),this._videoPlayer.ePlayerMuted[t](this._onPlayerMuted,this),this._videoPlayer.ePlayerStopped[t](this._onPlayerStopped,this),this._videoPlayer.eContentMetadata[t](this._onContentMetadata,this),this._videoPlayer.eContentPlay[t](this._onContentPlay,this),this._videoPlayer.eContentPause[t](this._onContentPause,this),this._videoPlayer.eContentEnd[t](this._onContentEnd,this),this._videoPlayer.eContentPlayhead[t](this._onContentPlayhead,this),this._videoPlayer.eContentSeek[t](this._onContentSeek,this),this._videoPlayer.eContentSeekEnd[t](this._onContentSeeked,this),this._videoPlayer.eContentBuffering[t](this._onContentBuffering,this),this._videoPlayer.eContentVolume[t](this._onContentVolume,this),this._videoPlayer.eContentError[t](this._onContentError,this),this._videoPlayer.eContentResize[t](this._onContentResize,this),this._adProxy.eAdPlayhead[t](this._onAdPlayhead,this),this._adProxy.eAdPlay[t](this._onAdPlay,this),this._adProxy.eAdEnd[t](this._onAdEnd,this),this._adProxy.eAdError[t](this._onAdError,this),this._adProxy.eAdClick[t](this._onAdClick,this),this._adProxy.eAdReady[t](this._onAdReady,this),this._adProxy.eAdStopped[t](this._onPlayerStopped,this)}},render:function(e){this._adProxy.setVideoDisplayBase(e),this._videoPlayer.render(e)},remove:function(){this._videoPlayer.remove()},dispose:function(){d.log("dispose"),this.stop(),this._commandQ.clear(),this._commandQ=null,this._stoppingQ.clear(),this._stoppingQ=null,this._listenForVideoElementActivation(!1),this._listenForStart(!1),this._listen(!1),this._adProxy.dispose(),this._adProxy=null,this._videoPlayer.dispose(),this._videoPlayer=null,this._videoBegetter.dispose(),this._videoBegetter=null},_onRendered:function(e){d.log("_onRendered",e),this._commandQ.execute(),this._commandQ.clear(),this.eRendered.dispatch()},_listenForVideoElementActivation:function(e){if(this._listeningForVideoElementActivation!==e){this._listeningForVideoElementActivation=e;var t=e?"addListener":"removeListener";this._videoBegetter.eActivate[t](this._onVideoElementActivation,this)}},_onVideoElementActivation:function(){switch(d.log("_onVideoElementActivation"),this._listenForVideoElementActivation(!1),this._shimPurpose){case m:this._playMedia();break;case v:this.replay()}},_listenForStart:function(e){if(this._listeningForStart!==e){this._listeningForStart=e;var t=e?"addListener":"removeListener";this._videoPlayer.eContentPlayhead[t](this._onContentStarted,this)}},play:function(e,t){return d.log("play",e.getId()),this._catalogEntry=e,this._playOptions=t,this._state!==g?(this._stoppingQ.clear(),this._stoppingQ.push(this._play,this),void this.stop()):void this._play()},_play:function(){var e=this._catalogEntry;return d.log("_play",e.getId()),this._triggeredAd=!1,this._contentStarted=!1,e.isAdSensitive()&&this._onAdSensitive(e.getId()),this._videoPlayer.rendered()?(this._videoBegetter.setPoster(this._getPosterImageForPlayer()),this._autostart&&this._videoBegetter.isPrimed()?(d.debug("_play","autostart enabled and video element is primed; immediate play"),this._listenForVideoElementActivation(!1),this._playMedia()):(d.debug("_play","video element is NOT primed; deferred play via shim"),this._videoPlayer.removePlayerListeners(),this._shimPurpose=m,this._listenForVideoElementActivation(!0),this._videoBegetter.shim({autostart:this._autostart})),void(this._autostart=!0)):(d.debug("videoPlayer is not rendered; deferring play()"),void this._commandQ.push(this._play,this))},_rewind:function(){var e=this._videoPlayer;e.removePlayerListeners(),e.pause(),this._videoBegetter.setPoster(this._getPosterImageForPlayer()),this._shimPurpose=v,this._listenForVideoElementActivation(!0),this._videoBegetter.shim({autostart:!1});var t=this._videoElement;t.addEventListener("loadedmetadata",function n(){t.removeEventListener("loadedmetadata",n,!1),e.exitFullscreen()},!1),this._state=g},replay:function(){d.log("replay");var e=this._elementId,t=this._catalogEntry;if(!t)return void d.warn("replay","No previous content entry to replay!");var n=this._playOptions,s=t.getId();d.log("request to replay contentId '"+s+"'");var o=i.onCallback(e,["onContentReplayRequest",e,s,n]);return o===!1?(d.debug("user CB canceled replay request"),void this._rewind()):(r.isObject(o)&&(n=o),this.eContentReplay.dispatch(s,n),void this._play())},playNextInQueue:function(){if(!this._contentQueue.length)return void d.warn("playNextInQueue","Content queue is empty!");var e=this._contentQueue.shift();this.eContentQueue.dispatch(this.getQueue()),this.play(e.entry,e.options)},_getPosterImageForPlayer:function(){return this._catalogEntry.getImageForDimensions(this._videoPlayer.getWidth(),this._videoPlayer.getHeight())},_playMedia:function(){d.log("_playMedia"),this._state=_,this._metadataFired=!1,this._onContentBegin(this._catalogEntry.getId()),this._adProxy.isEnabled()?(this._videoPlayer.hideControls(),this._adProxy.loadAds(this._catalogEntry)):this._playContent()},_playContent:function(){d.log("_playContent"),this._listenForStart(!0),this._adProxy.setVideoStatePlaying(),this._playContentTime=r.now(),this._videoPlayer.showControls(),this._videoPlayer.play(this._catalogEntry)},pause:function(){this._videoPlayer.pause()},resume:function(){this._videoPlayer.resume()},reset:function(){d.log("reset"),this.clearRestorePlayhead(),this._listenForVideoElementActivation(!1),this._listenForStart(!1)},stop:function(){this._state!==f&&(this._state=f,this.reset(),this._mediaClass===h?(d.log("stopping ad"),this._adProxy.stop()):this._mediaClass===p?(d.log("stopping content"),this._videoPlayer.stop()):this._onPlayerStopped())},queue:function(e,t){d.debug("queue",e.getId()),this._contentQueue.push({entry:e,options:t}),this.eContentQueue.dispatch(this.getQueue())},dequeue:function(e){for(var t,n=this._contentQueue.length,i=n-1;i>=0;--i)if(t=this._contentQueue[i].entry,t.getId()===e){this._contentQueue.splice(i,1);break}this._contentQueue.length!==n&&this.eContentQueue.dispatch(this.getQueue())},emptyQueue:function(){this._contentQueue.length&&(this._contentQueue.length=0,this.eContentQueue.dispatch(this.getQueue()))},setQueueAutoplay:function(e){this._queueAutoplay=e,this.eContentQueueAutoplay.dispatch(this._queueAutoplay)},getQueue:function(){return r.map(this._contentQueue,function(e){return e.entry.getId()})},seek:function(e){this._contentStarted?(d.log("seeking to "+e+" seconds into the content"),this._videoPlayer.seek(e)):(d.debug("only setting playhead restore point if seek() has been called before content started"),this.setRestorePlayhead(e))},setRestorePlayhead:function(e){d.info("set restore playhead to "+e),this._seekTo=e},clearRestorePlayhead:function(){this._seekTo=0},resize:function(e,t){this._videoPlayer.resize(e,t)},goFullscreen:function(){this._videoPlayer.goFullscreen()},setVolume:function(e){this._videoPlayer.setVolume(e)},getVolume:function(){return this._videoPlayer.getVolume()},mute:function(){this._videoPlayer.mute()},unmute:function(){this._videoPlayer.unmute()},isMuted:function(){this._videoPlayer.isMuted()},setAdSection:function(e){this._adProxy.setAdSection(e)},getAdSection:function(){return this._adProxy.getAdSection()},setAdKeyValue:function(e,t){this._adProxy.setAdKeyValue(e,t)},getAdKeyValue:function(e){return this._adProxy.getAdKeyValue(e)},getAdKeyValues:function(){return this._adProxy.getAdKeyValues()},clearAdKeyValues:function(){this._adProxy.clearAdKeyValues()},getCatalogEntry:function(){return this._catalogEntry},getPlayerDimensions:function(){var e=this._videoPlayer.getDimensions();return this._fullscreen&&r.extend(e,{width:window.screen.width,height:window.screen.height}),e},getAdId:function(){return this._adProxy.currentAdId},getAdType:function(){return this._adProxy.getCurrentAdType()},_onFullscreenChange:function(e){if(d.log("_onFullscreenChange"),this._fullscreen=e,this.eFullscreenChange.dispatch(this._currentContentId,e),this._mediaClass===p){var t=this.getPlayerDimensions();this._onContentResize(t.width,t.height,e)}},_onFullscreenError:function(){d.log("_onFullscreenError"),this.eFullscreenError.dispatch()},_onPlayerPaused:function(e,t,n){d.log("_onPlayerPaused",e,t,n),this.ePlayerPaused.dispatch(e,t,n)},_onPlayerMuted:function(e){d.log("_onPlayerMuted",e),this.ePlayerMuted.dispatch(e)},_onPlayerStopped:function(){d.log("_onPlayerStopped"),this._state=g,this._stoppingQ.execute(),this._stoppingQ.clear()},_onContentMetadata:function(e,t,n,i){d.log("_onContentMetadata",e,t,n,i),this._metadataFired||(this._metadataFired=!0,this.eContentMetadata.dispatch(e,t,n,i)),this._dumpPlayEventQueue()},_onContentBegin:function(e){d.log("_onContentBegin",e),this._currentContentId=e,y=0,this.eContentBegin.dispatch(e,this._playOptions)},_dumpPlayEventQueue:function(){if(this._playEventQueue.length){for(var e=0,t=this._playEventQueue.length;t>e;++e)this._fireContentPlay.apply(this,this._playEventQueue[e]);this._playEventQueue.length=0}},_fireContentPlay:function(e,t){this.eContentPlay.dispatch(e,t)},_onContentPlay:function(e,t){d.log("_onContentPlay",e,t),this._mediaClass=p,this._contentStarted=!1,this._metadataFired?this._fireContentPlay(e,t):this._playEventQueue.push(arguments)},_onContentPause:function(e,t){d.log("_onContentPause",e,t),this.eContentPause.dispatch(e,t),t?this._adProxy.setVideoStatePaused():this._adProxy.setVideoStatePlaying()},_onContentEnd:function(e){d.log("_onContentEnd",e),this._mediaClass=u,this.eContentEnd.dispatch(e),this._adProxy.setVideoStateStopped(),
this._adProxy.isEnabled()?(this._videoPlayer.hideControls(),this._adProxy.playPostroll(this._catalogEntry)):this._onContentComplete.apply(this,arguments)},_continueAutoplay:function(){this._queueAutoplay&&this._contentQueue.length?this.playNextInQueue():this._rewind()},_onContentComplete:function(){d.log("_onContentComplete"),this.eContentComplete.dispatch(this._catalogEntry.getId()),this._videoPlayer.showControls(),this._adProxy.setVideoStateCompleted(),this._continueAutoplay()},_onContentStarted:function(e,t){if(t>0){d.log("_onContentStarted","firing ContentStart because playhead is greater than zero"),this._listenForStart(!1),this._contentStarted=!0;var n=Math.ceil((r.now()-this._playContentTime)/1e3);this._metadataFired||this._dumpPlayEventQueue(),this.eContentStart.dispatch(this._catalogEntry.getId(),n),this._seekAhead()}else d.log("_onContentStarted","playhead still at zero")},_seekAhead:function(){this._seekTo&&(d.info("restoring playhead to "+this._seekTo),this.seek(this._seekTo),this.clearRestorePlayhead())},_onContentPlayhead:function(e,t,n){this._currentContentPlayhead=t,this.eContentPlayhead.dispatch(e,t,n,-1)},_onAdReady:function(){d.log("_onAdReady"),this._midrollMap=this._adProxy.getMidrolls(),r.isSimpleObject(this._midrollMap)&&!r.isEmpty(this._midrollMap)&&(d.log("_onAdReady - midrolls: ",r.keys(this._midrollMap)),this._videoPlayer.eContentPlayhead.addListener(this._onPlayheadForMidrolls,this))},_onPlayheadForMidrolls:function(e,t){var n=Math.floor(t);n in this._midrollMap&&(d.log("_onPlayheadForMidrolls","playing midroll at "+n+" of midrolls: ",r.keys(this._midrollMap)),this.setRestorePlayhead(t),this._currentMidroll=this._midrollMap[n],delete this._midrollMap[n],this._playMidroll(this._currentMidroll))},_playMidroll:function(e){d.log("_playMidroll"),this._adProxy.setVideoStatePaused(),this._adProxy.playMidroll(e)},_resumeFromMidroll:function(){d.log("_resumeFromMidroll"),this._playContent()},_onContentSeek:function(e,t,n,i){d.log("_onContentSeek",e,t,n,i),this.eContentSeek.dispatch(e,t,n,i)},_onContentSeeked:function(e,t,n,i){d.log("_onContentSeeked",e,t,n,i),this.eContentSeekEnd.dispatch(e,t,n,i)},_onContentBuffering:function(e,t){d.log("_onContentBuffering"),this.eContentBuffering.dispatch(e,t)},_onContentVolume:function(e,t){d.log("_onContentVolume"),this.eContentVolume.dispatch(e,t)},_onContentError:function(e,t){d.log("_onContentError",e,t),this.eContentError.dispatch(e,t),this._continueAutoplay()},_onContentResize:function(e,t,n){d.log("_onContentResize",e,t,n),this.eContentResize.dispatch(e,t,n)},_onAdSensitive:function(e){d.debug("_onAdSensitive",e),this.eAdSensitive.dispatch(e)},_onAdPlayhead:function(e,t){this._currentAdPlayhead=e,this._currentAdDuration=t,this.eAdPlayhead.dispatch(e,t,y)},_onAdPlay:function(e){var t=e.token,n=e.mode,i=e.id,r=e.duration,s=e.adType,o=e.adAnalyticsData;d.debug("_onAdPlay","event",e),this._triggeredAd=!0,this._contentStarted=!1,this._mediaClass=h,this._videoPlayer.removePlayerListeners(),this.eAdPlay.dispatch(t,n,i,r,y,s,o)},_onAdEnd:function(e){var t=e.token,n=e.mode,i=e.id,r=e.adType;d.debug("_onAdEnd","event",e),this._triggeredAd&&this.eAdEnd.dispatch(t,n,i,y,r),this._onAdComplete(r)},_onAdError:function(e){var t=e.adType,n=e.errors,i=e.errorMessage;d.debug("_onAdError","event",e),this.eAdError.dispatch(i,y,t,n),this._onAdComplete(t)},_onAdComplete:function(e){if(y+=1,this._triggeredAd=!1,this._mediaClass=u,this._state===f)return d.debug("_onAdComplete","halting further activities because stop() was called, resetting video player"),void this._videoPlayer.reset();switch(e){case c.PREROLL:this._playContent();break;case c.MIDROLL:this._resumeFromMidroll();break;case c.POSTROLL:this._onContentComplete(this._currentContentId);break;default:this._onContentError("Failed to determine adType!")}},_onAdClick:function(e){this.eAdClick.dispatch(e.url),this._videoPlayer.showControls()}});t.exports=C},{"../../cvp/customevent":17,"../../cvp/log":28,"../../cvp/static":37,"../../cvp/util/commandqueue":41,"../../cvp/utils":50,"../../vendor/Class":92,"../ads/adserverproxy":53,"./videoplayer":88}],82:[function(e,t){var n=e("../../vendor/Class"),i=e("../../cvp/utils"),r=n.extend({init:function(e,t,n,r){if(!(e||t||n))throw new Error("Usage: new DOMEventHandler(element, events, listener, capture).once().while(fn).until(fn)");return this._enabled=!1,this._element=e,this._events=i.isArray(t)?t:t.split(/\W+/),this._listener=n,this._capture=r||!1,this._once=!1,this._precondition=null,this._postcondition=null,this.listener=i.bind(this.listener,this),this.addListener=i.bind(this.addListener,this),this.removeListener=i.bind(this.removeListener,this),this},dispose:function(){this.off(),this._element=null,this._events=null,this._listener=null,this._precondition=null,this._postcondition=null},listener:function(){return this._precondition&&!this._precondition()?void this.off():(this._once&&this.off(),this._listener.apply(this._element,arguments),void(this._postcondition&&!this._postcondition()&&this.off()))},addListener:function(e){this._element.addEventListener(e,this.listener,this._capture)},removeListener:function(e){this._element.removeEventListener(e,this.listener,this._capture)},once:function(){return this._once=!0,this},every:function(){return this._once=!1,this},"while":function(e){return i.isFunction(e)&&(this._precondition=e),this},until:function(e){return i.isFunction(e)&&(this._postcondition=e),this},off:function(){this._enabled&&(this._enabled=!1,i.each(this._events,this.removeListener))},on:function(){!this._enabled&&this._element&&(this._enabled=!0,i.each(this._events,this.addListener))}});t.exports=r},{"../../cvp/utils":50,"../../vendor/Class":92}],83:[function(e,t){var n=e("../../vendor/Class"),i=e("../../cvp/utils"),r=e("../../cvp/util/configutils"),s=e("../../cvp/browser"),o=e("../../cvp/util/jsonconverter"),a=e("../../cvp/log"),l=a.getLogger("FileSelection"),c=function(e){return e=e||{},e.hasOwnProperty("key")?e.key:e.hasOwnProperty("bitrate")?e.bitrate:void 0},d=function(e){var t=c(e);return f.availableFiles.hasOwnProperty(t)?f.availableFiles[t].ext:""},u=function(e,t){return function(n){return n.hasOwnProperty(e)?n[e]===t:!1}},h=function(e,t){return function(n){return n&&n.hasOwnProperty(e)?n[e]:t}},p=h("url",""),g=h("text",""),f={config:{},supportedFileTypes:[],selectedFileKeys:[],fallbackFileTypes:["m3u8","mp4"],availableFiles:{},availableFileKeys:[],availableFileUrls:[],contentEntryObj:{},contentEntryFiles:[]},_=n.extend({canExecute:function(){var e=f.config.params;return e.hasOwnProperty("fileSelection")||e.hasOwnProperty("perVideoFallbacks")},execute:function(e){var t,n=f.config.params;return n.hasOwnProperty("fileSelection")?t=this._getPageFileSelection(e):n.hasOwnProperty("perVideoFallbacks")&&(t=this._getFileByParameterFallback(e)),i.isString(t)&&(t=[t]),i.isArray(t)&&(i.each(t,function(e){-1===i.indexOf(f.availableFileUrls,e)&&l.warn("Potentially invalid url: "+e)}),t=i.map(t,function(t){return e.sanitizeUrl(t)})),t},_getPageFileSelection:function(){l.debug("Using page selection via 'fileSelection'");var e=f.config.params.fileSelection||null;if(!e)return!1;var t={_makeList:function(e){return i.isString(e)&&(e=e.split(",")),i.isArray(e)?e.map(function(e){return i.trim(e)}):[]},filterBy:function(e,t,n){var r=i.isFunc(t)?t:u(t,n);return i.filter(e,r)},filterByDimension:function(e,t,n){return this.filterBy(e,function(e){return e.width===t&&e.height===n})},filterByKey:function(e,t){return t=this._makeList(t),this.filterBy(e,function(e){return i.indexOf(t,c(e))>-1})},filterByExtension:function(e,t){return t=this._makeList(t),this.filterBy(e,function(e){return i.indexOf(t,d(e))>-1})}},n=e.call(t,f.contentEntryFiles,f.contentEntryObj);return i.isArray(n)?n.map(g):n},_getFileByParameterFallback:function(e){l.debug("Using page selection via 'perVideoFallbacks'");var t=f.config.params.perVideoFallbacks||[];if(!t)return!1;for(var n,i,s=0,o=t.length;o>s;++s)if(n=t[s],i=r.stringReplace(n.criteria,e,!1),n.evaluate(i))return r.stringReplace(n.filter,e,!1);return null}}),m=n.extend({canExecute:function(){return!0},execute:function(e){var t=[];if(f.selectedFileKeys.length||f.supportedFileTypes.length){l.debug("Using config file key selection: "+f.selectedFileKeys),l.debug("Using config file type selection: "+f.supportedFileTypes);var n=e.getContentUrlsByFileKeys(f.selectedFileKeys),i=e.getContentUrlsByExtensions(f.supportedFileTypes);l.debug("fileKeyUrls:",n),l.debug("fileTypeUrls:",i),n&&n.length&&t.push.apply(t,n),i&&i.length&&t.push.apply(t,i)}else{l.debug("Using config legacy selection");var r=this._getFileByFallback(e),s=this._getFileByConfigFallbackParam(e),o=e.getContentUrlsByExtensions(f.fallbackFileTypes);l.debug("iOSFallbackUrl:",r),l.debug("configFallbackUrl:",s),l.debug("defaultUrls:",o),r&&t.push(r),s&&t.push(s),o&&o.length&&t.push.apply(t,o)}return t},_getFileByConfigFallbackParam:function(e){var t=f.config.configInfo.fallbackFilenameIOS;return i.empty(t)?t:t=r.stringReplace(t,e,!1)},_getFileByFallback:function(e){return s.isOS(s.IOS)?e.getContentUrlFromFallback("iOS"):void 0}}),v=n.extend({init:function(e){f.config=e;var t=/\W+/,n=f.config.configInfo;f.supportedFileTypes=i.uniq(i.filter(n.html5Types.split(t))),f.selectedFileKeys=i.uniq(i.filter(n.html5Order.split(t))),this._pageSelection=new _,this._configSelection=new m},getDefaultPlaylistForEntry:function(e){return e.getContentUrlsByExtensions(f.fallbackFileTypes)},getPlaylistForEntry:function(e){this._setState(e);var t=[],n=this._pageSelection.canExecute(),r=null,s=this._configSelection.canExecute(),o=null;return n&&(r=this._pageSelection.execute(e)),n&&i.isArray(r)?t=t.concat(r):n&&r!==!0&&null!==r&&void 0!==r||s&&(o=this._configSelection.execute(e),i.isArray(o)&&(t=t.concat(o))),t=i.uniq(i.filter(t))},_setState:function(e){f.availableFiles=e.getAllFiles(),f.availableFileKeys=i.keys(f.availableFiles),f.availableFileUrls=i.map(f.availableFileKeys,function(e,t,n){return p(f.availableFiles[e],t,n)});var t=o.xmlToObject(e.getXML());f.contentEntryObj=t;var n=[];i.filter(t.files,function(e){var t=e.file,i=c(t);f.availableFiles.hasOwnProperty(i)&&t.text===f.availableFiles[i].url&&n.push(t)}),f.contentEntryFiles=n}});t.exports=v},{"../../cvp/browser":14,"../../cvp/log":28,"../../cvp/util/configutils":43,"../../cvp/util/jsonconverter":46,"../../cvp/utils":50,"../../vendor/Class":92}],84:[function(e,t){function n(){this._isFullscreen=!1,this._onW3FullscreenChangeBind=i.bind(this._onW3FullscreenChange,this),this._onWebKitFullscreenChangeBind=i.bind(this._onWebKitFullscreenChange,this),this._onMozFullscreenChangeBind=i.bind(this._onMozFullscreenChange,this),this._onWebKitBeginFullscreenBind=i.bind(this._onWebKitBeginFullscreen,this),this._onWebKitEndFullscreenBind=i.bind(this._onWebKitEndFullscreen,this),this._onW3FullscreenErrorBind=i.bind(this._onW3FullscreenError,this),this._onWebKitFullscreenErrorBind=i.bind(this._onWebKitFullscreenError,this),this._onMozFullscreenErrorBind=i.bind(this._onMozFullscreenError,this),this.emitFullscreenChange=i.bind(this.emitFullscreenChange,this),this.emitFullscreenError=i.bind(this.emitFullscreenError,this),this.onFullscreenChange=new s("fullscreenChange"),this.onFullscreenError=new s("fullscreenError")}var i=e("../../cvp/utils"),r=e("../../cvp/log"),s=e("../../cvp/customevent"),o=r.getLogger("FullscreenMonitor");n.prototype={setup:function(e){o.log("setup"),e&&!this.player&&(this.player=e,this._listen(!0))},teardown:function(){o.log("teardown"),this.player&&this._listen(!1)},dispose:function(){this.teardown(),this.player=null},_listen:function(e){if(this._isListening!==e){this._isListening=e;var t=e?"addEventListener":"removeEventListener",n=this.player.getPlayerElement();n[t]("webkitbeginfullscreen",this._onWebKitBeginFullscreenBind,!1),n[t]("webkitendfullscreen",this._onWebKitEndFullscreenBind,!1),document[t]("fullscreenchange",this._onW3FullscreenChangeBind,!1),document[t]("webkitfullscreenchange",this._onWebKitFullscreenChangeBind,!1),document[t]("mozfullscreenchange",this._onMozFullscreenChangeBind,!1),document[t]("fullscreenerror",this._onW3FullscreenErrorBind,!1),document[t]("webkitfullscreenerror",this._onWebKitFullscreenErrorBind,!1),document[t]("mozfullscreenerror",this._onMozFullscreenErrorBind,!1)}},_handleFullscreenChange:function(e,t){(!e||e&&t===this.player.getPlayerElement())&&e!==this._isFullscreen&&(this._isFullscreen=e,this.emitFullscreenChange(this._isFullscreen,t))},_onW3FullscreenChange:function(){var e=document.fullscreenElement,t=!(!document.fullscreenEnabled&&!document.fullscreen&&!e);o.debug("_onW3FullscreenChange",t,e),this._handleFullscreenChange(t,e)},_onWebKitFullscreenChange:function(){var e=document.webkitFullscreenElement,t=!!document.webkitIsFullScreen||!!e;o.debug("_onWebKitFullscreenChange",t,e),this._handleFullscreenChange(t,e)},_onMozFullscreenChange:function(){var e=document.mozFullScreenElement,t=!(!document.mozFullScreen&&!document.fullScreen&&!e);o.debug("_onMozFullscreenChange",t,e),this._handleFullscreenChange(t,e)},_onWebKitBeginFullscreen:function(){var e=this.player.getPlayerElement(),t=!0;o.debug("_onWebKitBeginFullscreen",t,e),this._handleFullscreenChange(t,e)},_onWebKitEndFullscreen:function(){var e=null,t=!1;o.debug("_onWebKitEndFullscreen",t,e),this._handleFullscreenChange(t,e)},_handleFullscreenError:function(){o.log("_onFullscreenError"),this.emitFullscreenError()},_onW3FullscreenError:function(){o.log("_onW3FullscreenError"),this._handleFullscreenError()},_onWebKitFullscreenError:function(){o.log("_onWebKitFullscreenError"),this._handleFullscreenError()},_onMozFullscreenError:function(){o.log("_onMozFullscreenError"),this._handleFullscreenError()},emitFullscreenChange:function(e,t){o.log("emitFullscreenChange"),this.onFullscreenChange.dispatch(e,t)},emitFullscreenError:function(){o.log("emitFullscreenError"),this.onFullscreenError.dispatch()}},t.exports=n},{"../../cvp/customevent":17,"../../cvp/log":28,"../../cvp/utils":50}],85:[function(e,t){var n=e("../shared/playerconfig"),i=e("../../cvp/utils"),r=e("./controller"),s=function(e,t){var s=i.extend({},n);return i.extend(s.params,t.params),i.extend(s,t.configData),new r(e,s)};t.exports=s},{"../../cvp/utils":50,"../shared/playerconfig":89,"./controller":81}],86:[function(e,t){function n(e){return e instanceof p&&"code"in e}function i(e){var t=e.code,n=t===p.MEDIA_ERR_SRC_NOT_SUPPORTED,i=t===p.MEDIA_ERR_ABORTED;if(i)try{e.code=p.MEDIA_ERR_SRC_NOT_SUPPORTED}catch(r){c.debug("Failed to set error.code.  That's fine, I didn't want to do it anyway.")}return n||i}var r=e("../../vendor/Class"),s=e("../../cvp/customevent"),o=e("../../cvp/utils"),a=e("../../cvp/log"),l=e("../../cvp/util/timing"),c=a.getLogger("PilotEpisode"),d=2e4,u=5e3,h="loadstart progress suspend abort error emptied stalled loadedmetadata loadeddata canplay canplaythrough playing waiting seeking seeked ended durationchange timeupdate play pause ratechange resize volumechange".split(" "),p=window.MediaError||function(){},g=r.extend({init:function(e){this._started=!1,this._addedListeners=!1,this._player=e,this._player.eRendered.addListener(this._onPlayerRendered,this),this.onBuffering=new s,this.onConcluded=new s,this._pilotEvents=[],this._onPilotEvent=o.bind(this._onPilotEvent,this),this._onPilotTimeout=o.bind(this._onPilotTimeout,this),this._pilotTimer=l.eventually(this._onPilotTimeout,u),this._addEventListener=o.bind(this.addEventListener,this),this._removeEventListener=o.bind(this.removeEventListener,this)},_onPlayerRendered:function(){this._element=this._player.getVideoElement()},addEventListener:function(e,t){this._element.addEventListener(e,t,!1)},removeEventListener:function(e,t){this._element.removeEventListener(e,t,!1)},_queuePilotEvent:function(e){this._pilotEvents.push(e),c.log("queued pilot events: ",this._pilotEvents.length)},_clearPilotEvents:function(){c.log("clearing queued Pilot events"),this._pilotEvents.length=0},_dispatchPilotEvent:function(e){c.log("dispatching Pilot event '"+e.type+"'"),this._element.dispatchEvent(e)},_dispatchPilotEvents:function(){var e=this._pilotEvents,t=e.length;if(c.log("_dispatchPilotEvents","queue length = "+t),t){for(var n=t-1,i=0;n>i;++i)this._dispatchPilotEvent(e[i]);window.setTimeout(o.bind(this._dispatchPilotEvent,this,e[n]),0),this._clearPilotEvents()}},_onPilotEvent:function(e){c.log("_onPilotEvent",e.type);var t=e.target;switch(e.type){case"loadedmetadata":case"playing":this._queuePilotEvent(e),this._concludePilot();break;case"error":t&&n(t.error)&&i(t.error)&&(this._queuePilotEvent(e),this._next());break;case"waiting":this._pilotBuffering||(this._pilotBuffering=!0,this.onBuffering.dispatch()),this._startPilotTimer();break;case"progress":case"suspend":case"stalled":this._startPilotTimer();break;default:this._queuePilotEvent(e)}},_addPilotListener:function(e){this._addEventListener(e,this._onPilotEvent)},_addPilotListeners:function(){return this._addedListeners?void c.log("_addPilotListeners","already listening to events!"):(c.log("_addPilotListeners",h),this._element?(o.each(h,this._addPilotListener,this),void(this._addedListeners=!0)):(c.error("_addPilotListeners","reference to video element was not fulfilled"),void this._concludePilot()))},_removePilotListener:function(e){this._removeEventListener(e,this._onPilotEvent)},_removePilotListeners:function(){return this._addedListeners?(c.log("_removePilotListeners",h),o.each(h,this._removePilotListener,this),void(this._addedListeners=!1)):void c.log("_removePilotListeners","already NOT listening to events!")},_stopPilotTimer:function(){c.log("_stopPilotTimer"),this._pilotTimer.stop()},_hasExceededAttemptMaxDuration:function(){var e=o.now()-this._pilotAttemptStart;return e>u},_startPilotTimer:function(){c.log("_startPilotTimer"),this._pilotTimer.start()},_onPilotTimeout:function(){c.log("_onPilotTimeout"),this._hasPilotCompleted||this._next()},_concludePilot:function(){return this._hasPilotCompleted?void c.log("_concludePilot","already concluded!"):(c.log("_concludePilot"),this._hasPilotCompleted=!0,void this._transitionBackToPlayer())},_teardownPilot:function(){this._stopPilotTimer(),this._removePilotListeners()},_transitionBackToPlayer:function(){this._teardownPilot(),this.onConcluded.dispatch(),this._dispatchPilotEvents(),this.stop()},_hasExceededSessionMaxDuration:function(){var e=o.now()-this._pilotSessionStart;return e>d},_next:function(){if(!this._playlist.length)return c.debug("_next","no more video URLs to try"),void this._concludePilot();if(this._hasExceededSessionMaxDuration())return c.debug("_next","the pilot session has exceeded the maximum allowed duration"),void this._concludePilot();var e=this._playlist.shift();c.debug("_next","attempting to play '"+e+"'"),this._clearPilotEvents(),this._pilotAttemptStart=o.now(),this._startPilotTimer(),this._playUrl(e)},_playUrl:function(e){c.log("playing URL '"+e+"'");var t=this._element;t.src=e,t.load(),t.play()},_setupPilot:function(){this._pilotBuffering=!1,this._hasPilotCompleted=!1,this._player.removePlayerListeners(),this._addPilotListeners()},start:function(e){this._started&&this.stop(),c.log("start"),this._started=!0,this._pilotSessionStart=o.now(),this._playlist=e,this._setupPilot(),this._next()},stop:function(){this._started&&(c.log("stop"),this._started=!1,this._teardownPilot(),this._clearPilotEvents())},dispose:function(){c.log("dispose"),this.stop(),this._element=null,this._player=null,this._pilotTimer=null}});t.exports=g},{"../../cvp/customevent":17,"../../cvp/log":28,"../../cvp/util/timing":48,"../../cvp/utils":50,"../../vendor/Class":92}],87:[function(e,t){var n=e("../../vendor/Class"),i=e("../../cvp/customevent"),r=e("../../cvp/log"),s=e("../../core/app"),o=e("../../cvp/utils"),a=r.getLogger("VideoBegetter"),l=["click","play"],c=n.extend({init:function(){a.log("init"),this._listening=!1,this._primed=!1,this._showControls=!0,this._videoElement=document.createElement("video"),this._onActivation=o.bind(this._onActivation,this),this.eActivate=new i},dispose:function(){a.log("dispose"),this.teardown(),this._videoElement=null},getElement:function(){return this._videoElement},isPrimed:function(){return this._primed},listen:function(e){if(e!==this._listening){a.log("listen",e),this._listening=e;for(var t=e?"addEventListener":"removeEventListener",n=0,i=l.length;i>n;++n)this._videoElement[t](l[n],this._onActivation,!0)}},setPoster:function(e){a.log('setPoster(url="'+e+'")');var t=this._videoElement;t.poster=s.BLANK_IMG_URL,null!=e&&(t.poster=e)},setControls:function(e){a.log('setControls(preferred="'+e+'")'),this._showControls=e,e||this.hideControls()},showControls:function(){return this._videoElement?this._showControls?(a.log("showControls","showing controls"),void(this._videoElement.controls=!0)):void a.log("showControls","disallowed by configuration"):void a.warn("showControls","no video element")},hideControls:function(){return this._videoElement?(a.log("hideControls","hiding controls"),void(this._videoElement.controls=!1)):void a.warn("hideControls","no video element")},prime:function(){if(a.log("prime"),this.isPrimed())return void this.listen(!1);this.listen(!0);var e=this._videoElement;this.showControls(),e.removeAttribute("src"),e.load()},shim:function(e){var t=o.extend({},e);a.log("shim",t),this.listen(!0);var n=this._videoElement;this.showControls(),n.removeAttribute("src"),n.src=s.BLANK_MP4_URL,null!=t.poster&&this.setPoster(t.poster),t.autostart&&(n.load(),n.play())},teardown:function(){a.log("teardown"),this.listen(!1)},_onFirstActivation:function(){a.log("_onFirstActivation"),this._primed||(this._primed=!0,this._videoElement.preload="metadata")},_onActivation:function(){a.log("_onActivation"),this.listen(!1),this.isPrimed()||this._onFirstActivation(),this.eActivate.dispatch()}});t.exports=c},{"../../core/app":10,"../../cvp/customevent":17,"../../cvp/log":28,"../../cvp/utils":50,"../../vendor/Class":92}],88:[function(e,t){function n(e){var t=e instanceof _&&!h.isEmpty(e);return t||(f.debug("error instanceof MediaError: ",e instanceof _),f.debug("error.code:",e.code),f.debug("Utils.hasOwn(error, 'code'):",h.hasOwn(e,"code"))),t}function i(e){switch(e.code){case _.MEDIA_ERR_ABORTED:return u.MEDIA_ERR_ABORTED;case _.MEDIA_ERR_NETWORK:return u.MEDIA_ERR_NETWORK;case _.MEDIA_ERR_DECODE:return u.MEDIA_ERR_DECODE;case _.MEDIA_ERR_SRC_NOT_SUPPORTED:return u.MEDIA_ERR_SRC_NOT_SUPPORTED}return u.MEDIA_ERR_UNKNOWN}var r=e("./baseplayer"),s=e("./pilotepisode"),o=e("./fileselection"),a=e("./fullscreenmonitor"),l=e("./domeventhandler"),c=e("../../core/app"),d=e("../../cvp/browser"),u=e("../../cvp/static"),h=e("../../cvp/utils"),p=e("../../cvp/log"),g=e("../../cvp/util/timing"),f=p.getLogger("VideoPlayer"),_=window.MediaError||function(){},m=r.extend({init:function(e,t){f.log("init"),this._videoElement=e,this._super(t);var n=this._config.configInfo.iosAirplay;d.isOS(d.IOS)&&!h.undef(n)&&(this.playerOptions["x-webkit-airplay"]=n),this.playerOptions.controls=this.options.controls,this._playlist=[],this._addedListeners=!1,this._muted=!1,this._fullscreen=!1,this.updatePlayhead=h.throttle(this.firePlayhead,250,{leading:!0,trailing:!1}),this.fireSeek=h.throttle(this.fireSeek,250,{leading:!0,trailing:!1}),this.fireSeekEnd=h.bind(this.fireSeekEnd,this),this._seekEndTimer=g.eventually(this.fireSeekEnd,1e3),this._pilotEpisode=new s(this),this._pilotEpisode.onBuffering.addListener(this._onContentBuffering,this),this._pilotEpisode.onConcluded.addListener(this._onPilotConcluded,this),this._fileSelectionHandler=new o(this._config),this._fullscreenMonitor=new a,this.eRendered.addListener(this.onRender,this),this._eventListeners={loadeddata:h.bind(this._onLoadedData,this),play:h.bind(this._onContentPlay,this),ended:h.bind(this._onContentEnd,this),playing:h.bind(this._onContentPlaying,this),pause:h.bind(this._onContentPause,this),timeupdate:h.bind(this._onContentPlayhead,this),error:h.bind(this._onContentError,this),seeking:h.bind(this._onContentSeeking,this),seeked:h.bind(this._onContentSeeked,this),stalled:h.bind(this._onContentBuffering,this),waiting:h.bind(this._onContentBuffering,this),canplay:h.bind(this._onContentBuffered,this),volumechange:h.bind(this._onContentVolume,this)},this._addEventListener=h.bind(this.addEventListener,this),this._removeEventListener=h.bind(this.removeEventListener,this),this._manuallyCallEnded=h.bind(this._manuallyCallEnded,this),this._playIfPlayerIsPaused=h.bind(this._playIfPlayerIsPaused,this),this._ensureLoadedMetaDataFiresOnce=h.bind(this._ensureLoadedMetaDataFiresOnce,this),this._endedWatch=g.eventually(this._manuallyCallEnded,1e3)},_setupEnsurePlayWhenAbleHandler:function(){this._ensurePlayWhenAbleHandler||(this._ensurePlayWhenAbleHandler=new l(this.element,"canplay",this._playIfPlayerIsPaused,!0).once())},_disposeEnsurePlayWhenAbleHandler:function(){this._ensurePlayWhenAbleHandler&&(this._ensurePlayWhenAbleHandler.dispose(),this._ensurePlayWhenAbleHandler=null)},_setupEnsureLoadedMetaDataHandler:function(){this._ensureLoadedMetaDataHandler||(this._ensureLoadedMetaDataHandler=new l(this.element,"loadedmetadata loadeddata playing",this._ensureLoadedMetaDataFiresOnce,!0).once())},_disposeEnsureLoadedMetaDataHandler:function(){this._ensureLoadedMetaDataHandler&&(this._ensureLoadedMetaDataHandler.dispose(),this._ensureLoadedMetaDataHandler=null)},_disposeEndedWatch:function(){this._endedWatch.stop(),this._endedWatch=null},_setupFullscreenMonitor:function(){this._fullscreenMonitor.setup(this),this._fullscreenMonitor.onFullscreenChange.addListener(this._onFullscreenChange,this),this._fullscreenMonitor.onFullscreenError.addListener(this._onFullscreenError,this)},_teardownFullscreenMonitor:function(){this._fullscreenMonitor&&(this._fullscreenMonitor.onFullscreenChange.removeListener(this._onFullscreenChange,this),this._fullscreenMonitor.onFullscreenError.removeListener(this._onFullscreenError,this),this._fullscreenMonitor.teardown())},_disposeFullscreenMonitor:function(){this._fullscreenMonitor&&(this._teardownFullscreenMonitor(),this._fullscreenMonitor.dispose(),this._fullscreenMonitor=null)},addEventListener:function(e,t){this.element.addEventListener(e,t,!1)},removeEventListener:function(e,t){this.element.removeEventListener(e,t,!1)},showControls:function(){return this.element?this.playerOptions.controls?(f.log("showControls","showing controls"),void(this.element.controls=!0)):void f.log("showControls","disallowed by configuration"):void f.warn("showControls","no video element")},hideControls:function(){return this.element?(f.log("hideControls","hiding controls"),void(this.element.controls=!1)):void f.warn("hideControls","no video element")},getPlayerElement:function(){return this.element},getVideoElement:function(){return this.element},getPlaybackRate:function(){return this.element&&this.element.playbackRate||1},getCurrentSrc:function(){return this.element&&this.element.currentSrc},getCurrentTime:function(){return this.element&&this.element.currentTime||0},getDuration:function(){return this.element&&this.element.duration||this._catalogEntry&&this._catalogEntry.getTrt()||0},dispose:function(){this.eRendered.removeListener(this.onRender,this),this._seekEndTimer.stop(),this._seekEndTimer=null,this._disposeFullscreenMonitor(),this._disposeEnsurePlayWhenAbleHandler(),this._disposeEnsureLoadedMetaDataHandler(),this._disposeEndedWatch(),this._pilotEpisode.onBuffering.removeListener(this._onContentBuffering,this),this._pilotEpisode.onConcluded.removeListener(this._onPilotConcluded,this),this.reset(),this._pilotEpisode.dispose(),this._pilotEpisode=null,this.remove(),this._videoElement=null,this.element=null},onRender:function(){this._setupEnsurePlayWhenAbleHandler(),this._setupEnsureLoadedMetaDataHandler(),this._setupFullscreenMonitor();var e=this._config.configInfo;e.volume&&this.setVolume(e.volume),e.muted&&this.mute()},firePause:function(){var e=this.getCurrentTime();this.ePlayerPaused.dispatch(this.getContentId(),this.getCurrentTime(),this._paused),this.eContentPause.dispatch(this.getContentId(),this._paused),this._lastPlayhead=e},fireBuffering:function(){this.eContentBuffering.dispatch(this.getContentId(),this._buffering)},fireMetadata:function(){this.eContentMetadata.dispatch(this.getContentId(),this.getDuration(),this.element.videoWidth,this.element.videoHeight)},firePlayhead:function(){var e=this.getCurrentTime();this.eContentPlayhead.dispatch(this.getContentId(),e,this.getDuration(),-1),this._lastPlayhead=e},fireSeek:function(){var e=this.getCurrentTime();this._seeking=!0,this.eContentSeek.dispatch(this.getContentId(),this._lastPlayhead,e,this.getDuration()),this._lastPlayhead=e},fireSeekEnd:function(){if(this._seeking){var e=this.getCurrentTime();this._seeking=!1,this._seekEndTimer.stop(),this.eContentSeekEnd.dispatch(this.getContentId(),this._timeAtSeekBegin,e,this.getDuration()),this._lastPlayhead=e}},_getCSSDimensionValue:function(e){var t=/^\d+$/;return t.test(e)?e+"px":e},_setCSSDimension:function(e,t,n){e.style[t]=this._getCSSDimensionValue(n)},_setWidth:function(e,t){this.width=t,this._setCSSDimension(e,"width",t)},_setHeight:function(e,t){this.height=t,this._setCSSDimension(e,"height",t)},embed:function(e){return this._videoElement.id=this.elementId,this._setWidth(this._videoElement,this.width),this._setHeight(this._videoElement,this.height),this._videoElement.preload="none",this._videoElement.controls=this.playerOptions.controls,this._setWidth(e,this.width),this._setHeight(e,this.height),e.appendChild(this._videoElement),this._videoElement.parentNode===e?(this._videoElement=null,!0):!1},_onPilotConcluded:function(){var e=this.element.currentSrc;f.log("_onPilotConcluded",e),this._currentSrc=e,this.setDefaultOptions(),this.addPlayerListeners()},_resetPlayerStatesForPlayStart:function(){f.log("_resetPlayerStatesForPlayStart"),this._playlist.length=0,this._lastPlayhead=0,this._metadataEmitted=!1,this._playEmitted=!1,this._stopped=!1,this._paused=!1,this._buffering=!1,this._seeking=!1},play:function(e){f.log("play");var t=this._catalogEntry,n=this._currentSrc,i=this._catalogEntry=e||t;if(this._resetPlayerStatesForPlayStart(),i!==t||!n)switch(this._currentSrc=null,this._setPoster(),this._updatePlaylist(this._playlist,i),this._playlist.length){case 0:return void this.eContentError.dispatch(this.getContentId(),"No content URL selected.");case 1:f.log("skipping Pilot Mode as there is only one video in the playlist"),this._currentSrc=this._playlist[0];break;default:this._pilotEpisode.start(this._playlist)}if(this._currentSrc){this.setDefaultOptions(),this.addPlayerListeners();var r=this._currentSrc,s=this.element;f.log("playing URL '"+r+"'"),s.src=r,s.load(),s.play()}},_updatePlaylist:function(e,t){f.log("_updatePlaylist"),e.length=0,t.isExpired()?e.push(c.EXPIRED_MP4_URL):e.push.apply(e,this._fileSelectionHandler.getPlaylistForEntry(t)),f.debug("internal playlist ["+e.length+"]:",e)},pause:function(){this.element.pause()},resume:function(){this.element.play()},reset:function(){this._pilotEpisode.stop(),this.removePlayerListeners(),this.exitFullscreen(),this._clearPoster(),this.hideControls(),this.element.removeAttribute("src")},stop:function(){this._stopped||(this._stopped=!0,this.reset(),this.ePlayerStopped.dispatch(this.getContentId()))},seek:function(e){this.element.currentTime=e},setVolume:function(e){this.element.volume=e},getVolume:function(){return this.element.volume},mute:function(){this.element.muted=!0},unmute:function(){this.element.muted=!1},isMuted:function(){return this.element.muted},resize:function(e,t){this._setWidth(this.element,e),this._setHeight(this.element,t),this._onContentResize()},getFullscreenElement:function(){return document.fullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement||document.mozFullscreenElement},_requestFullscreen:function(e){for(var t,n=["requestFullscreen","requestFullScreen","webkitRequestFullscreen","webkitRequestFullScreen","webkitEnterFullscreen","webkitEnterFullScreen","mozRequestFullScreen","msRequestFullscreen"],i=0,r=n.length;r>i;++i)if(t=n[i],
t in e&&h.isFunction(e[t]))return e[t]()},_exitFullscreen:function(){for(var e,t=["exitFullscreen","cancelFullscreen","cancelFullScreen","webkitExitFullscreen","webkitExitFullScreen","webkitCancelFullscreen","webkitCancelFullScreen","mozCancelFullScreen","msExitFullscreen"],n=0,i=t.length;i>n;++n)if(e=t[n],e in document&&h.isFunction(document[e]))return document[e]();var r=this.getVideoElement();if(r===this.getPlayerElement()&&r.webkitDisplayingFullscreen)for(var s,o=["webkitExitFullscreen","webkitExitFullScreen"],a=0,l=o.length;l>a;++a)if(s=o[a],s in r&&h.isFunction(r[s]))return r[s]()},exitFullscreen:function(){try{this._exitFullscreen()}catch(e){f.debug("exitFullscreen failed",e)}},goFullscreen:function(){if(d.forcesFullscreen)return void f.warn("goFullscreen is not permitted on devices that automatically play video in fullscreen.");var e=this.element;if(this.getFullscreenElement()===e)try{this._exitFullscreen()}catch(t){f.error("goFullscreen failed to exit fullscreen",t.message)}else try{this._requestFullscreen(e)}catch(t){f.error("goFullscreen failed to enter fullscreen",t.message)}},getDimensions:function(){return{width:this.getWidth(),height:this.getHeight(),videoWidth:this.element.videoWidth,videoHeight:this.element.videoHeight}},setDefaultOptions:function(){this.setOptions(this.playerOptions)},setOptions:function(e){e=e||{},f.log("setOptions",e),h.each(e,function(e,t){this.element[e]=t},this)},_clearPoster:function(){this.element.poster=""},_setPoster:function(e){var t=arguments.length?e:this.getThumbnail();f.log("_setPoster",t),this.element.poster=c.BLANK_IMG_URL,t&&(this.element.poster=t)},getThumbnail:function(){return this._catalogEntry?this._catalogEntry.getImageForDimensions(this.getWidth(),this.getHeight()):""},getWidth:function(){var e=h.getStyle(this.getPlayerElement(),"width");return e?h.toInt(e):this.width},getHeight:function(){var e=h.getStyle(this.getPlayerElement(),"height");return e?h.toInt(e):this.height},_ensureLoadedMetaDataFiresOnce:function(){this._metadataEmitted||(this._metadataEmitted=!0,this.fireMetadata())},_playIfPlayerIsPaused:function(){this._paused&&(f.log("Attempting to force play since the video element was found paused."),this.element.play())},_onLoadedData:function(){f.log("_onLoadedData"),this._ensurePlayWhenAbleHandler.on()},_onContentPlay:function(){f.log("_onContentPlay"),this._ended=!1,this._seeking&&this.fireSeekEnd(),this._paused&&(this._paused=!1,this.firePause()),this._playEmitted||(this._playEmitted=!0,this.firePlay(),this.firePlayhead())},_onContentPlaying:function(){f.log("_onContentPlaying"),this._clearPoster()},_onContentPause:function(){f.log("_onContentPause"),this._paused=!0,this.getCurrentTime()!==this.getDuration()&&this.firePause()},_onContentPlayhead:function(){if(!this._seeking&&!this._ended){var e=this.getCurrentTime();this._isDoingNothing()?(f.debug("Suspect that the video element did not emit 'ended' event."),this._startEndWatcher()):e!==this._lastPlayhead&&(this._stopEndWatcher(),this.updatePlayhead())}},_isDoingNothing:function(){return 0===h.toInt(this.getCurrentTime())&&Math.abs(this._lastPlayhead-this.getDuration())<2&&!this._stopped&&!this._paused&&!this._seeking&&!this._buffering},_startEndWatcher:function(){this._stopEndWatcher(),this._ended||this._endedWatch.start()},_manuallyCallEnded:function(){this._stopEndWatcher(),this._ended||(f.debug("Manually calling ended because the video element did not."),this._onContentEnd())},_stopEndWatcher:function(){this._endedWatch&&this._endedWatch.stop()},_onContentSeeking:function(){Math.abs(this.getCurrentTime()-this._lastPlayhead)<1||(this._seeking||(this._timeAtSeekBegin=this._lastPlayhead),this.fireSeek(),this._seeking&&this._deferSeekEnd())},_deferSeekEnd:function(){this._seekEndTimer.start()},_onContentSeeked:function(){return this._seeking?void this._deferSeekEnd():void f.debug("received 'seeked' while not seeking?")},_onContentEnd:function(){this._ended||(this._stopEndWatcher(),this._ended=!0,f.log("_onContentEnd"),this.firePlayhead(),this.fireEnded())},_onContentError:function(e){var t=e.target,r=t.error;if(t!==this.element)return void f.error("How can this be?  We've received an error from an element we're not listening to?");if(!r)return void f.error("How can this be?  We've received an 'error' event, but no 'error' property was set on the video element?");if(!n(r))return void f.warn("Received 'error' media event without accompanying error code; ignoring as false error, so content may continue.");var s=i(r);f.error("_onContentError",s),this.eContentError.dispatch(this.getContentId(),s)},_onContentBuffering:function(){return this._buffering?void f.log("_onContentBuffering: still buffering"):(f.log("_onContentBuffering"),this._buffering=!0,void this.fireBuffering())},_onContentBuffered:function(){return this._buffering?(f.log("_onContentBuffered"),this._buffering=!1,void this.fireBuffering()):void f.log("_onContentBuffered: not even buffering")},_onContentVolume:function(){f.log("_onContentVolume");var e=this.element.muted;this._muted!==e&&(this._muted=e,this.ePlayerMuted.dispatch(e)),this.eContentVolume.dispatch(e,this.element.volume)},_onContentResize:function(){f.log("_onContentResize"),this.eContentResize.dispatch(this.getWidth(),this.getHeight(),this._fullscreen)},_onFullscreenChange:function(e){f.log("_onFullscreenChange",e),this._fullscreen=e,this.eFullscreenChange.dispatch(this._fullscreen)},_onFullscreenError:function(){f.log("_onFullscreenError"),this.eFullscreenError.dispatch()},addPlayerListeners:function(){return f.log("addPlayerListeners"),this.element?this._addedListeners?void f.log("addPlayerListeners","already listening to events!"):(this._ensureLoadedMetaDataHandler.on(),h.each(this._eventListeners,this._addEventListener,this),void(this._addedListeners=!0)):void f.error("addPlayerListeners","cannot find element to listen to!")},removePlayerListeners:function(){return f.log("removePlayerListeners"),this.element?this._addedListeners?(this._ensureLoadedMetaDataHandler.off(),h.each(this._eventListeners,this._removeEventListener,this),this._pilotEpisode.stop(),void(this._addedListeners=!1)):void f.log("removePlayerListeners","already stopped listening to events!"):void f.error("removePlayerListeners","cannot find element to not listen to!")}});t.exports=m},{"../../core/app":10,"../../cvp/browser":14,"../../cvp/log":28,"../../cvp/static":37,"../../cvp/util/timing":48,"../../cvp/utils":50,"./baseplayer":80,"./domeventhandler":82,"./fileselection":83,"./fullscreenmonitor":84,"./pilotepisode":86}],89:[function(e,t){t.exports={params:{},mapping:{},appConfig:{},containerInfo:{},configInfo:{html5Order:"",html5Types:"",omniture:{},share:{},embed:{}},adPolicy:{ads:{attr:{type:"NONE"}}},trackingPolicy:{interval:"50%"}}},{}],90:[function(e,t){var n=e("../../vendor/Class"),i=e("../../cvp/utils"),r=e("../../cvp/log"),s=e("./trackingmanager"),o=e("../aspencontroller"),a=e("../../cvp/errors"),l=r.getLogger("AspenTracking"),c="content",d="ad",u=i.toFixed,h=n.extend({init:function(e){l.log("init"),this._playerController=e.playerController,this._cvpElementId=e.cvpElementId,this._trackingManager=new s({logger:r.getLogger("AspenTrackingManager"),playerController:this._playerController}),this._isListening=!1,this.listen(!0),o.isReady()?this.updateTrackingInterval():(this.setTrackingInterval("23"),this._watchAspenInit())},setTrackingInterval:function(e){l.log("setTrackingInterval",e),e=i.toInt(e)+"s",this._trackingManager.setTrackingInterval(e)},switchTrackingIntervalFor:function(e){var t;switch(e){case c:t=o.getConfig("progressReportInterval");break;case d:t=o.getConfig("adProgressReportInterval")}t&&(l.log("setting tracking interval for "+e+" to:",t),this.setTrackingInterval(t))},updateTrackingInterval:function(){l.log("updateTrackingInterval"),this._unwatchAspenInit(),this.switchTrackingIntervalFor(c)},_watchAspenInit:function(){o.eInitSuccess.addListener(this.updateTrackingInterval,this)},_unwatchAspenInit:function(){o.eInitSuccess.removeListener(this.updateTrackingInterval,this)},dispose:function(){l.log("dispose"),this._unwatchAspenInit(),this.listen(!1),this._trackingManager.dispose(),this._trackingManager=null},listen:function(e){if(l.log("listen",e),this._isListening===e)return void l.log("already "+(e?"":"not")+" listening");this._isListening=e;var t=e?"addListener":"removeListener";this._trackingManager.eTrackingAdStart[t](this._onTrackingAdStart,this),this._trackingManager.eTrackingAdComplete[t](this._onTrackingAdComplete,this),this._trackingManager.eTrackingAdProgress[t](this._onTrackingAdProgress,this),this._trackingManager.eTrackingAdError[t](this._onTrackingAdError,this),this._trackingManager.eTrackingContentBegin[t](this._onTrackingContentBegin,this),this._trackingManager.eTrackingContentStart[t](this._onTrackingContentStart,this),this._trackingManager.eTrackingContentProgress[t](this._onTrackingContentProgress,this),this._trackingManager.eTrackingContentEnd[t](this._onTrackingContentEnd,this),this._trackingManager.eTrackingContentComplete[t](this._onTrackingContentComplete,this),this._trackingManager.eTrackingContentSeekEnd[t](this._onTrackingContentSeekEnd,this),this._trackingManager.eTrackingPaused[t](this._onTrackingPaused,this)},getCurrentPlayer:function(){return this._playerManager.getCurrentPlayer()},_onTrackingAdInfo:function(e){l.log("_onTrackingAdInfo"),o.send("adInfo",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(o.videoCount),adSection:e.adSection,adAssetId:e.adTitle,adSlotInfo:void 0})},_onTrackingAdError:function(e){l.log("_onTrackingAdError");var t=e.errorMessage,n=a.determineAdErrorCode(t);o.send("error",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(o.videoCount),adType:e.adType,adBlockId:String(e.adBlock),errorMessage:t,errorCode:n})},_onTrackingAdStart:function(e){l.log("_onTrackingAdStart"),o.send("adStart",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(o.videoCount),adType:e.adType,adBlockId:String(e.adBlock),adSection:e.adSection,adAssetId:e.adTitle,width:String(e.adWidth),height:String(e.adHeight),adDuration:String(e.adDuration),slotId:void 0,adInstances:void 0})},_onTrackingAdProgress:function(e){l.log("_onTrackingAdProgress"),o.send("adProgress",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(o.videoCount),adType:e.adType,adBlockId:String(e.adBlock),adPlayHead:u(e.playheadTime),adDuration:u(e.adDuration),adTimeSpent:u(e.adTotalPlayTime),slotId:void 0,adInstances:void 0})},_onTrackingAdComplete:function(e){l.log("_onTrackingAdComplete"),o.send("adStop",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(o.videoCount),adType:e.adType,adBlockId:String(e.adBlock),adAssetId:e.adTitle,slotId:void 0})},_onTrackingContentBegin:function(e){l.log("_onTrackingContentBegin"),o.videoCount+=1,o.send("contentStart",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(o.videoCount),originId:e.originId,playOptions:e.playOptions,mode:e.contentMode,propertyName:e.contentSource})},_onTrackingContentStart:function(e){l.log("_onTrackingContentStart"),o.send("contentPlay",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(o.videoCount),originId:e.originId,contentType:e.contentType,duration:String(e.length),joinTime:String(e.joinTime),mediaPath:e.mediaUrl,bandwidth:void 0,serverIp:void 0,ccAvailable:void 0,dvrAvailable:void 0})},_onTrackingContentProgress:function(e){l.log("_onTrackingContentProgress");var t="totalPlayTime"in e&&"adTotalPlayTime"in e?((e.totalPlayTime||0)-(e.adTotalPlayTime||0)).toFixed(3):void 0;o.send("contentProgress",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(o.videoCount),originId:e.originId,timeSpentBuffering:void 0,timeSpentPlaying:t,playHead:u(e.playheadTime),playerWidth:String(e.playerWidth),playerHeight:String(e.playerHeight),ccAvailable:void 0,ccEnabled:void 0,ccTrackLang:void 0,dvrAvailable:void 0,dvrEnabled:void 0,dvrWindow:void 0,dvrStart:void 0})},_onTrackingPaused:function(e){l.log("_onTrackingPaused"),o.send("contentPause",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(o.videoCount),contentPlayHead:u(e.playhead),isPaused:String(e.paused)})},_onTrackingContentSeekEnd:function(e){l.log("_onTrackingContentSeekEnd"),o.send("contentSeek",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(o.videoCount),seekFrom:u(e.previousPlayhead),seekTo:u(e.newPlayhead),dvrAvailable:void 0,dvrEnabled:void 0})},_onTrackingContentEnd:function(e){l.log("_onTrackingContentEnd"),o.send("contentStop",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(o.videoCount),playHead:u(e.playheadTime),segmentId:void 0})},_onTrackingContentComplete:function(e){l.log("_onTrackingContentComplete"),o.send("contentFinish",{cvpElementId:this._cvpElementId,contentId:e.contentId,videoContentCount:String(o.videoCount)})}});t.exports=h},{"../../cvp/errors":26,"../../cvp/log":28,"../../cvp/utils":50,"../../vendor/Class":92,"../aspencontroller":60,"./trackingmanager":91}],91:[function(e,t){var n=e("../../vendor/Class"),i=e("../../cvp/customevent"),r=e("../../cvp/log"),s=r.getLogger("TrackingManager"),o=n.extend({setLogger:function(e){this._logger=e},init:function(e){this.setLogger(e.logger||s),this._playerController=e.playerController,this._trackingInterval=0,this.eTrackingAdStart=new i,this.eTrackingAdComplete=new i,this.eTrackingAdError=new i,this.eTrackingAdProgress=new i,this.eTrackingAdCountdown=new i,this.eTrackingAdClick=new i,this.eTrackingContentBegin=new i,this.eTrackingContentPlay=new i,this.eTrackingContentStart=new i,this.eTrackingContentProgress=new i,this.eTrackingContentEnd=new i,this.eTrackingContentComplete=new i,this.eTrackingContentReplay=new i,this.eTrackingContentSeek=new i,this.eTrackingContentSeekEnd=new i,this.eTrackingFullscreen=new i,this.eTrackingMuted=new i,this.eTrackingPaused=new i,this.reset(),this._isListening=!1,this.listen(!0)},reset:function(){this._lastPlayhead=0,this._lastPercent=0,this._previousAdPlayhead=0,this._currentAdDuration=0,this._currentAdPlayhead=0,this._totalAdPlayTime=0,this._previousContentPlayhead=0,this._currentContentPlayhead=0,this._totalGrossPlayTime=0},dispose:function(){this.listen(!1),this._playerController=null,this._logger=null},getCatalogEntry:function(){return this._playerController.getCatalogEntry()},getPlayerDimensions:function(){return this._playerController.getPlayerDimensions()},getAdId:function(){return this._playerController.getAdId()},getAdType:function(){return this._playerController.getAdType()},getAdSection:function(){return this._playerController.getAdSection()},listen:function(e){if(this._isListening!==e){this._isListening=e;var t=e?"addListener":"removeListener";this._playerController.eAdPlay[t](this._onTrackingAdStart,this),this._playerController.eAdEnd[t](this._onTrackingAdComplete,this),this._playerController.eAdError[t](this._onTrackingAdError,this),this._playerController.eAdPlayhead[t](this._onTrackingAdProgress,this),this._playerController.eAdPlayhead[t](this._onTrackingAdCountdown,this),this._playerController.eAdClick[t](this._onTrackingAdClick,this),this._playerController.eContentBegin[t](this._onTrackingContentBegin,this),this._playerController.eContentPlay[t](this._onTrackingContentPlay,this),this._playerController.eContentStart[t](this._onTrackingContentStart,this),this._playerController.eContentPlayhead[t](this._onTrackingContentProgress,this),this._playerController.eContentEnd[t](this._onTrackingContentEnd,this),this._playerController.eContentComplete[t](this._onTrackingContentComplete,this),this._playerController.eContentReplay[t](this._onTrackingContentReplay,this),this._playerController.eContentSeek[t](this._onTrackingContentSeek,this),this._playerController.eContentSeekEnd[t](this._onTrackingContentSeekEnd,this),this._playerController.eFullscreenChange[t](this._onTrackingFullscreen,this),this._playerController.ePlayerPaused[t](this._onTrackingPaused,this),this._playerController.ePlayerMuted[t](this._onTrackingMuted,this)}},_canEmitProgress:function(e,t){var n=this._trackingInterval;if(!n)return!1;var i=Math.floor(e),r=Math.floor(e/t*100),s=!1,o=this._intervalRegex.exec(n),a=Number(o[1]),l=o[2];return isNaN(t)&&"%"===l&&(a=30,l="s"),"s"===l&&(a>t?(a=50,l="%"):i!==this._lastPlayhead&&i%a===0&&(s=!0)),"%"===l&&r!==this._lastPercent&&100>r&&r%a===0&&(s=!0),s&&(this._lastPlayhead=i,this._lastPercent=r),s},_onTrackingAdStart:function(e,t,n,i,r,s,o){this._logger.log("_onTrackingAdStart",arguments),this._lastPlayhead=0,this._lastPercent=0,this._previousAdPlayhead=0,this._currentAdPlayhead=0,this._currentAdDuration=0;var a=this.getPlayerDimensions(),l=this.getCatalogEntry();this.eTrackingAdStart.dispatch({adTitle:n,adWidth:a.videoWidth,adHeight:a.videoHeight,adSection:this.getAdSection(),contentId:l.getId(),originId:l.getOriginId(),mediaUrl:l.getMediaUrl(),adType:s,adDuration:i,adBlock:r,totalPlayTime:this._totalGrossPlayTime,adTotalPlayTime:this._totalAdPlayTime,adAnalyticsData:o})},_onTrackingAdComplete:function(e,t,n,i,r){this._logger.log("_onTrackingAdComplete",arguments);var s=this.getCatalogEntry();this.eTrackingAdComplete.dispatch({contentId:s.getId(),adTitle:n,adType:r,adBlock:i,totalPlayTime:this._totalGrossPlayTime,adTotalPlayTime:this._totalAdPlayTime})},_onTrackingAdError:function(e,t,n,i){this._logger.log("_onTrackingAdError",arguments);var r=this.getCatalogEntry();this.eTrackingAdError.dispatch({contentId:r.getId(),errorMessage:e,adType:n,adBlock:t,errors:i})},_onTrackingAdProgress:function(e,t,n){this._currentAdPlayhead=e,this._currentAdDuration=t;var i=e-this._previousAdPlayhead;this._previousAdPlayhead=e,0>=i||i>=1.25||(this._totalAdPlayTime+=i,this._totalGrossPlayTime+=i,this._canEmitProgress(e,t)&&this.eTrackingAdProgress.dispatch({totalPlayTime:this._totalGrossPlayTime,playheadTime:this._currentAdPlayhead,adDuration:this._currentAdDuration,grossProgressMarker:0,adType:this.getAdType(),adBlock:n,adTotalPlayTime:this._totalAdPlayTime}))},_onTrackingAdCountdown:function(e,t){var n=Math.ceil(t-e);n>0&&n!==this._previousAdCountdown&&(this._previousAdCountdown=n,this.eTrackingAdCountdown.dispatch({adMode:"standard",secs:n}))},_onTrackingAdClick:function(e){this._logger.log("_onTrackingAdClick",arguments);var t=this.getCatalogEntry();this.eTrackingAdClick.dispatch({contentId:t.getId(),url:e})},_onTrackingContentBegin:function(e,t){this._logger.log("_onTrackingContentBegin",arguments),this.reset();var n=this.getCatalogEntry();this.eTrackingContentBegin.dispatch({contentId:n.getId(),playOptions:t,originId:n.getOriginId(),contentMode:n.getMode(),contentSource:n.getSource(),totalPlayTime:this._totalGrossPlayTime,adTotalPlayTime:this._totalAdPlayTime})},_onTrackingContentPlay:function(){this._logger.log("_onTrackingContentPlay",arguments),this._lastPlayhead=0,this._lastPercent=0;var e=this.getCatalogEntry();this.eTrackingContentPlay.dispatch({contentId:e.getId(),originId:e.getOriginId(),mediaUrl:e.getMediaUrl(),length:e.getTrt(),grossLength:e.getTrt(),totalPlayTime:this._totalGrossPlayTime,adTotalPlayTime:this._totalAdPlayTime})},_onTrackingContentStart:function(e,t){this._logger.log("_onTrackingContentStart",arguments);var n=this.getCatalogEntry();this.eTrackingContentStart.dispatch({contentId:n.getId(),originId:n.getOriginId(),mediaUrl:n.getMediaUrl(),joinTime:t,length:n.getTrt(),grossLength:n.getTrt(),totalPlayTime:this._totalGrossPlayTime,adTotalPlayTime:this._totalAdPlayTime})},_onTrackingContentProgress:function(e,t,n){this._currentContentPlayhead=t;var i=t-this._previousContentPlayhead;if(this._previousContentPlayhead=t,!(0>=i||i>=1.25)&&(this._totalGrossPlayTime+=i,this._canEmitProgress(t,n))){var r=this.getCatalogEntry(),s=this.getPlayerDimensions();this.eTrackingContentProgress.dispatch({contentId:r.getId(),originId:r.getOriginId(),playerWidth:s.width,playerHeight:s.height,percent:t/n*100,totalPlayTime:this._totalGrossPlayTime,playheadTime:this._currentContentPlayhead,progressMarker:0,grossProgressMarker:0,adTotalPlayTime:this._totalAdPlayTime})}},_onTrackingContentEnd:function(){this._logger.log("_onTrackingContentEnd",arguments);var e=this.getCatalogEntry();this.eTrackingContentEnd.dispatch({contentId:e.getId(),totalPlayTime:this._totalGrossPlayTime,playheadTime:this._currentContentPlayhead,adTotalPlayTime:this._totalAdPlayTime})},_onTrackingContentComplete:function(){this._logger.log("_onTrackingContentComplete",arguments);var e=this.getCatalogEntry();this.eTrackingContentComplete.dispatch({contentId:e.getId(),percent:100,totalPlayTime:this._totalGrossPlayTime,playheadTime:this._currentContentPlayhead,progressMarker:0,grossProgressMarker:0,adTotalPlayTime:this._totalAdPlayTime})},_onTrackingContentReplay:function(e,t){this._logger.log("_onTrackingContentReplay",arguments),this.eTrackingContentReplay.dispatch({contentId:e,additionalParams:t})},_onTrackingContentSeek:function(e,t,n,i){this._logger.log("_onTrackingContentSeek",arguments),this.eTrackingContentSeek.dispatch({contentId:e,previousPlayhead:t,newPlayhead:n,duration:i})},_onTrackingContentSeekEnd:function(e,t,n,i){this._logger.log("_onTrackingContentSeekEnd",arguments),this.eTrackingContentSeekEnd.dispatch({contentId:e,previousPlayhead:t,newPlayhead:n,duration:i})},_onTrackingFullscreen:function(e,t){this._logger.log("_onTrackingFullscreen",arguments),this.eTrackingFullscreen.dispatch({contentId:e,fullscreen:t})},_onTrackingMuted:function(e,t){this._logger.log("_onTrackingMuted",arguments),this.eTrackingMuted.dispatch({contentId:e,muted:t})},_onTrackingPaused:function(e,t,n){this._logger.log("_onTrackingPaused",arguments),this.eTrackingPaused.dispatch({contentId:e,playhead:t,paused:n})},_intervalRegex:/(\d+)([s%])?/,setTrackingInterval:function(e){if(!e)return void(this._trackingInterval=0);var t=this._intervalRegex.exec(String(e));if(!t)return void this._logger.error('setTrackingInterval param "'+e+'" did not match accepted regex');var n=t[1],i=t[2]||"%";n>100&&(i="s"),this._trackingInterval=n+i}});t.exports=o},{"../../cvp/customevent":17,"../../cvp/log":28,"../../vendor/Class":92}],92:[function(e,t){var n=!1,i=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,r=function(){};r.extend=function s(e){function t(){!n&&this.init&&this.init.apply(this,arguments)}var r=this.prototype;n=!0;var o=new this;n=!1;for(var a in e)o[a]="function"==typeof e[a]&&"function"==typeof r[a]&&i.test(e[a])?function(e,t){return function(){var n=this._super;this._super=r[e];var i=t.apply(this,arguments);return this._super=n,i}}(a,e[a]):e[a];return t.prototype=o,t.prototype.constructor=t,t.extend=s,t},t.exports=r},{}],93:[function(e,t){t.exports=function(e,t,n,i,r,s){function o(e,t){var n=typeof e[t];return"function"==n||!("object"!=n||!e[t])||"unknown"==n}function a(e,t){return!("object"!=typeof e[t]||!e[t])}function l(e){return"[object Array]"===Object.prototype.toString.call(e)}function c(){var e="Shockwave Flash",t="application/x-shockwave-flash";if(!y(navigator.plugins)&&"object"==typeof navigator.plugins[e]){var n=navigator.plugins[e].description;n&&!y(navigator.mimeTypes)&&navigator.mimeTypes[t]&&navigator.mimeTypes[t].enabledPlugin&&(k=n.match(/\d+/g))}if(!k){var i;try{i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),k=Array.prototype.slice.call(i.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/),1),i=null}catch(r){}}if(!k)return!1;var s=parseInt(k[0],10),o=parseInt(k[1],10);return I=s>9&&o>0,!0}function d(){if(!H){H=!0;for(var e=0;e<W.length;e++)W[e]();W.length=0}}function u(e,t){return H?void e.call(t):void W.push(function(){e.call(t)})}function h(){var e=parent;if(""!==B)for(var t=0,n=B.split(".");t<n.length;t++)e=e[n[t]];return e.easyXDM}function p(t){return e.easyXDM=U,B=t,B&&(q="easyXDM_"+B.replace(".","_")+"_"),V}function g(e){return e.match(F)[3]}function f(e){return e.match(F)[4]||""}function _(e){var t=e.toLowerCase().match(F),n=t[2],i=t[3],r=t[4]||"";return("http:"==n&&":80"==r||"https:"==n&&":443"==r)&&(r=""),n+"//"+i+r}function m(e){if(e=e.replace(N,"$1/"),!e.match(/^(http||https):\/\//)){var t="/"===e.substring(0,1)?"":n.pathname;"/"!==t.substring(t.length-1)&&(t=t.substring(0,t.lastIndexOf("/")+1)),e=n.protocol+"//"+n.host+t+e}for(;M.test(e);)e=e.replace(M,"");return e}function v(e,t){var n="",i=e.indexOf("#");-1!==i&&(n=e.substring(i),e=e.substring(0,i));var r=[];for(var o in t)t.hasOwnProperty(o)&&r.push(o+"="+s(t[o]));return e+(j?"#":-1==e.indexOf("?")?"?":"&")+r.join("&")+n}function y(e){return"undefined"==typeof e}function C(e,t,n){var i;for(var r in t)t.hasOwnProperty(r)&&(r in e?(i=t[r],"object"==typeof i?C(e[r],i,n):n||(e[r]=t[r])):e[r]=t[r]);return e}function E(){var e=t.body.appendChild(t.createElement("form")),n=e.appendChild(t.createElement("input"));n.name=q+"TEST"+D,S=n!==e.elements[n.name],t.body.removeChild(e)}function P(e){y(S)&&E();var n;S?n=t.createElement('<iframe name="'+e.props.name+'"/>'):(n=t.createElement("IFRAME"),n.name=e.props.name),n.id=n.name=e.props.name,delete e.props.name,"string"==typeof e.container&&(e.container=t.getElementById(e.container)),e.container||(C(n.style,{position:"absolute",top:"-2000px",left:"0px"}),e.container=t.body);var i=e.props.src;if(e.props.src="javascript:false",C(n,e.props),n.border=n.frameBorder=0,n.allowTransparency=!0,e.container.appendChild(n),e.onLoad&&L(n,"load",e.onLoad),e.usePost){var r,s=e.container.appendChild(t.createElement("form"));if(s.target=n.name,s.action=i,s.method="POST","object"==typeof e.usePost)for(var o in e.usePost)e.usePost.hasOwnProperty(o)&&(S?r=t.createElement('<input name="'+o+'"/>'):(r=t.createElement("INPUT"),r.name=o),r.value=e.usePost[o],s.appendChild(r));s.submit(),s.parentNode.removeChild(s)}else n.src=i;return e.props.src=i,n}function b(e,t){"string"==typeof e&&(e=[e]);for(var n,i=e.length;i--;)if(n=e[i],n=new RegExp("^"==n.substr(0,1)?n:"^"+n.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"),n.test(t))return!0;return!1}function T(i){var r,s=i.protocol;if(i.isHost=i.isHost||y(X.xdm_p),j=i.hash||!1,i.props||(i.props={}),i.isHost)i.remote=m(i.remote),i.channel=i.channel||"default"+D++,i.secret=Math.random().toString(16).substring(2),y(s)&&(s=_(n.href)==_(i.remote)?"4":o(e,"postMessage")||o(t,"postMessage")?"1":i.swf&&o(e,"ActiveXObject")&&c()?"6":"Gecko"===navigator.product&&"frameElement"in e&&-1==navigator.userAgent.indexOf("WebKit")?"5":i.remoteHelper?"2":"0");else if(i.channel=X.xdm_c.replace(/["'<>\\]/g,""),i.secret=X.xdm_s,i.remote=X.xdm_e.replace(/["'<>\\]/g,""),s=X.xdm_p,i.acl&&!b(i.acl,i.remote))throw new Error("Access denied for "+i.remote);switch(i.protocol=s,s){case"0":if(C(i,{interval:100,delay:2e3,useResize:!0,useParent:!1,usePolling:!1},!0),i.isHost){if(!i.local){for(var a,l=n.protocol+"//"+n.host,d=t.body.getElementsByTagName("img"),u=d.length;u--;)if(a=d[u],a.src.substring(0,l.length)===l){i.local=a.src;break}i.local||(i.local=e)}var h={xdm_c:i.channel,xdm_p:0};i.local===e?(i.usePolling=!0,i.useParent=!0,i.local=n.protocol+"//"+n.host+n.pathname+n.search,h.xdm_e=i.local,h.xdm_pa=1):h.xdm_e=m(i.local),i.container&&(i.useResize=!1,h.xdm_po=1),i.remote=v(i.remote,h)}else C(i,{channel:X.xdm_c,remote:X.xdm_e,useParent:!y(X.xdm_pa),usePolling:!y(X.xdm_po),useResize:i.useParent?!1:i.useResize});r=[new V.stack.HashTransport(i),new V.stack.ReliableBehavior({}),new V.stack.QueueBehavior({encode:!0,maxLength:4e3-i.remote.length}),new V.stack.VerifyBehavior({initiate:i.isHost})];break;case"1":r=[new V.stack.PostMessageTransport(i)];break;case"2":i.isHost&&(i.remoteHelper=m(i.remoteHelper)),r=[new V.stack.NameTransport(i),new V.stack.QueueBehavior,new V.stack.VerifyBehavior({initiate:i.isHost})];break;case"3":r=[new V.stack.NixTransport(i)];break;case"4":r=[new V.stack.SameOriginTransport(i)];break;case"5":r=[new V.stack.FrameElementTransport(i)];break;case"6":k||c(),r=[new V.stack.FlashTransport(i)]}return r.push(new V.stack.QueueBehavior({lazy:i.lazy,remove:!0})),r}function A(e){for(var t,n={incoming:function(e,t){this.up.incoming(e,t)},outgoing:function(e,t){this.down.outgoing(e,t)},callback:function(e){this.up.callback(e)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}},i=0,r=e.length;r>i;i++)t=e[i],C(t,n,!0),0!==i&&(t.down=e[i-1]),i!==r-1&&(t.up=e[i+1]);return t}function w(e){e.up.down=e.down,e.down.up=e.up,e.up=e.down=null}var S,k,I,L,x,R=this,D=Math.floor(1e4*Math.random()),O=Function.prototype,F=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/,M=/[\-\w]+\/\.\.\//,N=/([^:])\/\//g,B="",V={},U=e.easyXDM,q="easyXDM_",j=!1;if(o(e,"addEventListener"))L=function(e,t,n){e.addEventListener(t,n,!1)},x=function(e,t,n){e.removeEventListener(t,n,!1)};else{if(!o(e,"attachEvent"))throw new Error("Browser not supported");L=function(e,t,n){e.attachEvent("on"+t,n)},x=function(e,t,n){e.detachEvent("on"+t,n)}}var Q,H=!1,W=[];if("readyState"in t?(Q=t.readyState,H="complete"==Q||~navigator.userAgent.indexOf("AppleWebKit/")&&("loaded"==Q||"interactive"==Q)):H=!!t.body,!H){if(o(e,"addEventListener"))L(t,"DOMContentLoaded",d);else if(L(t,"readystatechange",function(){"complete"==t.readyState&&d()}),t.documentElement.doScroll&&e===top){var K=function(){if(!H){try{t.documentElement.doScroll("left")}catch(e){return void i(K,1)}d()}};K()}L(e,"load",d)}var X=function(e){e=e.substring(1).split("&");for(var t,n={},i=e.length;i--;)t=e[i].split("="),n[t[0]]=r(t[1]);return n}(/xdm_e=/.test(n.search)?n.search:n.hash),z=function(){var e={},t={a:[1,2,3]},n='{"a":[1,2,3]}';return"undefined"!=typeof JSON&&"function"==typeof JSON.stringify&&JSON.stringify(t).replace(/\s/g,"")===n?JSON:(Object.toJSON&&Object.toJSON(t).replace(/\s/g,"")===n&&(e.stringify=Object.toJSON),"function"==typeof String.prototype.evalJSON&&(t=n.evalJSON(),t.a&&3===t.a.length&&3===t.a[2]&&(e.parse=function(e){return e.evalJSON()})),e.stringify&&e.parse?(z=function(){return e},e):null)};return C(V,{version:"2.4.19.3",query:X,stack:{},apply:C,getJSONObject:z,whenReady:u,noConflict:p}),V.DomHelper={on:L,un:x,requiresJSON:function(n){a(e,"JSON")||t.write('<script type="text/javascript" src="'+n+'"></script>')}},function(){var e={};V.Fn={set:function(t,n){e[t]=n},get:function(t,n){if(e.hasOwnProperty(t)){var i=e[t];return n&&delete e[t],i}}}}(),V.Socket=function(e){var t=A(T(e).concat([{incoming:function(t,n){e.onMessage(t,n)},callback:function(t){e.onReady&&e.onReady(t)}}])),n=_(e.remote);this.origin=_(e.remote),this.destroy=function(){t.destroy()},this.postMessage=function(e){t.outgoing(e,n)},t.init()},V.Rpc=function(e,t){if(t.local)for(var n in t.local)if(t.local.hasOwnProperty(n)){var i=t.local[n];"function"==typeof i&&(t.local[n]={method:i})}var r=A(T(e).concat([new V.stack.RpcBehavior(this,t),{callback:function(t){e.onReady&&e.onReady(t)}}]));this.origin=_(e.remote),this.destroy=function(){r.destroy()},r.init()},V.stack.SameOriginTransport=function(e){var t,r,s,o;return t={outgoing:function(e,t,n){s(e),n&&n()},destroy:function(){r&&(r.parentNode.removeChild(r),r=null)},onDOMReady:function(){o=_(e.remote),e.isHost?(C(e.props,{src:v(e.remote,{xdm_e:n.protocol+"//"+n.host+n.pathname,xdm_c:e.channel,xdm_p:4}),name:q+e.channel+"_provider"}),r=P(e),V.Fn.set(e.channel,function(e){return s=e,i(function(){t.up.callback(!0)},0),function(e){t.up.incoming(e,o)}})):(s=h().Fn.get(e.channel,!0)(function(e){t.up.incoming(e,o)}),i(function(){t.up.callback(!0)},0))},init:function(){u(t.onDOMReady,t)}}},V.stack.FlashTransport=function(e){function r(e){i(function(){a.up.incoming(e,c)},0)}function o(n){var i=e.swf+"?host="+e.isHost,r="easyXDM_swf_"+Math.floor(1e4*Math.random());V.Fn.set("flash_loaded"+n.replace(/[\-.]/g,"_"),function(){V.stack.FlashTransport[n].swf=d=h.firstChild;for(var e=V.stack.FlashTransport[n].queue,t=0;t<e.length;t++)e[t]();e.length=0}),e.swfContainer?h="string"==typeof e.swfContainer?t.getElementById(e.swfContainer):e.swfContainer:(h=t.createElement("div"),C(h.style,I&&e.swfNoThrottle?{height:"20px",width:"20px",
position:"fixed",right:0,top:0}:{height:"1px",width:"1px",position:"absolute",overflow:"hidden",right:0,top:0}),t.body.appendChild(h));var o="callback=flash_loaded"+s(n.replace(/[\-.]/g,"_"))+"&proto="+R.location.protocol+"&domain="+s(g(R.location.href))+"&port="+s(f(R.location.href))+"&ns="+s(B);h.innerHTML="<object height='20' width='20' type='application/x-shockwave-flash' id='"+r+"' data='"+i+"'><param name='allowScriptAccess' value='always'></param><param name='wmode' value='transparent'><param name='movie' value='"+i+"'></param><param name='flashvars' value='"+o+"'></param><embed type='application/x-shockwave-flash' FlashVars='"+o+"' allowScriptAccess='always' wmode='transparent' src='"+i+"' height='1' width='1'></embed></object>"}var a,l,c,d,h;return a={outgoing:function(t,n,i){d.postMessage(e.channel,t.toString()),i&&i()},destroy:function(){try{d.destroyChannel(e.channel)}catch(t){}d=null,l&&(l.parentNode.removeChild(l),l=null)},onDOMReady:function(){c=e.remote,V.Fn.set("flash_"+e.channel+"_init",function(){i(function(){a.up.callback(!0)})}),V.Fn.set("flash_"+e.channel+"_onMessage",r),e.swf=m(e.swf);var t=g(e.swf),s=function(){V.stack.FlashTransport[t].init=!0,d=V.stack.FlashTransport[t].swf,d.createChannel(e.channel,e.secret,_(e.remote),e.isHost),e.isHost&&(I&&e.swfNoThrottle&&C(e.props,{position:"fixed",right:0,top:0,height:"20px",width:"20px"}),C(e.props,{src:v(e.remote,{xdm_e:_(n.href),xdm_c:e.channel,xdm_p:6,xdm_s:e.secret}),name:q+e.channel+"_provider"}),l=P(e))};V.stack.FlashTransport[t]&&V.stack.FlashTransport[t].init?s():V.stack.FlashTransport[t]?V.stack.FlashTransport[t].queue.push(s):(V.stack.FlashTransport[t]={queue:[s]},o(t))},init:function(){u(a.onDOMReady,a)}}},V.stack.PostMessageTransport=function(t){function r(e){if(e.origin)return _(e.origin);if(e.uri)return _(e.uri);if(e.domain)return n.protocol+"//"+e.domain;throw"Unable to retrieve the origin of the event"}function s(e){var n=r(e);n==c&&e.data.substring(0,t.channel.length+1)==t.channel+" "&&o.up.incoming(e.data.substring(t.channel.length+1),n)}var o,a,l,c;return o={outgoing:function(e,n,i){l.postMessage(t.channel+" "+e,n||c),i&&i()},destroy:function(){x(e,"message",s),a&&(l=null,a.parentNode.removeChild(a),a=null)},onDOMReady:function(){if(c=_(t.remote),t.isHost){var r=function(n){n.data==t.channel+"-ready"&&(l="postMessage"in a.contentWindow?a.contentWindow:a.contentWindow.document,x(e,"message",r),L(e,"message",s),i(function(){o.up.callback(!0)},0))};L(e,"message",r),C(t.props,{src:v(t.remote,{xdm_e:_(n.href),xdm_c:t.channel,xdm_p:1}),name:q+t.channel+"_provider"}),a=P(t)}else L(e,"message",s),l="postMessage"in e.parent?e.parent:e.parent.document,l.postMessage(t.channel+"-ready",c),i(function(){o.up.callback(!0)},0)},init:function(){u(o.onDOMReady,o)}}},V.stack.FrameElementTransport=function(r){var s,o,a,l;return s={outgoing:function(e,t,n){a.call(this,e),n&&n()},destroy:function(){o&&(o.parentNode.removeChild(o),o=null)},onDOMReady:function(){l=_(r.remote),r.isHost?(C(r.props,{src:v(r.remote,{xdm_e:_(n.href),xdm_c:r.channel,xdm_p:5}),name:q+r.channel+"_provider"}),o=P(r),o.fn=function(e){return delete o.fn,a=e,i(function(){s.up.callback(!0)},0),function(e){s.up.incoming(e,l)}}):(t.referrer&&_(t.referrer)!=X.xdm_e&&(e.top.location=X.xdm_e),a=e.frameElement.fn(function(e){s.up.incoming(e,l)}),s.up.callback(!0))},init:function(){u(s.onDOMReady,s)}}},V.stack.NameTransport=function(e){function t(t){var n=e.remoteHelper+(a?"#_3":"#_2")+e.channel;l.contentWindow.sendMessage(t,n)}function n(){a?2!==++d&&a||o.up.callback(!0):(t("ready"),o.up.callback(!0))}function r(e){o.up.incoming(e,p)}function s(){h&&i(function(){h(!0)},0)}var o,a,l,c,d,h,p,g;return o={outgoing:function(e,n,i){h=i,t(e)},destroy:function(){l.parentNode.removeChild(l),l=null,a&&(c.parentNode.removeChild(c),c=null)},onDOMReady:function(){a=e.isHost,d=0,p=_(e.remote),e.local=m(e.local),a?(V.Fn.set(e.channel,function(t){a&&"ready"===t&&(V.Fn.set(e.channel,r),n())}),g=v(e.remote,{xdm_e:e.local,xdm_c:e.channel,xdm_p:2}),C(e.props,{src:g+"#"+e.channel,name:q+e.channel+"_provider"}),c=P(e)):(e.remoteHelper=e.remote,V.Fn.set(e.channel,r));var t=function(){var r=l||this;x(r,"load",t),V.Fn.set(e.channel+"_load",s),function o(){"function"==typeof r.contentWindow.sendMessage?n():i(o,50)}()};l=P({props:{src:e.local+"#_4"+e.channel},onLoad:t})},init:function(){u(o.onDOMReady,o)}}},V.stack.HashTransport=function(t){function n(e){if(f){var n=t.remote+"#"+p++ +"_"+e;(l||!m?f.contentWindow:f).location=n}}function r(e){h=e,a.up.incoming(h.substring(h.indexOf("_")+1),v)}function s(){if(g){var e=g.location.href,t="",n=e.indexOf("#");-1!=n&&(t=e.substring(n)),t&&t!=h&&r(t)}}function o(){c=setInterval(s,d)}var a,l,c,d,h,p,g,f,m,v;return a={outgoing:function(e){n(e)},destroy:function(){e.clearInterval(c),(l||!m)&&f.parentNode.removeChild(f),f=null},onDOMReady:function(){if(l=t.isHost,d=t.interval,h="#"+t.channel,p=0,m=t.useParent,v=_(t.remote),l){if(C(t.props,{src:t.remote,name:q+t.channel+"_provider"}),m)t.onLoad=function(){g=e,o(),a.up.callback(!0)};else{var n=0,r=t.delay/50;!function s(){if(++n>r)throw new Error("Unable to reference listenerwindow");try{g=f.contentWindow.frames[q+t.channel+"_consumer"]}catch(e){}g?(o(),a.up.callback(!0)):i(s,50)}()}f=P(t)}else g=e,o(),m?(f=parent,a.up.callback(!0)):(C(t,{props:{src:t.remote+"#"+t.channel+new Date,name:q+t.channel+"_consumer"},onLoad:function(){a.up.callback(!0)}}),f=P(t))},init:function(){u(a.onDOMReady,a)}}},V.stack.ReliableBehavior=function(){var e,t,n=0,i=0,r="";return e={incoming:function(s,o){var a=s.indexOf("_"),l=s.substring(0,a).split(",");s=s.substring(a+1),l[0]==n&&(r="",t&&t(!0)),s.length>0&&(e.down.outgoing(l[1]+","+n+"_"+r,o),i!=l[1]&&(i=l[1],e.up.incoming(s,o)))},outgoing:function(s,o,a){r=s,t=a,e.down.outgoing(i+","+ ++n+"_"+s,o)}}},V.stack.QueueBehavior=function(e){function t(){if(e.remove&&0===a.length)return void w(n);if(!l&&0!==a.length&&!o){l=!0;var r=a.shift();n.down.outgoing(r.data,r.origin,function(e){l=!1,r.callback&&i(function(){r.callback(e)},0),t()})}}var n,o,a=[],l=!0,c="",d=0,u=!1,h=!1;return n={init:function(){y(e)&&(e={}),e.maxLength&&(d=e.maxLength,h=!0),e.lazy?u=!0:n.down.init()},callback:function(e){l=!1;var i=n.up;t(),i.callback(e)},incoming:function(t,i){if(h){var s=t.indexOf("_"),o=parseInt(t.substring(0,s),10);c+=t.substring(s+1),0===o&&(e.encode&&(c=r(c)),n.up.incoming(c,i),c="")}else n.up.incoming(t,i)},outgoing:function(i,r,o){e.encode&&(i=s(i));var l,c=[];if(h){for(;0!==i.length;)l=i.substring(0,d),i=i.substring(l.length),c.push(l);for(;l=c.shift();)a.push({data:c.length+"_"+l,origin:r,callback:0===c.length?o:null})}else a.push({data:i,origin:r,callback:o});u?n.down.init():t()},destroy:function(){o=!0,n.down.destroy()}}},V.stack.VerifyBehavior=function(e){function t(){i=Math.random().toString(16).substring(2),n.down.outgoing(i)}var n,i,r;return n={incoming:function(s,o){var a=s.indexOf("_");-1===a?s===i?n.up.callback(!0):r||(r=s,e.initiate||t(),n.down.outgoing(s)):s.substring(0,a)===r&&n.up.incoming(s.substring(a+1),o)},outgoing:function(e,t,r){n.down.outgoing(i+"_"+e,t,r)},callback:function(){e.initiate&&t()}}},V.stack.RpcBehavior=function(e,t){function n(e){e.jsonrpc="2.0",s.down.outgoing(o.stringify(e))}function i(e,t){var i=Array.prototype.slice;return function(){var r,s=arguments.length,o={method:t};s>0&&"function"==typeof arguments[s-1]?(s>1&&"function"==typeof arguments[s-2]?(r={success:arguments[s-2],error:arguments[s-1]},o.params=i.call(arguments,0,s-2)):(r={success:arguments[s-1]},o.params=i.call(arguments,0,s-1)),c[""+ ++a]=r,o.id=a):o.params=i.call(arguments,0),e.namedParams&&1===o.params.length&&(o.params=o.params[0]),n(o)}}function r(e,t,i,r){if(!i)return void(t&&n({id:t,error:{code:-32601,message:"Procedure not found."}}));var s,o;t?(s=function(e){s=O,n({id:t,result:e})},o=function(e,i){o=O;var r={id:t,error:{code:-32099,message:e}};i&&(r.error.data=i),n(r)}):s=o=O,l(r)||(r=[r]);try{var a=i.method.apply(i.scope,r.concat([s,o]));y(a)||s(a)}catch(c){o(c.message)}}var s,o=t.serializer||z(),a=0,c={};return s={incoming:function(e){var i=o.parse(e);if(i.method)t.handle?t.handle(i,n):r(i.method,i.id,t.local[i.method],i.params);else{var s=c[i.id];i.error?s.error&&s.error(i.error):s.success&&s.success(i.result),delete c[i.id]}},init:function(){if(t.remote)for(var n in t.remote)t.remote.hasOwnProperty(n)&&(e[n]=i(t.remote[n],n));s.down.init()},destroy:function(){for(var n in t.remote)t.remote.hasOwnProperty(n)&&e.hasOwnProperty(n)&&delete e[n];s.down.destroy()}}},V}(window,document,location,window.setTimeout,decodeURIComponent,encodeURIComponent)},{}],94:[function(e,t){function n(e,t){function s(e){if(s[e]!==_)return s[e];var n;if("bug-string-char-index"==e)n="a"!="a"[0];else if("json"==e)n=s("json-stringify")&&s("json-parse");else{var i,r='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var l=t.stringify,d="function"==typeof l&&y;if(d){(i=function(){return 1}).toJSON=i;try{d="0"===l(0)&&"0"===l(new o)&&'""'==l(new a)&&l(v)===_&&l(_)===_&&"1"===l(i)&&"[1]"==l([i])&&"[null]"==l([_])&&"null"==l(null)&&"[null,null,null]"==l([_,v,null])&&l({a:[i,!0,!1,null,"\x00\b\n\f\r	"]})==r&&"1"===l(null,i)&&"[\n 1,\n 2\n]"==l([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==l(new c(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==l(new c(864e13))&&'"-000001-01-01T00:00:00.000Z"'==l(new c(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==l(new c(-1))}catch(u){d=!1}}n=d}if("json-parse"==e){var h=t.parse;if("function"==typeof h)try{if(0===h("0")&&!h(!1)){i=h(r);var p=5==i.a.length&&1===i.a[0];if(p){try{p=!h('"	"')}catch(u){}if(p)try{p=1!==h("01")}catch(u){}if(p)try{p=1!==h("1.")}catch(u){}}}}catch(u){p=!1}n=p}}return s[e]=!!n}e||(e=r.Object()),t||(t=r.Object());var o=e.Number||r.Number,a=e.String||r.String,l=e.Object||r.Object,c=e.Date||r.Date,d=e.SyntaxError||r.SyntaxError,u=e.TypeError||r.TypeError,h=e.Math||r.Math,p=e.JSON||r.JSON;"object"==typeof p&&p&&(t.stringify=p.stringify,t.parse=p.parse);var g,f,_,m=l.prototype,v=m.toString,y=new c(-0xc782b5b800cec);try{y=-109252==y.getUTCFullYear()&&0===y.getUTCMonth()&&1===y.getUTCDate()&&10==y.getUTCHours()&&37==y.getUTCMinutes()&&6==y.getUTCSeconds()&&708==y.getUTCMilliseconds()}catch(C){}if(!s("json")){var E="[object Function]",P="[object Date]",b="[object Number]",T="[object String]",A="[object Array]",w="[object Boolean]",S=s("bug-string-char-index");if(!y)var k=h.floor,I=[0,31,59,90,120,151,181,212,243,273,304,334],L=function(e,t){return I[t]+365*(e-1970)+k((e-1969+(t=+(t>1)))/4)-k((e-1901+t)/100)+k((e-1601+t)/400)};if((g=m.hasOwnProperty)||(g=function(e){var t,n={};return(n.__proto__=null,n.__proto__={toString:1},n).toString!=v?g=function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(t=n.constructor,g=function(e){var n=(this.constructor||t).prototype;return e in this&&!(e in n&&this[e]===n[e])}),n=null,g.call(this,e)}),f=function(e,t){var n,r,s,o=0;(n=function(){this.valueOf=0}).prototype.valueOf=0,r=new n;for(s in r)g.call(r,s)&&o++;return n=r=null,o?f=2==o?function(e,t){var n,i={},r=v.call(e)==E;for(n in e)r&&"prototype"==n||g.call(i,n)||!(i[n]=1)||!g.call(e,n)||t(n)}:function(e,t){var n,i,r=v.call(e)==E;for(n in e)r&&"prototype"==n||!g.call(e,n)||(i="constructor"===n)||t(n);(i||g.call(e,n="constructor"))&&t(n)}:(r=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],f=function(e,t){var n,s,o=v.call(e)==E,a=!o&&"function"!=typeof e.constructor&&i[typeof e.hasOwnProperty]&&e.hasOwnProperty||g;for(n in e)o&&"prototype"==n||!a.call(e,n)||t(n);for(s=r.length;n=r[--s];a.call(e,n)&&t(n));}),f(e,t)},!s("json-stringify")){var x={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},R="000000",D=function(e,t){return(R+(t||0)).slice(-e)},O="\\u00",F=function(e){for(var t='"',n=0,i=e.length,r=!S||i>10,s=r&&(S?e.split(""):e);i>n;n++){var o=e.charCodeAt(n);switch(o){case 8:case 9:case 10:case 12:case 13:case 34:case 92:t+=x[o];break;default:if(32>o){t+=O+D(2,o.toString(16));break}t+=r?s[n]:e.charAt(n)}}return t+'"'},M=function(e,t,n,i,r,s,o){var a,l,c,d,h,p,m,y,C,E,S,I,x,R,O,N;try{a=t[e]}catch(B){}if("object"==typeof a&&a)if(l=v.call(a),l!=P||g.call(a,"toJSON"))"function"==typeof a.toJSON&&(l!=b&&l!=T&&l!=A||g.call(a,"toJSON"))&&(a=a.toJSON(e));else if(a>-1/0&&1/0>a){if(L){for(h=k(a/864e5),c=k(h/365.2425)+1970-1;L(c+1,0)<=h;c++);for(d=k((h-L(c,0))/30.42);L(c,d+1)<=h;d++);h=1+h-L(c,d),p=(a%864e5+864e5)%864e5,m=k(p/36e5)%24,y=k(p/6e4)%60,C=k(p/1e3)%60,E=p%1e3}else c=a.getUTCFullYear(),d=a.getUTCMonth(),h=a.getUTCDate(),m=a.getUTCHours(),y=a.getUTCMinutes(),C=a.getUTCSeconds(),E=a.getUTCMilliseconds();a=(0>=c||c>=1e4?(0>c?"-":"+")+D(6,0>c?-c:c):D(4,c))+"-"+D(2,d+1)+"-"+D(2,h)+"T"+D(2,m)+":"+D(2,y)+":"+D(2,C)+"."+D(3,E)+"Z"}else a=null;if(n&&(a=n.call(t,e,a)),null===a)return"null";if(l=v.call(a),l==w)return""+a;if(l==b)return a>-1/0&&1/0>a?""+a:"null";if(l==T)return F(""+a);if("object"==typeof a){for(R=o.length;R--;)if(o[R]===a)throw u();if(o.push(a),S=[],O=s,s+=r,l==A){for(x=0,R=a.length;R>x;x++)I=M(x,a,n,i,r,s,o),S.push(I===_?"null":I);N=S.length?r?"[\n"+s+S.join(",\n"+s)+"\n"+O+"]":"["+S.join(",")+"]":"[]"}else f(i||a,function(e){var t=M(e,a,n,i,r,s,o);t!==_&&S.push(F(e)+":"+(r?" ":"")+t)}),N=S.length?r?"{\n"+s+S.join(",\n"+s)+"\n"+O+"}":"{"+S.join(",")+"}":"{}";return o.pop(),N}};t.stringify=function(e,t,n){var r,s,o,a;if(i[typeof t]&&t)if((a=v.call(t))==E)s=t;else if(a==A){o={};for(var l,c=0,d=t.length;d>c;l=t[c++],a=v.call(l),(a==T||a==b)&&(o[l]=1));}if(n)if((a=v.call(n))==b){if((n-=n%1)>0)for(r="",n>10&&(n=10);r.length<n;r+=" ");}else a==T&&(r=n.length<=10?n:n.slice(0,10));return M("",(l={},l[""]=e,l),s,o,r,"",[])}}if(!s("json-parse")){var N,B,V=a.fromCharCode,U={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},q=function(){throw N=B=null,d()},j=function(){for(var e,t,n,i,r,s=B,o=s.length;o>N;)switch(r=s.charCodeAt(N)){case 9:case 10:case 13:case 32:N++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=S?s.charAt(N):s[N],N++,e;case 34:for(e="@",N++;o>N;)if(r=s.charCodeAt(N),32>r)q();else if(92==r)switch(r=s.charCodeAt(++N)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=U[r],N++;break;case 117:for(t=++N,n=N+4;n>N;N++)r=s.charCodeAt(N),r>=48&&57>=r||r>=97&&102>=r||r>=65&&70>=r||q();e+=V("0x"+s.slice(t,N));break;default:q()}else{if(34==r)break;for(r=s.charCodeAt(N),t=N;r>=32&&92!=r&&34!=r;)r=s.charCodeAt(++N);e+=s.slice(t,N)}if(34==s.charCodeAt(N))return N++,e;q();default:if(t=N,45==r&&(i=!0,r=s.charCodeAt(++N)),r>=48&&57>=r){for(48==r&&(r=s.charCodeAt(N+1),r>=48&&57>=r)&&q(),i=!1;o>N&&(r=s.charCodeAt(N),r>=48&&57>=r);N++);if(46==s.charCodeAt(N)){for(n=++N;o>n&&(r=s.charCodeAt(n),r>=48&&57>=r);n++);n==N&&q(),N=n}if(r=s.charCodeAt(N),101==r||69==r){for(r=s.charCodeAt(++N),(43==r||45==r)&&N++,n=N;o>n&&(r=s.charCodeAt(n),r>=48&&57>=r);n++);n==N&&q(),N=n}return+s.slice(t,N)}if(i&&q(),"true"==s.slice(N,N+4))return N+=4,!0;if("false"==s.slice(N,N+5))return N+=5,!1;if("null"==s.slice(N,N+4))return N+=4,null;q()}return"$"},Q=function(e){var t,n;if("$"==e&&q(),"string"==typeof e){if("@"==(S?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];e=j(),"]"!=e;n||(n=!0))n&&(","==e?(e=j(),"]"==e&&q()):q()),","==e&&q(),t.push(Q(e));return t}if("{"==e){for(t={};e=j(),"}"!=e;n||(n=!0))n&&(","==e?(e=j(),"}"==e&&q()):q()),(","==e||"string"!=typeof e||"@"!=(S?e.charAt(0):e[0])||":"!=j())&&q(),t[e.slice(1)]=Q(j());return t}q()}return e},H=function(e,t,n){var i=W(e,t,n);i===_?delete e[t]:e[t]=i},W=function(e,t,n){var i,r=e[t];if("object"==typeof r&&r)if(v.call(r)==A)for(i=r.length;i--;)H(r,i,n);else f(r,function(e){H(r,e,n)});return n.call(e,t,r)};t.parse=function(e,t){var n,i;return N=0,B=""+e,n=Q(j()),"$"!=j()&&q(),N=B=null,t&&v.call(t)==E?W((i={},i[""]=n,i),"",t):n}}}return t.runInContext=n,t}var i={"function":!0,object:!0},r=window,s=n(r,{});t.exports=s},{}],95:[function(e,t){var n=function(){function e(){if(!X&&document.getElementsByTagName("body")[0]){try{var e,t=v("span");t.style.display="none",e=U.getElementsByTagName("body")[0].appendChild(t),e.parentNode.removeChild(e),e=null,t=null}catch(n){return}X=!0;for(var i=Q.length,r=0;i>r;r++)Q[r]()}}function t(e){X?e():Q[Q.length]=e}function i(e){if(typeof V.addEventListener!==x)V.addEventListener("load",e,!1);else if(typeof U.addEventListener!==x)U.addEventListener("load",e,!1);else if(typeof V.attachEvent!==x)C(V,"onload",e);else if("function"==typeof V.onload){var t=V.onload;V.onload=function(){t(),e()}}else V.onload=e}function r(){var e=U.getElementsByTagName("body")[0],t=v(R);t.setAttribute("style","visibility: hidden;"),t.setAttribute("type",F);var n=e.appendChild(t);if(n){var i=0;!function r(){if(typeof n.GetVariable!==x)try{var o=n.GetVariable("$version");o&&(o=o.split(" ")[1].split(","),$.pv=[y(o[0]),y(o[1]),y(o[2])])}catch(a){$.pv=[8,0,0]}else if(10>i)return i++,void setTimeout(r,10);e.removeChild(t),n=null,s()}()}else s()}function s(){var e=H.length;if(e>0)for(var t=0;e>t;t++){var n=H[t].id,i=H[t].callbackFn,r={success:!1,id:n};if($.pv[0]>0){var s=m(n);if(s)if(!E(H[t].swfVersion)||$.wk&&$.wk<312)if(H[t].expressInstall&&a()){var d={};d.data=H[t].expressInstall,d.width=s.getAttribute("width")||"0",d.height=s.getAttribute("height")||"0",s.getAttribute("class")&&(d.styleclass=s.getAttribute("class")),s.getAttribute("align")&&(d.align=s.getAttribute("align"));for(var u={},h=s.getElementsByTagName("param"),p=h.length,g=0;p>g;g++)"movie"!==h[g].getAttribute("name").toLowerCase()&&(u[h[g].getAttribute("name")]=h[g].getAttribute("value"));l(d,u,n,i)}else c(s),i&&i(r);else b(n,!0),i&&(r.success=!0,r.ref=o(n),r.id=n,i(r))}else if(b(n,!0),i){var f=o(n);f&&typeof f.SetVariable!==x&&(r.success=!0,r.ref=f,r.id=f.id),i(r)}}}function o(e){var t=null,n=m(e);return n&&"OBJECT"===n.nodeName.toUpperCase()&&(t=typeof n.SetVariable!==x?n:n.getElementsByTagName(R)[0]||n),t}function a(){return!z&&E("6.0.65")&&($.win||$.mac)&&!($.wk&&$.wk<312)}function l(e,t,n,i){var r=m(n);if(n=_(n),z=!0,S=i||null,k={success:!1,id:n},r){"OBJECT"===r.nodeName.toUpperCase()?(A=d(r),w=null):(A=r,w=n),e.id=M,(typeof e.width===x||!/%$/.test(e.width)&&y(e.width)<310)&&(e.width="310"),(typeof e.height===x||!/%$/.test(e.height)&&y(e.height)<137)&&(e.height="137");var s=$.ie?"ActiveX":"PlugIn",o="MMredirectURL="+encodeURIComponent(V.location.toString().replace(/&/g,"%26"))+"&MMplayerType="+s+"&MMdoctitle="+encodeURIComponent(U.title.slice(0,47)+" - Flash Player Installation");if(typeof t.flashvars!==x?t.flashvars+="&"+o:t.flashvars=o,$.ie&&4!=r.readyState){var a=v("div");n+="SWFObjectNew",a.setAttribute("id",n),r.parentNode.insertBefore(a,r),r.style.display="none",g(r)}h(e,t,n)}}function c(e){if($.ie&&4!=e.readyState){e.style.display="none";var t=v("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(d(e),t),g(e)}else e.parentNode.replaceChild(d(e),e)}function d(e){var t=v("div");if($.win&&$.ie)t.innerHTML=e.innerHTML;else{var n=e.getElementsByTagName(R)[0];if(n){var i=n.childNodes;if(i)for(var r=i.length,s=0;r>s;s++)1==i[s].nodeType&&"PARAM"===i[s].nodeName||8==i[s].nodeType||t.appendChild(i[s].cloneNode(!0))}}return t}function u(e,t){var n=v("div");return n.innerHTML="<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000'><param name='movie' value='"+e+"'>"+t+"</object>",n.firstChild}function h(e,t,n){var i,r=m(n);if(n=_(n),$.wk&&$.wk<312)return i;if(r){var s,o,a,l=v($.ie?"div":R);typeof e.id===x&&(e.id=n);for(a in t)t.hasOwnProperty(a)&&"movie"!==a.toLowerCase()&&p(l,a,t[a]);$.ie&&(l=u(e.data,l.innerHTML));for(s in e)e.hasOwnProperty(s)&&(o=s.toLowerCase(),"styleclass"===o?l.setAttribute("class",e[s]):"classid"!==o&&"data"!==o&&l.setAttribute(s,e[s]));$.ie?W[W.length]=e.id:(l.setAttribute("type",F),l.setAttribute("data",e.data)),r.parentNode.replaceChild(l,r),i=l}return i}function p(e,t,n){var i=v("param");i.setAttribute("name",t),i.setAttribute("value",n),e.appendChild(i)}function g(e){var t=m(e);t&&"OBJECT"===t.nodeName.toUpperCase()&&($.ie?(t.style.display="none",function n(){if(4==t.readyState){for(var e in t)"function"==typeof t[e]&&(t[e]=null);t.parentNode.removeChild(t)}else setTimeout(n,10)}()):t.parentNode.removeChild(t))}function f(e){return e&&e.nodeType&&1===e.nodeType}function _(e){return f(e)?e.id:e}function m(e){if(f(e))return e;var t=null;try{t=U.getElementById(e)}catch(n){}return t}function v(e){return U.createElement(e)}function y(e){return parseInt(e,10)}function C(e,t,n){e.attachEvent(t,n),K[K.length]=[e,t,n]}function E(e){e+="";var t=$.pv,n=e.split(".");return n[0]=y(n[0]),n[1]=y(n[1])||0,n[2]=y(n[2])||0,t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]?!0:!1}function P(e,t,n,i){var r=U.getElementsByTagName("head")[0];if(r){var s="string"==typeof n?n:"screen";if(i&&(I=null,L=null),!I||L!=s){var o=v("style");o.setAttribute("type","text/css"),o.setAttribute("media",s),I=r.appendChild(o),$.ie&&typeof U.styleSheets!==x&&U.styleSheets.length>0&&(I=U.styleSheets[U.styleSheets.length-1]),L=s}I&&(typeof I.addRule!==x?I.addRule(e,t):typeof U.createTextNode!==x&&I.appendChild(U.createTextNode(e+" {"+t+"}")))}}function b(e,t){if(J){var n=t?"visible":"hidden",i=m(e);X&&i?i.style.visibility=n:"string"==typeof e&&P("#"+e,"visibility:"+n)}}function T(e){var t=/[\\\"<>\.;]/,n=null!==t.exec(e);return n&&typeof encodeURIComponent!==x?encodeURIComponent(e):e}var A,w,S,k,I,L,x="undefined",R="object",D="Shockwave Flash",O="ShockwaveFlash.ShockwaveFlash",F="application/x-shockwave-flash",M="SWFObjectExprInst",N="DOMContentLoaded",B="onreadystatechange",V=window,U=document,q=navigator,j=!1,Q=[],H=[],W=[],K=[],X=!1,z=!1,J=!0,G=!1,$=function(){var e=typeof U.getElementById!==x&&typeof U.getElementsByTagName!==x&&typeof U.createElement!==x,t=q.userAgent.toLowerCase(),n=q.platform.toLowerCase(),i=/win/.test(n?n:t),r=/mac/.test(n?n:t),s=/webkit/.test(t)?parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,o="Microsoft Internet Explorer"===q.appName,a=[0,0,0],l=null;if(typeof q.plugins!==x&&typeof q.plugins[D]===R)l=q.plugins[D].description,l&&typeof q.mimeTypes!==x&&q.mimeTypes[F]&&q.mimeTypes[F].enabledPlugin&&(j=!0,o=!1,l=l.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),a[0]=y(l.replace(/^(.*)\..*$/,"$1")),a[1]=y(l.replace(/^.*\.(.*)\s.*$/,"$1")),a[2]=/[a-zA-Z]/.test(l)?y(l.replace(/^.*[a-zA-Z]+(.*)$/,"$1")):0);else if(typeof V.ActiveXObject!==x)try{var c=new ActiveXObject(O);c&&(l=c.GetVariable("$version"),l&&(o=!0,l=l.split(" ")[1].split(","),a=[y(l[0]),y(l[1]),y(l[2])]))}catch(d){}return{w3:e,pv:a,wk:s,ie:o,win:i,mac:r}}();return function(){$.w3&&((typeof U.readyState!==x&&"complete"===U.readyState||typeof U.readyState===x&&(U.getElementsByTagName("body")[0]||U.body))&&e(),X||(typeof U.addEventListener!==x&&U.addEventListener(N,function t(){U.removeEventListener(N,t,!1),e()},!1),$.ie&&(U.attachEvent(B,function n(){"complete"===U.readyState&&(U.detachEvent(B,n),e())}),V===top&&!function r(){if(!X){try{U.documentElement.doScroll("left")}catch(t){return void setTimeout(r,10)}e()}}()),$.wk&&!function s(){return X?void 0:/^(loaded|complete)$/.test(U.readyState)?void e():void setTimeout(s,10)}(),i(e)))}(),Q[0]=function(){j?r():s()},function(){$.ie&&window.attachEvent("onunload",function(){for(var e=K.length,t=0;e>t;t++)K[t][0].detachEvent(K[t][1],K[t][2]);for(var i=W.length,r=0;i>r;r++)g(W[r]);for(var s in $)$[s]=null;$=null;for(var o in n)n[o]=null;n=null})}(),{registerObject:function(e,t,n,i){if($.w3&&e&&t){var r={};r.id=e,r.swfVersion=t,r.expressInstall=n,r.callbackFn=i,H[H.length]=r,b(e,!1)}else i&&i({success:!1,id:e})},getObjectById:function(e){return $.w3?o(e):void 0},embedSWF:function(e,n,i,r,s,o,c,d,u,p){var g=_(n),f={success:!1,id:g};$.w3&&!($.wk&&$.wk<312)&&e&&n&&i&&r&&s?(b(g,!1),t(function(){i+="",r+="";var t={};if(u&&typeof u===R)for(var _ in u)t[_]=u[_];t.data=e,t.width=i,t.height=r;var m={};if(d&&typeof d===R)for(var v in d)m[v]=d[v];if(c&&typeof c===R)for(var y in c)if(c.hasOwnProperty(y)){var C=G?encodeURIComponent(y):y,P=G?encodeURIComponent(c[y]):c[y];typeof m.flashvars!==x?m.flashvars+="&"+C+"="+P:m.flashvars=C+"="+P}if(E(s)){var T=h(t,m,n);t.id==g&&b(g,!0),f.success=!0,f.ref=T,f.id=T.id}else{if(o&&a())return t.data=o,void l(t,m,n,p);b(g,!0)}p&&p(f)})):p&&p(f)},switchOffAutoHideShow:function(){J=!1},enableUriEncoding:function(e){G=typeof e===x?!0:e},ua:$,getFlashPlayerVersion:function(){return{major:$.pv[0],minor:$.pv[1],release:$.pv[2]}},hasFlashPlayerVersion:E,createSWF:function(e,t,n){return $.w3?h(e,t,n):void 0},showExpressInstall:function(e,t,n,i){$.w3&&a()&&l(e,t,n,i)},removeSWF:function(e){$.w3&&g(e)},createCSS:function(e,t,n,i){$.w3&&P(e,t,n,i)},addDomLoadEvent:t,addLoadEvent:i,getQueryParamValue:function(e){var t=U.location.search||U.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),!e)return T(t);for(var n=t.split("&"),i=0;i<n.length;i++)if(n[i].substring(0,n[i].indexOf("="))==e)return T(n[i].substring(n[i].indexOf("=")+1))}return""},expressInstallCallback:function(){if(z){var e=m(M);e&&A&&(e.parentNode.replaceChild(A,e),w&&(b(w,!0),$.ie&&(A.style.display="block")),S&&S(k)),z=!1}},version:"2.3"}}();t.exports=n},{}],96:[function(e,t){(function(e){/** @license MIT License (c) copyright 2011-2013 original author or authors */
"use strict";function n(e,t,n,i){return r(e).then(t,n,i)}function i(e,t){this.then=e,this.inspect=t}function r(e){return a(function(t){t(e)})}function s(e){return n(e,u)}function o(){function e(e,s,o){t.resolve=t.resolver.resolve=function(t){return i?r(t):(i=!0,e(t),n)},t.reject=t.resolver.reject=function(e){return i?r(u(e)):(i=!0,s(e),n)},t.notify=t.resolver.notify=function(e){return o(e),e}}var t,n,i;return t={promise:V,resolve:V,reject:V,notify:V,resolver:{resolve:V,reject:V,notify:V}},t.promise=n=a(e),t}function a(e){return l(e,B.PromiseStatus&&B.PromiseStatus())}function l(e,t){function n(e,n,i){var r=l(function(t,r,s){function o(o){o.then(e,n,i).then(t,r,s)}f?f.push(o):w(function(){o(g)})},t&&t.observed());return r}function r(){return g?g.inspect():A()}function s(e){f&&(g=c(e),p(f,g),f=V,t&&g.then(function(){t.fulfilled()},function(e){t.rejected(e)}))}function o(e){s(u(e))}function a(e){f&&p(f,h(e))}var d,g,f=[];d=new i(n,r);try{e(s,o,a)}catch(_){o(_)}return d}function c(e){return e instanceof i?e:e===Object(e)&&"then"in e?a(function(t,n,i){w(function(){try{var r=e.then;"function"==typeof r?x(r,e,t,n,i):t(d(e))}catch(s){n(s)}})}):d(e)}function d(e){var t=new i(function(n){try{return"function"==typeof n?c(n(e)):t}catch(i){return u(i)}},function(){return b(e)});return t}function u(e){var t=new i(function(n,i){try{return"function"==typeof i?c(i(e)):t}catch(r){return u(r)}},function(){return T(e)});return t}function h(e){var t=new i(function(n,i,r){try{return"function"==typeof r?h(r(e)):t}catch(s){return h(s)}});return t}function p(e,t){w(function(){for(var n,i=0;n=e[i++];)n(t)})}function g(e){return e&&"function"==typeof e.then}function f(e,t,i,r,s){return n(e,function(e){function o(i,r,s){function o(e){p(e)}function a(e){h(e)}var l,c,d,u,h,p,g,f;if(g=e.length>>>0,l=Math.max(0,Math.min(t,g)),d=[],c=g-l+1,u=[],l)for(p=function(e){u.push(e),--c||(h=p=k,r(u))},h=function(e){d.push(e),--l||(h=p=k,i(d))},f=0;g>f;++f)f in e&&n(e[f],a,o,s);else i(d)}return a(o).then(i,r,s)})}function _(e,t,n,i){function r(e){return t?t(e[0]):e[0]}return f(e,1,r,n,i)}function m(e,t,n,i){return E(e,k).then(t,n,i)}function v(){return E(arguments,k)}function y(e){return E(e,b,T)}function C(e,t){return E(e,t)}function E(e,t,i){return n(e,function(e){function r(r,s,o){function a(e,a){n(e,t,i).then(function(e){l[a]=e,--d||r(l)},s,o)}var l,c,d,u;if(d=c=e.length>>>0,l=[],!d)return void r(l);for(u=0;c>u;u++)u in e?a(e[u],u):--d}return a(r)})}function P(e,t){var i=x(L,arguments,1);return n(e,function(e){var r;return r=e.length,i[0]=function(e,i,s){return n(e,function(e){return n(i,function(n){return t(e,n,s,r)})})},I.apply(e,i)})}function b(e){return{state:"fulfilled",value:e}}function T(e){return{state:"rejected",reason:e}}function A(){return{state:"pending"}}function w(e){1===D.push(e)&&R(S)}function S(){for(var e,t=0;e=D[t++];)e();D=[]}function k(e){return e}n.promise=a,n.resolve=r,n.reject=s,n.defer=o,n.join=v,n.all=m,n.map=C,n.reduce=P,n.settle=y,n.any=_,n.some=f,n.isPromise=g,i.prototype={otherwise:function(e){return this.then(V,e)},ensure:function(e){function t(){return r(e())}return this.then(t,t)["yield"](this)},"yield":function(e){return this.then(function(){return e})},spread:function(e){return this.then(function(t){return m(t,function(t){return e.apply(V,t)})})},always:function(e,t){return this.then(e,e,t)}};var I,L,x,R,D,O,F,M,N,B,V;D=[],B="undefined"!=typeof console?console:n,O=e.setTimeout,R="function"==typeof setImmediate?setImmediate.bind(e):function(e){O(e,0)},F=Function.prototype,M=F.call,x=F.bind?M.bind(M):function(e,t){return e.apply(t,L.call(arguments,2))},N=[],L=N.slice,I=N.reduce||function(e){var t,n,i,r,s;if(s=0,t=Object(this),r=t.length>>>0,n=arguments,n.length<=1)for(;;){if(s in t){i=t[s++];break}if(++s>=r)throw new TypeError}else i=n[1];for(;r>s;++s)s in t&&(i=e(i,t[s],s,t));return i},t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[11]);
//# sourceMappingURL=http://cvpdev.turner.com/dmtvideo/cvp-js/2.8.4.1/cvp.min.js.map